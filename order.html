<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
      background: #d4edda;
      min-height: 100vh;
      padding: 10px;
      margin: 0;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      padding: 15px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 3px solid #28a745;
      padding-bottom: 15px;
    }
    
    .header h1 {
      color: #333;
      font-size: 20px;
      margin-bottom: 5px;
    }
    
    .info-section {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    
    .info-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      flex-direction: column;
      align-items: stretch;
    }
    
    .info-row:last-child {
      margin-bottom: 0;
    }
    
    .info-row label {
      width: 100%;
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
      font-size: 14px;
    }
    
    .info-row input {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .info-row input:focus {
      outline: none;
      border-color: #28a745;
    }
    
    .section-title {
      background: #28a745;
      color: white;
      padding: 10px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      margin: 20px 0 10px 0;
      text-align: center;
    }
    
    .order-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
      font-size: 12px;
    }
    
    .order-table thead {
      background: #28a745;
      color: white;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .order-table th {
      padding: 10px 5px;
      text-align: left;
      font-weight: bold;
      font-size: 11px;
      border: 1px solid #ddd;
    }
    
    .order-table th:nth-child(1) { width: 60px; font-size: 10px; }
    .order-table th:nth-child(2) { width: auto; }
    .order-table th:nth-child(3) { width: 70px; }
    .order-table th:nth-child(4) { width: 70px; }
    
    .order-table tbody tr {
      border-bottom: 1px solid #eee;
    }
    
    .order-table tbody tr:hover {
      background: #f8f9fa;
    }
    
    .order-table td {
      padding: 8px 5px;
      font-size: 12px;
      border: 1px solid #ddd;
    }
    
    .order-table td:first-child {
      font-size: 10px;
      color: #666;
    }
    
    .order-table select {
      width: 100%;
      padding: 6px 2px;
      border: 2px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      background: white;
      cursor: pointer;
      box-sizing: border-box;
    }
    
    .order-table select:focus {
      outline: none;
      border-color: #28a745;
    }
    
    .order-table select:not([value=""]) {
      background: #d4edda;
      border-color: #28a745;
    }
    
    .remarks-section {
      margin: 20px 0;
    }
    
    .remarks-section label {
      display: block;
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
      font-size: 14px;
    }
    
    .remarks-section textarea {
      width: 100%;
      min-height: 100px;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      box-sizing: border-box;
    }
    
    .remarks-section textarea:focus {
      outline: none;
      border-color: #28a745;
    }
    
    .action-buttons {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      flex: 1;
      min-width: 0;
    }
    
    .btn:active {
      transform: scale(0.95);
    }
    
    .btn-save {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
    }
    
    .btn-send {
      background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
      color: white;
    }
    
    .note {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 12px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    .note-title {
      font-weight: bold;
      color: #856404;
      margin-bottom: 5px;
    }
    
    .note-content {
      color: #856404;
      font-size: 12px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </h1>
    </div>
    
    <div class="info-section">
      <div class="info-row">
        <label>é¡§å®¢ã‚³ãƒ¼ãƒ‰:</label>
        <input type="text" id="customerCode" value="" placeholder="é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      </div>
      <div class="info-row">
        <label>åº—èˆ—å:</label>
        <input type="text" id="storeName" value="" placeholder="åº—èˆ—åã‚’å…¥åŠ›">
      </div>
      <div class="info-row">
        <label>ç™ºæ³¨è€…:</label>
        <input type="text" id="ordererName" value="" placeholder="ç™ºæ³¨è€…åã‚’å…¥åŠ›">
      </div>
    </div>
    
    <div class="section-title">é£Ÿæ</div>
    
    <table class="order-table" id="shokuzaiTable">
      <thead>
        <tr>
          <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th>å•†å“å</th>
          <th>ã‚±ãƒ¼ã‚¹æ•°</th>
          <th>ãƒãƒ©æ•°</th>
        </tr>
      </thead>
      <tbody id="shokuzaiBody">
        <!-- é£Ÿæãƒªã‚¹ãƒˆã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
      </tbody>
    </table>
    
    <div class="section-title">åŒ…æ</div>
    
    <table class="order-table" id="houzaiTable">
      <thead>
        <tr>
          <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th>å•†å“å</th>
          <th>ã‚±ãƒ¼ã‚¹æ•°</th>
          <th>ãƒãƒ©æ•°</th>
        </tr>
      </thead>
      <tbody id="houzaiBody">
        <!-- åŒ…æãƒªã‚¹ãƒˆã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
      </tbody>
    </table>
    
    <div class="remarks-section">
      <label>å‚™è€ƒæ¬„ï¼ˆãªã„å•†å“ã®ä¾é ¼ç­‰ï¼‰:</label>
      <textarea id="remarks" placeholder="å‚™è€ƒã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
    </div>
    
    <div class="action-buttons">
      <button class="btn btn-save" onclick="saveAndSend()">ä¿å­˜ã—ã¦ç™ºæ³¨</button>
    </div>
    
    <div class="note">
      <div class="note-title">ğŸ’¡ ä½¿ã„æ–¹</div>
      <div class="note-content">
        1. é¡§å®¢ã‚³ãƒ¼ãƒ‰ã€åº—èˆ—åã€ç™ºæ³¨è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„<br>
        2. å„å•†å“ã®ã‚±ãƒ¼ã‚¹æ•°ãƒ»ãƒãƒ©æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„<br>
        3. å¿…è¦ã«å¿œã˜ã¦å‚™è€ƒæ¬„ã«è¨˜å…¥ã—ã¦ãã ã•ã„<br>
        4. ã€Œä¿å­˜ã—ã¦ç™ºæ³¨ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€XLSXãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã€ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™<br>
        5. ä¿å­˜ã•ã‚ŒãŸXLSXãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦ gymnastmasaki@yahoo.co.jp ã«é€ä¿¡ã—ã¦ãã ã•ã„
      </div>
    </div>
  </div>
  
  <script>
    // é£Ÿæå•†å“ãƒªã‚¹ãƒˆ
    const shokuzaiProducts = [
      { code: '5', name: 'ãŸã“ç„¼ç²‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '6', name: 'ãŠå¥½ã¿ç²‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '425', name: 'ãƒ€ã‚·', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2090', name: 'ã‚¿ã‚³', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¤ã‚«', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '902', name: 'å¤©ã‹ã™', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '215', name: 'ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ç‰å­', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '283', name: 'ç²‰ã‚‚ã‚“å±‹å…«å”è¾›å­é†¤æ²¹1.8', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '383', name: 'ãƒãƒ³é…¢', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '320', name: 'ãƒãƒ¨ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '362', name: 'å¡©ã‚³ã‚·ãƒ§ã‚¦', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '520', name: 'é’ã•500ï½‡', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '716', name: 'ç´…ã‚·ãƒ§ã‚¦ã‚¬', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '1488', name: 'ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '514', name: 'ãã–ã¿ã®ã‚Š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '610', name: 'ãƒ©ãƒ¼ãƒ‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '322', name: 'ã¤ã¶ã¤ã¶æ˜å¤ªå­ãƒãƒ¨ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æœŸé–“é™å®š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'èµ¤ã ã¾ã‚Šã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æ¢…ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '421', name: 'å’Œé¢¨ã ã—1.8L', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '506', name: 'æ‰‹ã‚‚ã¿ã‚«ãƒ„ã‚ª', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2366', name: 'ã‚²ã‚½ã®å”æšã’ã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2906', name: 'æè±†', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2430', name: 'ãƒãƒ†ãƒˆã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2355', name: 'ãªã‚“ã“ã¤500ï½‡ã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '208', name: 'ã‚¦ã‚¹ã‚¿ãƒ¼ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '246', name: 'å¡©ã ã‚Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '602', name: 'ç™½çµæ²¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '331', name: 'ã‚±ãƒãƒ£ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4007', name: 'ã‚¢ãƒ«ãƒšãƒƒãƒˆ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2006', name: 'æ²¹ã‹ã™', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '317', name: 'ã‚¿ãƒ«ã‚¿ãƒ«ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) }
    ];
    
    // åŒ…æå•†å“ãƒªã‚¹ãƒˆ
    const houzaiProducts = [
      { code: '3009', name: 'èˆŸï¼—å¯¸', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3011', name: 'èˆŸ9å¯¸', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3786', name: 'åå…¥ã‚Šè¢‹å°ã€€No.30', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3787', name: 'åå…¥ã‚Šè¢‹å¤§ No.35', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3843', name: 'ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3036', name: 'ç‰¹ä¸€æµ…', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3031', name: 'ãƒ‘ãƒƒã‚¯ä¸­æ·±', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3133', name: 'ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3132', name: 'ãƒ‘ãƒƒã‚¯å¤§æ·±', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3662', name: 'ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ãƒ€ã‚·å®¹å™¨', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3611', name: 'è¢‹ä»˜ã¯ã—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3201', name: 'ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3200', name: 'ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '', name: 'ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4513', name: 'æ›¿ç³¸ã€€å°', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4026', name: 'ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‹ãæ°·ã‚«ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æ°·ã‚¹ãƒˆãƒ­ãƒ¼', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4008', name: 'æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3645', name: 'è¼ªã‚´ãƒ ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ç´™ãŠã—ã¼ã‚Š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) }
    ];
    
    // æ•°é‡é¸æŠè‚¢ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
    function generateOptions(start, end, step = 1) {
      const options = [''];
      for (let i = start; i <= end; i += step) {
        options.push(i);
      }
      return options;
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
    function createTableRow(product) {
      const row = document.createElement('tr');
      
      // å•†å“ã‚³ãƒ¼ãƒ‰
      const codeCell = document.createElement('td');
      codeCell.textContent = product.code;
      row.appendChild(codeCell);
      
      // å•†å“å
      const nameCell = document.createElement('td');
      nameCell.textContent = product.name;
      row.appendChild(nameCell);
      
      // ã‚±ãƒ¼ã‚¹æ•°
      const caseCell = document.createElement('td');
      const caseSelect = document.createElement('select');
      caseSelect.className = 'qty-case';
      caseSelect.dataset.code = product.code;
      caseSelect.dataset.product = product.name;
      product.caseOptions.forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt === '' ? '-' : opt;
        caseSelect.appendChild(option);
      });
      caseCell.appendChild(caseSelect);
      row.appendChild(caseCell);
      
      // ãƒãƒ©æ•°
      const baraCell = document.createElement('td');
      const baraSelect = document.createElement('select');
      baraSelect.className = 'qty-bara';
      baraSelect.dataset.code = product.code;
      baraSelect.dataset.product = product.name;
      product.baraOptions.forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt === '' ? '-' : opt;
        baraSelect.appendChild(option);
      });
      baraCell.appendChild(baraSelect);
      row.appendChild(baraCell);
      
      return row;
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
    function initializeTables() {
      const shokuzaiBody = document.getElementById('shokuzaiBody');
      const houzaiBody = document.getElementById('houzaiBody');
      
      shokuzaiProducts.forEach(product => {
        shokuzaiBody.appendChild(createTableRow(product));
      });
      
      houzaiProducts.forEach(product => {
        houzaiBody.appendChild(createTableRow(product));
      });
      
      // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
      document.querySelectorAll('select').forEach(select => {
        select.addEventListener('change', function() {
          if (this.value) {
            this.style.background = '#d4edda';
            this.style.borderColor = '#28a745';
          } else {
            this.style.background = 'white';
            this.style.borderColor = '#ddd';
          }
        });
      });
    }
    
    // XLSXä¿å­˜ã¨ãƒ¡ãƒ¼ãƒ«é€ä¿¡
    function saveAndSend() {
      const customerCode = document.getElementById('customerCode').value;
      const storeName = document.getElementById('storeName').value;
      const ordererName = document.getElementById('ordererName').value;
      const remarks = document.getElementById('remarks').value;
      
      if (!customerCode || !storeName || !ordererName) {
        alert('é¡§å®¢ã‚³ãƒ¼ãƒ‰ã€åº—èˆ—åã€ç™ºæ³¨è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      const today = new Date();
      const orderDate = today.toISOString().split('T')[0];
      
      // XLSXãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
      const wb = XLSX.utils.book_new();
      
      // ã‚·ãƒ¼ãƒˆ1: ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿
      const wsData = [];
      
      // ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
      wsData.push(['ç™ºæ³¨è¡¨']);
      wsData.push(['é¡§å®¢ã‚³ãƒ¼ãƒ‰', customerCode]);
      wsData.push(['åº—èˆ—å', storeName]);
      wsData.push(['ç™ºæ³¨è€…', ordererName]);
      wsData.push(['ç™ºæ³¨æ—¥', orderDate]);
      wsData.push([]);
      
      // é£Ÿæã‚»ã‚¯ã‚·ãƒ§ãƒ³
      wsData.push(['é£Ÿæ']);
      wsData.push(['å•†å“ã‚³ãƒ¼ãƒ‰', 'å•†å“å', 'ã‚±ãƒ¼ã‚¹æ•°', 'ãƒãƒ©æ•°']);
      
      document.querySelectorAll('#shokuzaiBody tr').forEach(row => {
        const code = row.cells[0].textContent;
        const name = row.cells[1].textContent;
        const caseQty = row.querySelector('.qty-case').value || '';
        const baraQty = row.querySelector('.qty-bara').value || '';
        wsData.push([code, name, caseQty, baraQty]);
      });
      
      wsData.push([]);
      
      // åŒ…æã‚»ã‚¯ã‚·ãƒ§ãƒ³
      wsData.push(['åŒ…æ']);
      wsData.push(['å•†å“ã‚³ãƒ¼ãƒ‰', 'å•†å“å', 'ã‚±ãƒ¼ã‚¹æ•°', 'ãƒãƒ©æ•°']);
      
      document.querySelectorAll('#houzaiBody tr').forEach(row => {
        const code = row.cells[0].textContent;
        const name = row.cells[1].textContent;
        const caseQty = row.querySelector('.qty-case').value || '';
        const baraQty = row.querySelector('.qty-bara').value || '';
        wsData.push([code, name, caseQty, baraQty]);
      });
      
      wsData.push([]);
      wsData.push(['å‚™è€ƒ']);
      wsData.push([remarks]);
      
      const ws = XLSX.utils.aoa_to_sheet(wsData);
      
      // åˆ—å¹…è¨­å®š
      ws['!cols'] = [
        { wch: 12 },  // å•†å“ã‚³ãƒ¼ãƒ‰
        { wch: 30 },  // å•†å“å
        { wch: 12 },  // ã‚±ãƒ¼ã‚¹æ•°
        { wch: 12 }   // ãƒãƒ©æ•°
      ];
      
      XLSX.utils.book_append_sheet(wb, ws, 'ç™ºæ³¨è¡¨');
      
      // ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
      const filename = `ç™ºæ³¨_${customerCode}_${orderDate}.xlsx`;
      XLSX.writeFile(wb, filename);
      
      // ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆç«‹ã¡ä¸Šã’
      const subject = encodeURIComponent(`ã€ç™ºæ³¨ã€‘${customerCode} - ${orderDate}`);
      const body = encodeURIComponent(
        `ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿ã‚’æ·»ä»˜ã—ã¦ã„ã¾ã™ã€‚\n\n` +
        `é¡§å®¢ã‚³ãƒ¼ãƒ‰: ${customerCode}\n` +
        `åº—èˆ—å: ${storeName}\n` +
        `ç™ºæ³¨è€…: ${ordererName}\n` +
        `ç™ºæ³¨æ—¥: ${orderDate}\n\n` +
        `æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: ${filename}`
      );
      
      window.location.href = `mailto:gymnastmasaki@yahoo.co.jp?subject=${subject}&body=${body}`;
      
      alert('âœ… XLSXãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼\nä¿å­˜ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚');
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
    window.onload = function() {
      initializeTables();
    };
  </script>
</body>
</html>
