<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
      background: #d4edda;
      min-height: 100vh;
      padding: 10px;
      margin: 0;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      padding: 20px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 20px;
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border-radius: 12px;
      padding: 20px;
    }
    
    .header h1 {
      font-size: 24px;
      margin-bottom: 5px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .info-section {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .info-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      flex-direction: column;
      align-items: stretch;
    }
    
    .info-row:last-child {
      margin-bottom: 0;
    }
    
    .info-row label {
      width: 100%;
      font-weight: bold;
      color: #333;
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    .info-row input {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
      transition: all 0.3s;
    }
    
    .info-row input:focus {
      outline: none;
      border-color: #28a745;
      box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
    }

    /* 2åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç”¨ã®ã‚³ãƒ³ãƒ†ãƒŠ */
    .tables-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 768px) {
      .tables-container {
        grid-template-columns: 1fr;
      }
    }

    .table-section {
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .section-title {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      margin-bottom: 15px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .order-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
      font-size: 12px;
      border: 2px solid #28a745;
    }
    
    .order-table thead {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .order-table th {
      padding: 10px 5px;
      text-align: left;
      font-weight: bold;
      font-size: 11px;
      border: 1px solid #28a745;
    }
    
    .order-table th:nth-child(1) { width: 60px; font-size: 10px; text-align: center; }
    .order-table th:nth-child(2) { width: auto; }
    .order-table th:nth-child(3) { width: 70px; }
    .order-table th:nth-child(4) { width: 70px; }
    
    .order-table tbody tr {
      border: 1px solid #28a745;
      transition: background 0.2s;
    }
    
    .order-table tbody tr:hover {
      background: #f5f7ff;
    }
    
    .order-table td {
      padding: 8px 5px;
      font-size: 12px;
      border: 1px solid #28a745;
    }
    
    .order-table td:first-child {
      font-size: 14px;
      font-weight: bold;
      color: #333;
      text-align: center;
    }
    
    .order-table select {
      width: 100%;
      padding: 6px 2px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      background: white;
      cursor: pointer;
      box-sizing: border-box;
      transition: all 0.3s;
    }
    
    .order-table select:focus {
      outline: none;
      border-color: #28a745;
      box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
    }
    
    .order-table select:not([value=""]) {
      background: #d4edda;
      border-color: #28a745;
    }
    
    .remarks-section {
      margin: 20px 0;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .remarks-section label {
      display: block;
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .remarks-section textarea {
      width: 100%;
      min-height: 100px;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      box-sizing: border-box;
      transition: all 0.3s;
    }
    
    .remarks-section textarea:focus {
      outline: none;
      border-color: #28a745;
      box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
    }
    
    .action-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    
    .btn {
      padding: 14px 24px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      flex: 1;
      min-width: 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.3);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .btn-save {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
    }
    
    .instructions {
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .instructions h3 {
      color: #d84315;
      margin-bottom: 12px;
      font-size: 16px;
    }
    
    .instructions ol {
      margin-left: 20px;
      color: #333;
      line-height: 1.8;
    }
    
    .instructions li {
      margin-bottom: 8px;
      font-size: 13px;
    }

    .instructions .warning {
      background: #fff3e0;
      border-left: 4px solid #ff6f00;
      padding: 10px;
      margin-top: 10px;
      border-radius: 4px;
      font-weight: bold;
      color: #e65100;
    }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ«æœ¬ä½“ */
    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 20px;
      padding: 30px;
      z-index: 1001;
      min-width: 300px;
      max-width: 90%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      animation: slideUp 0.4s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translate(-50%, -40%);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%);
      }
    }

    .modal-content {
      text-align: center;
    }

    .modal-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      animation: bounce 0.6s ease;
    }

    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .modal h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 22px;
    }

    .modal p {
      color: #666;
      margin-bottom: 25px;
      line-height: 1.6;
      font-size: 14px;
    }

    .modal-btn {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border: none;
      padding: 12px 40px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    }

    .modal-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
    }

    .modal-btn:active {
      transform: translateY(0);
    }

    /* PNGå‡ºåŠ›ç”¨ãƒ†ãƒ¼ãƒ–ãƒ« */
    #pngOutput {
      position: fixed;
      left: -9999px;
      top: 0;
      background: white;
      padding: 20px;
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
    }

    #pngOutput table {
      border-collapse: collapse;
      width: 100%;
      font-size: 14px;
    }

    #pngOutput th, #pngOutput td {
      border: 1px solid #000;
      padding: 8px;
      text-align: left;
    }

    #pngOutput th {
      background-color: #d4edda;
      font-weight: bold;
    }

    #pngOutput .header-row {
      background-color: #f8f9fa;
      font-weight: bold;
    }

    #pngOutput .title-cell {
      font-weight: bold;
      background-color: #e9ecef;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </h1>
    </div>
    
    <div class="info-section">
      <div class="info-row">
        <label for="customerCode">é¡§å®¢ã‚³ãƒ¼ãƒ‰</label>
        <input type="text" id="customerCode" placeholder="é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆä»»æ„ï¼‰">
      </div>
      <div class="info-row">
        <label for="storeName">åº—èˆ—å <span style="color: red;">*å¿…é ˆ</span></label>
        <input type="text" id="storeName" placeholder="åº—èˆ—åã‚’å…¥åŠ›">
      </div>
      <div class="info-row">
        <label for="ordererName">ç™ºæ³¨è€…å <span style="color: red;">*å¿…é ˆ</span></label>
        <input type="text" id="ordererName" placeholder="ç™ºæ³¨è€…åã‚’å…¥åŠ›">
      </div>
    </div>

    <!-- 2åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: å·¦ã«é£Ÿæã€å³ã«åŒ…æ -->
    <div class="tables-container">
      <!-- å·¦å´: é£Ÿæ -->
      <div class="table-section">
        <div class="section-title">é£Ÿæ</div>
        <table class="order-table">
          <thead>
            <tr>
              <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
              <th>å•†å“å</th>
              <th>ã‚±ãƒ¼ã‚¹æ•°</th>
              <th>ãƒãƒ©æ•°</th>
            </tr>
          </thead>
          <tbody id="shokuzaiBody"></tbody>
        </table>
      </div>

      <!-- å³å´: åŒ…æ -->
      <div class="table-section">
        <div class="section-title">åŒ…æ</div>
        <table class="order-table">
          <thead>
            <tr>
              <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
              <th>å•†å“å</th>
              <th>ã‚±ãƒ¼ã‚¹æ•°</th>
              <th>ãƒãƒ©æ•°</th>
            </tr>
          </thead>
          <tbody id="houzaiBody"></tbody>
        </table>
      </div>
    </div>
    
    <div class="remarks-section">
      <label for="remarks">å‚™è€ƒæ¬„</label>
      <textarea id="remarks" placeholder="å‚™è€ƒãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
    </div>
    
    <div class="action-buttons">
      <button class="btn btn-save" onclick="saveAndSend()">
        <span>ğŸ’¾</span>
        <span>ä¿å­˜ã—ã¦ç™ºæ³¨</span>
      </button>
    </div>

    <div class="instructions">
      <h3>ğŸ’¡ ä½¿ã„æ–¹</h3>
      <ol>
        <li>é¡§å®¢ã‚³ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰ã€åº—èˆ—åã€ç™ºæ³¨è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</li>
        <li>å„å•†å“ã®ã‚±ãƒ¼ã‚¹æ•°ãƒ»ãƒãƒ©æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„</li>
        <li>å¿…è¦ã«å¿œã˜ã¦å‚™è€ƒæ¬„ã«è¨˜å…¥ã—ã¦ãã ã•ã„</li>
        <li>ã€Œä¿å­˜ã—ã¦ç™ºæ³¨ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€PNGç”»åƒãŒä¿å­˜ã•ã‚Œã€ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™</li>
        <li>ä¿å­˜ã•ã‚ŒãŸPNGç”»åƒã‚’ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„</li>
      </ol>
      <div class="warning">
        âš ï¸ æ³¨æ„: ã‚±ãƒ¼ã‚¹ç™ºæ³¨ã®å•†å“ã‚’ãƒãƒ©ã§ç™ºæ³¨ã•ã‚Œã¦ã‚‚ã‚±ãƒ¼ã‚¹ç™ºæ³¨ã«ãªã‚Šã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„
      </div>
      <div class="warning" style="margin-top: 8px;">
        âš ï¸ é‡è¦: ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã•ã‚Œãªã„ã¨ç™ºæ³¨ã§ãã¾ã›ã‚“ã®ã§ã”æ³¨æ„ãã ã•ã„
      </div>
    </div>
  </div>

  <!-- PNGå‡ºåŠ›ç”¨ã®éš ã—ãƒ†ãƒ¼ãƒ–ãƒ« -->
  <div id="pngOutput"></div>

  <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-overlay" id="modalOverlay"></div>
  <div class="modal" id="successModal">
    <div class="modal-content">
      <div class="modal-icon">âœ¨</div>
      <h2>ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼</h2>
      <p>
        PNGç”»åƒã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸã€‚<br>
        ã“ã®å¾Œã€ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆãŒè‡ªå‹•çš„ã«ç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚<br>
        <strong style="color: #e65100;">å¿…ãšä¿å­˜ã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚</strong>
      </p>
      <button class="modal-btn" onclick="closeModal()">OK</button>
    </div>
  </div>

  <script>
    // é£Ÿæå•†å“ãƒªã‚¹ãƒˆ
    const shokuzaiProducts = [
      { code: '5', name: 'ãŸã“ç„¼ç²‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '6', name: 'ãŠå¥½ã¿ç²‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '425', name: 'ãƒ€ã‚·', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2090', name: 'ã‚¿ã‚³', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¤ã‚«', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '902', name: 'å¤©ã‹ã™', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '215', name: 'ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ç‰å­', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '283', name: 'ç²‰ã‚‚ã‚“å±‹å…«å”è¾›å­é†¤æ²¹1.8', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '383', name: 'ãƒãƒ³é…¢', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '320', name: 'ãƒãƒ¨ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '362', name: 'å¡©ã‚³ã‚·ãƒ§ã‚¦', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '520', name: 'é’ã•500ï½‡', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '716', name: 'ç´…ã‚·ãƒ§ã‚¦ã‚¬', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '1488', name: 'ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '514', name: 'ãã–ã¿ã®ã‚Š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '610', name: 'ãƒ©ãƒ¼ãƒ‰', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '322', name: 'ã¤ã¶ã¤ã¶æ˜å¤ªå­ãƒãƒ¨ãƒãƒ¼ã‚º', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æœŸé–“é™å®š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'èµ¤ã ã¾ã‚Šã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æ¢…ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '421', name: 'å’Œé¢¨ã ã—1.8L', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '506', name: 'æ‰‹ã‚‚ã¿ã‚«ãƒ„ã‚ª', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2366', name: 'ã‚²ã‚½ã®å”æšã’ã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2906', name: 'æè±†', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2430', name: 'ãƒãƒ†ãƒˆã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2355', name: 'ãªã‚“ã“ã¤500ï½‡ã€€æ „å’Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '208', name: 'ã‚¦ã‚¹ã‚¿ãƒ¼ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '246', name: 'å¡©ã ã‚Œ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '602', name: 'ç™½çµæ²¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '331', name: 'ã‚±ãƒãƒ£ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4007', name: 'ã‚¢ãƒ«ãƒšãƒƒãƒˆ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '2006', name: 'æ²¹ã‹ã™', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '317', name: 'ã‚¿ãƒ«ã‚¿ãƒ«ã‚½ãƒ¼ã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) }
    ];
    
    // åŒ…æå•†å“ãƒªã‚¹ãƒˆ
    const houzaiProducts = [
      { code: '3009', name: 'èˆŸï¼—å¯¸', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3011', name: 'èˆŸ9å¯¸', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3786', name: 'åå…¥ã‚Šè¢‹å°ã€€No.30', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3787', name: 'åå…¥ã‚Šè¢‹å¤§ No.35', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3843', name: 'ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3036', name: 'ç‰¹ä¸€æµ…', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3031', name: 'ãƒ‘ãƒƒã‚¯ä¸­æ·±', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3133', name: 'ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3132', name: 'ãƒ‘ãƒƒã‚¯å¤§æ·±', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(100, 1000, 100) },
      { code: '3662', name: 'ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '', name: 'ãƒ€ã‚·å®¹å™¨', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '', name: 'ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3611', name: 'è¢‹ä»˜ã¯ã—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(200, 2000, 200) },
      { code: '3201', name: 'ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '3200', name: 'ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(50, 500, 50) },
      { code: '', name: 'ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4513', name: 'æ›¿ç³¸ã€€å°', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4026', name: 'ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‹ãæ°·ã‚«ãƒƒãƒ—', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'æ°·ã‚¹ãƒˆãƒ­ãƒ¼', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '4008', name: 'æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '3645', name: 'è¼ªã‚´ãƒ ', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) },
      { code: '', name: 'ç´™ãŠã—ã¼ã‚Š', caseOptions: generateOptions(1, 10), baraOptions: generateOptions(1, 10) }
    ];
    
    // æ•°é‡é¸æŠè‚¢ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
    function generateOptions(start, end, step = 1) {
      const options = [''];
      for (let i = start; i <= end; i += step) {
        options.push(i);
      }
      return options;
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
    function createTableRow(product) {
      const row = document.createElement('tr');
      
      // å•†å“ã‚³ãƒ¼ãƒ‰
      const codeCell = document.createElement('td');
      codeCell.textContent = product.code;
      row.appendChild(codeCell);
      
      // å•†å“å
      const nameCell = document.createElement('td');
      nameCell.textContent = product.name;
      row.appendChild(nameCell);
      
      // ã‚±ãƒ¼ã‚¹æ•°
      const caseCell = document.createElement('td');
      const caseSelect = document.createElement('select');
      caseSelect.className = 'qty-case';
      caseSelect.dataset.code = product.code;
      caseSelect.dataset.product = product.name;
      product.caseOptions.forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt === '' ? '-' : opt;
        caseSelect.appendChild(option);
      });
      caseCell.appendChild(caseSelect);
      row.appendChild(caseCell);
      
      // ãƒãƒ©æ•°
      const baraCell = document.createElement('td');
      const baraSelect = document.createElement('select');
      baraSelect.className = 'qty-bara';
      baraSelect.dataset.code = product.code;
      baraSelect.dataset.product = product.name;
      product.baraOptions.forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt === '' ? '-' : opt;
        baraSelect.appendChild(option);
      });
      baraCell.appendChild(baraSelect);
      row.appendChild(baraCell);
      
      return row;
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
    function initializeTables() {
      const shokuzaiBody = document.getElementById('shokuzaiBody');
      const houzaiBody = document.getElementById('houzaiBody');
      
      shokuzaiProducts.forEach(product => {
        shokuzaiBody.appendChild(createTableRow(product));
      });
      
      houzaiProducts.forEach(product => {
        houzaiBody.appendChild(createTableRow(product));
      });
      
      // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
      document.querySelectorAll('select').forEach(select => {
        select.addEventListener('change', function() {
          if (this.value) {
            this.style.background = '#d4edda';
            this.style.borderColor = '#28a745';
          } else {
            this.style.background = 'white';
            this.style.borderColor = '#ddd';
          }
        });
      });
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    function showModal() {
      document.getElementById('modalOverlay').style.display = 'block';
      document.getElementById('successModal').style.display = 'block';
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeModal() {
      document.getElementById('modalOverlay').style.display = 'none';
      document.getElementById('successModal').style.display = 'none';
      
      // ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆã‚’èµ·å‹•
      if (savedFile) {
        const customerCode = document.getElementById('customerCode').value;
        const storeName = document.getElementById('storeName').value;
        const ordererName = document.getElementById('ordererName').value;
        const today = new Date();
        const orderDate = today.toISOString().split('T')[0];
        
        const subject = encodeURIComponent(`ã€ç™ºæ³¨ã€‘${storeName} - ${orderDate}`);
        const body = encodeURIComponent(
          `ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿ã‚’æ·»ä»˜ã—ã¦ã„ã¾ã™ã€‚\n\n` +
          `é¡§å®¢ã‚³ãƒ¼ãƒ‰: ${customerCode || 'æœªå…¥åŠ›'}\n` +
          `åº—èˆ—å: ${storeName}\n` +
          `ç™ºæ³¨è€…: ${ordererName}\n` +
          `ç™ºæ³¨æ—¥: ${orderDate}\n\n` +
          `â€»å¿…ãšä¿å­˜ã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã®ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚`
        );
        
        window.location.href = `mailto:eiwa-hattyu@eiwa-shokuhin.com?subject=${subject}&body=${body}`;
      }
    }
    
    // PNGä¿å­˜ã¨ãƒ¡ãƒ¼ãƒ«é€ä¿¡
    let savedFile = null;

    function saveAndSend() {
      const customerCode = document.getElementById('customerCode').value;
      const storeName = document.getElementById('storeName').value;
      const ordererName = document.getElementById('ordererName').value;
      const remarks = document.getElementById('remarks').value;
      
      if (!storeName || !ordererName) {
        alert('åº—èˆ—åã¨ç™ºæ³¨è€…åã¯å¿…é ˆã§ã™');
        return;
      }
      
      const today = new Date();
      const orderDate = today.toISOString().split('T')[0];
      
      // PNGå‡ºåŠ›ç”¨ã®HTMLã‚’ä½œæˆ
      const pngOutput = document.getElementById('pngOutput');
      pngOutput.innerHTML = '';
      
      const table = document.createElement('table');
      table.style.borderCollapse = 'collapse';
      table.style.width = '1123px'; // A4æ¨ª (297mm â‰ˆ 1123px at 96dpi)
      table.style.fontSize = '18px';
      table.style.fontFamily = 'Arial, sans-serif';
      table.style.fontWeight = 'bold';
      
      // ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
      table.innerHTML = `
        <tr class="header-row">
          <td colspan="9" style="border: 1px solid #000; padding: 12px; text-align: center; font-size: 24px; font-weight: bold;">ç™ºæ³¨è¡¨</td>
        </tr>
        <tr>
          <td class="title-cell" style="border: 1px solid #000; padding: 10px; width: 120px; font-weight: bold; font-size: 18px;">é¡§å®¢ã‚³ãƒ¼ãƒ‰</td>
          <td colspan="2" style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${customerCode || ''}</td>
          <td class="title-cell" style="border: 1px solid #000; padding: 10px; width: 100px; font-weight: bold; font-size: 18px;">åº—èˆ—å</td>
          <td colspan="3" style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${storeName}</td>
          <td class="title-cell" style="border: 1px solid #000; padding: 10px; width: 100px; font-weight: bold; font-size: 18px;">ç™ºæ³¨è€…</td>
          <td style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${ordererName}</td>
        </tr>
        <tr>
          <td class="title-cell" style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">ç™ºæ³¨æ—¥</td>
          <td colspan="8" style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${orderDate}</td>
        </tr>
        <tr><td colspan="9" style="border: 1px solid #000; padding: 5px;"></td></tr>
        <tr>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; font-size: 18px; font-weight: bold;">å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; font-size: 18px; font-weight: bold;">å•†å“å</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; width: 100px; font-size: 18px; font-weight: bold;">ã‚±ãƒ¼ã‚¹æ•°</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; width: 100px; font-size: 18px; font-weight: bold;">ãƒãƒ©æ•°</th>
          <th style="border: 1px solid #000; padding: 10px; width: 20px;"></th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; font-size: 18px; font-weight: bold;">å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; font-size: 18px; font-weight: bold;">å•†å“å</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; width: 100px; font-size: 18px; font-weight: bold;">ã‚±ãƒ¼ã‚¹æ•°</th>
          <th style="border: 1px solid #000; padding: 10px; background-color: #d4edda; width: 100px; font-size: 18px; font-weight: bold;">ãƒãƒ©æ•°</th>
        </tr>
      `;
      
      // é£Ÿæã¨åŒ…æã‚’æ¨ªä¸¦ã³ã§é…ç½®
      const maxRows = Math.max(shokuzaiProducts.length, houzaiProducts.length);
      
      for (let i = 0; i < maxRows; i++) {
        const row = document.createElement('tr');
        
        // é£Ÿæãƒ‡ãƒ¼ã‚¿
        if (i < shokuzaiProducts.length) {
          const shokuzaiRow = document.querySelectorAll('#shokuzaiBody tr')[i];
          const code = shokuzaiRow.cells[0].textContent;
          const name = shokuzaiRow.cells[1].textContent;
          const caseQty = shokuzaiRow.querySelector('.qty-case').value || '';
          const baraQty = shokuzaiRow.querySelector('.qty-bara').value || '';
          row.innerHTML += `
            <td style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${code}</td>
            <td style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${name}</td>
            <td style="border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; font-size: 18px;">${caseQty}</td>
            <td style="border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; font-size: 18px;">${baraQty}</td>
          `;
        } else {
          row.innerHTML += `
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
          `;
        }
        
        row.innerHTML += `<td style="border: 1px solid #000; padding: 10px;"></td>`;
        
        // åŒ…æãƒ‡ãƒ¼ã‚¿
        if (i < houzaiProducts.length) {
          const houzaiRow = document.querySelectorAll('#houzaiBody tr')[i];
          const code = houzaiRow.cells[0].textContent;
          const name = houzaiRow.cells[1].textContent;
          const caseQty = houzaiRow.querySelector('.qty-case').value || '';
          const baraQty = houzaiRow.querySelector('.qty-bara').value || '';
          row.innerHTML += `
            <td style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${code}</td>
            <td style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">${name}</td>
            <td style="border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; font-size: 18px;">${caseQty}</td>
            <td style="border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; font-size: 18px;">${baraQty}</td>
          `;
        } else {
          row.innerHTML += `
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
            <td style="border: 1px solid #000; padding: 10px;"></td>
          `;
        }
        
        table.appendChild(row);
      }
      
      // å‚™è€ƒæ¬„
      table.innerHTML += `
        <tr><td colspan="9" style="border: 1px solid #000; padding: 5px;"></td></tr>
        <tr><td colspan="9" class="title-cell" style="border: 1px solid #000; padding: 10px; font-weight: bold; font-size: 18px;">å‚™è€ƒæ¬„</td></tr>
        <tr><td colspan="9" style="border: 1px solid #000; padding: 10px; min-height: 150px; height: 150px; font-weight: bold; font-size: 18px; vertical-align: top;">${remarks}</td></tr>
      `;
      
      pngOutput.appendChild(table);
      
      // html2canvasã§PNGç”Ÿæˆ
      html2canvas(pngOutput, {
        backgroundColor: '#ffffff',
        scale: 2
      }).then(canvas => {
        // PNGã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        const filename = `ç™ºæ³¨_${storeName}_${orderDate}.png`;
        canvas.toBlob(blob => {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä¿å­˜
          savedFile = filename;
          
          // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
          showModal();
        });
      });
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
    window.addEventListener('DOMContentLoaded', initializeTables);
  </script>
</body>
</html>