<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <meta name="googlebot" content="noindex, nofollow, noarchive">
    <meta name="bingbot" content="noindex, nofollow, noarchive">
    <title>ç®¡ç†ç”»é¢</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            .print-content, .print-content * {
                visibility: visible;
            }
            .print-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 210mm;
            }
            @page {
                size: A4;
                margin: 15mm;
            }
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
    <div id="loading-screen" style="position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:99999;color:white;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;">
        <div style="text-align:center;padding:20px;">
            <div style="font-size:52px;margin-bottom:20px;">âš™ï¸</div>
            <div style="font-size:22px;font-weight:bold;margin-bottom:10px;">ç®¡ç†ç”»é¢ã‚’æº–å‚™ä¸­...</div>
            <div style="font-size:14px;opacity:0.85;margin-bottom:30px;">åˆå›èª­ã¿è¾¼ã¿ã«å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™</div>
            <div style="width:260px;height:6px;background:rgba(255,255,255,0.3);border-radius:10px;overflow:hidden;margin:0 auto 20px;">
                <div id="ls-bar" style="height:100%;width:5%;background:white;border-radius:10px;transition:width 3s ease;"></div>
            </div>
            <div id="ls-tip" style="font-size:13px;opacity:0.75;transition:opacity 0.3s;">JavaScriptã‚’è§£æä¸­...</div>
            <div id="ls-error" style="display:none;margin-top:20px;padding:15px;background:rgba(255,80,80,0.3);border-radius:10px;font-size:14px;">
                èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<br><button onclick="location.reload()" style="margin-top:10px;padding:8px 20px;background:white;color:#764ba2;border:none;border-radius:8px;font-weight:bold;cursor:pointer;">å†èª­ã¿è¾¼ã¿</button>
            </div>
        </div>
    </div>
    

    <script>
    (function() {
        var tips = ['JavaScriptã‚’è§£æä¸­...','Babelã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¸­...','ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆæœŸåŒ–ä¸­...','Firebaseã«æ¥ç¶šä¸­...','ã‚‚ã†ã™ãå®Œäº†ã—ã¾ã™...'];
        var ti = 0;
        var targets = [10, 25, 45, 65, 80, 92];
        var step = 0;
        function advanceBar() {
            var bar = document.getElementById('ls-bar');
            if (bar && step < targets.length) {
                bar.style.width = targets[step] + '%';
                step++;
                setTimeout(advanceBar, 4000);
            }
        }
        setTimeout(advanceBar, 500);
        setInterval(function() {
            var el = document.getElementById('ls-tip');
            if (!el) return;
            ti = (ti + 1) % tips.length;
            el.style.opacity = '0';
            setTimeout(function() { if(el){el.textContent=tips[ti];el.style.opacity='0.75';} }, 300);
        }, 5000);
        // æœ€å¤§60ç§’ã§ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        setTimeout(function() {
            var ls = document.getElementById('loading-screen');
            if (ls && ls.style.display !== 'none') {
                var tip = document.getElementById('ls-tip');
                var err = document.getElementById('ls-error');
                if (tip) tip.style.display = 'none';
                if (err) err.style.display = 'block';
            }
        }, 60000);
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹ï¼ˆReactã‹ã‚‰å‘¼ã³å‡ºã™ç”¨ï¼‰
        window.hideLoadingScreen = function() {
            var ls = document.getElementById('loading-screen');
            if (ls) {
                var bar = document.getElementById('ls-bar');
                if (bar) bar.style.width = '100%';
                setTimeout(function() {
                    ls.style.transition = 'opacity 0.6s ease';
                    ls.style.opacity = '0';
                    setTimeout(function() { if(ls.parentNode) ls.parentNode.removeChild(ls); }, 600);
                }, 300);
            }
        };
        // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¶ˆã™
        window.onerror = function(msg, src, line) {
            console.error('Global error:', msg, src, line);
            // Babel/Reactã®ã‚¨ãƒ©ãƒ¼ã§ã‚‚60ç§’å¾Œã«ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºï¼ˆä¸Šã®ã‚¿ã‚¤ãƒãƒ¼ã«ä»»ã›ã‚‹ï¼‰
        };
    })();
    </script>

    <div id="root"></div>

    <!-- FirebaseåˆæœŸåŒ– -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, getDoc, addDoc, onSnapshot, updateDoc, deleteDoc, doc, setDoc, query, where, Timestamp, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBoSdfEkez-b3P0BUHtowxCrTw-yEBdHSg",
            authDomain: "takoyaki-order-system-bacd7.firebaseapp.com",
            projectId: "takoyaki-order-system-bacd7",
            storageBucket: "takoyaki-order-system-bacd7.firebasestorage.app",
            messagingSenderId: "104494752890",
            appId: "1:104494752890:web:c0a25d62f42ffca01687c3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const auth = getAuth(app);

        window.FirebaseReady = true;
        window.db = db;
        window.storage = storage;
        window.auth = auth;
        window.storageRef = ref;
        window.uploadBytes = uploadBytes;
        window.getDownloadURL = getDownloadURL;
        window.firebaseModules = { 
            collection, getDocs, getDoc, addDoc, onSnapshot, 
            updateDoc, deleteDoc, doc, setDoc, query, where, 
            Timestamp, orderBy, ref, uploadBytes, getDownloadURL, signInAnonymously 
        };
    </script>

    <script>
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
// CRITICAL: ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–ï¼ˆpos.htmlã¨å®Œå…¨ã«åŒã˜ï¼‰
// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å¿…ãšnullã«ãƒªã‚»ãƒƒãƒˆ
window.currentStoreId = null;
window.currentStoreName = null;
console.log('ğŸ”§ kanri.htmlåˆæœŸåŒ–: window.currentStoreId =', window.currentStoreId);
// ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°: åº—èˆ—åˆ¥ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å‚ç…§ã‚’å–å¾—ï¼ˆpos.htmlã¨åŒã˜ï¼‰
window.getStoreCollection = function (collectionName) {
    console.log('ğŸ” KANRI getStoreCollection:', collectionName, 'currentStoreId:', window.currentStoreId, 'type:', typeof window.currentStoreId);
    if (!window.currentStoreId || window.currentStoreId === '' || window.currentStoreId === null) {
        console.warn('åº—èˆ—IDãŒæœªè¨­å®šã®ãŸã‚ã€æ—§ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™');
        // æ—§ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚°
        const oldPathMap = {
            'receipt_settings': 'receipt_settings',
            'menu_settings': 'menu_settings',
            'employees': 'kintai_employees',
            'attendance': 'kintai_attendance'
        };
        const path = oldPathMap[collectionName] || collectionName;
        console.log('  â†’ æ—§ãƒ‘ã‚¹:', path);
        return window.firebaseModules.collection(window.db, path);
    }
    console.log('  â†’ æ–°ãƒ‘ã‚¹: stores/' + window.currentStoreId + '/' + collectionName);
    return window.firebaseModules.collection(window.db, 'stores', window.currentStoreId, collectionName);
};
// ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°: åº—èˆ—åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§ã‚’å–å¾—ï¼ˆpos.htmlã¨åŒã˜ï¼‰
window.getStoreDoc = function (collectionName, docId) {
    if (!window.currentStoreId || window.currentStoreId === '' || window.currentStoreId === null) {
        console.warn('åº—èˆ—IDãŒæœªè¨­å®šã®ãŸã‚ã€æ—§ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™');
        // ğŸ”§ ä¿®æ­£: æ—§ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹ã§ã¯å¸¸ã«shimoakatsukaã‚’ä½¿ç”¨
        const oldPathMap = {
            'receipt_settings': 'receipt_settings',
            'menu_settings': 'menu_settings',
            'alert_settings': 'alert_settings',
            'employees': 'kintai_employees',
            'attendance': 'kintai_attendance'
        };
        const path = oldPathMap[collectionName] || collectionName;
        // æ—§ãƒ‘ã‚¹ã§ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯å¸¸ã«'shimoakatsuka'ã‚’ä½¿ç”¨
        const oldDocId = (collectionName === 'receipt_settings' || collectionName === 'menu_settings' || collectionName === 'alert_settings') ? 'shimoakatsuka' : docId;
        console.log('  â†’ æ—§ãƒ‘ã‚¹:', path + '/' + oldDocId);
        return window.firebaseModules.doc(window.db, path, oldDocId);
    }
    console.log('  â†’ æ–°ãƒ‘ã‚¹: stores/' + window.currentStoreId + '/' + collectionName + '/' + docId);
    return window.firebaseModules.doc(window.db, 'stores', window.currentStoreId, collectionName, docId);
};
const { useState, useEffect } = React;
// ğŸ†• ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°: ç¾åœ¨è¨ˆç®—ä¸­ã®çµ¦ä¸ã‚¿ã‚¤ãƒ—
window.currentSalaryCalculationType = 'hourly';
// Icons
const Icon = (_a) => {
    var { children } = _a, props = __rest(_a, ["children"]);
    return (React.createElement("svg", Object.assign({ xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" }, props), children));
};
const Users = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("path", { d: "M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" }),
    React.createElement("circle", { cx: "9", cy: "7", r: "4" }),
    React.createElement("path", { d: "M23 21v-2a4 4 0 0 0-3-3.87" }),
    React.createElement("path", { d: "M16 3.13a4 4 0 0 1 0 7.75" })));
const Plus = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("line", { x1: "12", y1: "5", x2: "12", y2: "19" }),
    React.createElement("line", { x1: "5", y1: "12", x2: "19", y2: "12" })));
const Edit2 = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("path", { d: "M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" })));
const Save = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("path", { d: "M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" }),
    React.createElement("polyline", { points: "17 21 17 13 7 13 7 21" }),
    React.createElement("polyline", { points: "7 3 7 8 15 8" })));
const X = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("line", { x1: "18", y1: "6", x2: "6", y2: "18" }),
    React.createElement("line", { x1: "6", y1: "6", x2: "18", y2: "18" })));
const Download = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" }),
    React.createElement("polyline", { points: "7 10 12 15 17 10" }),
    React.createElement("line", { x1: "12", y1: "15", x2: "12", y2: "3" })));
const Printer = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("polyline", { points: "6 9 6 2 18 2 18 9" }),
    React.createElement("path", { d: "M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" }),
    React.createElement("rect", { x: "6", y: "14", width: "12", height: "8" })));
const Lock = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("rect", { x: "3", y: "11", width: "18", height: "11", rx: "2", ry: "2" }),
    React.createElement("path", { d: "M7 11V7a5 5 0 0 1 10 0v4" })));
const ArrowLeft = (props) => (React.createElement(Icon, Object.assign({}, props),
    React.createElement("line", { x1: "19", y1: "12", x2: "5", y2: "12" }),
    React.createElement("polyline", { points: "12 19 5 12 12 5" })));
// ç¤¾ä¼šä¿é™ºæ–™è¨ˆç®—ç”¨ãƒ‡ãƒ¼ã‚¿ï¼ˆ2025å¹´åº¦ç‰ˆï¼‰
const INSURANCE_DATA = {
    // å¥åº·ä¿é™ºæ–™ç‡ï¼ˆéƒ½é“åºœçœŒåˆ¥ã€å”ä¼šã‘ã‚“ã½ï¼‰
    healthInsuranceRates: {
        'åŒ—æµ·é“': 0.1034, 'é’æ£®': 0.0998, 'å²©æ‰‹': 0.0998, 'å®®åŸ': 0.1002, 'ç§‹ç”°': 0.1002,
        'å±±å½¢': 0.0998, 'ç¦å³¶': 0.0996, 'èŒ¨åŸ': 0.0998, 'æ ƒæœ¨': 0.0994, 'ç¾¤é¦¬': 0.0996,
        'åŸ¼ç‰': 0.0998, 'åƒè‘‰': 0.1000, 'æ±äº¬': 0.1000, 'ç¥å¥ˆå·': 0.1002, 'æ–°æ½Ÿ': 0.0996,
        'å¯Œå±±': 0.0968, 'çŸ³å·': 0.0994, 'ç¦äº•': 0.0992, 'å±±æ¢¨': 0.0996, 'é•·é‡': 0.0988,
        'å²é˜œ': 0.0990, 'é™å²¡': 0.0988, 'æ„›çŸ¥': 0.1000, 'ä¸‰é‡': 0.0994, 'æ»‹è³€': 0.0994,
        'äº¬éƒ½': 0.1010, 'å¤§é˜ª': 0.1024, 'å…µåº«': 0.1018, 'å¥ˆè‰¯': 0.1006, 'å’Œæ­Œå±±': 0.1008,
        'é³¥å–': 0.0994, 'å³¶æ ¹': 0.0996, 'å²¡å±±': 0.1008, 'åºƒå³¶': 0.1000, 'å±±å£': 0.1006,
        'å¾³å³¶': 0.1010, 'é¦™å·': 0.1026, 'æ„›åª›': 0.1004, 'é«˜çŸ¥': 0.1020, 'ç¦å²¡': 0.1034,
        'ä½è³€': 0.1074, 'é•·å´': 0.1026, 'ç†Šæœ¬': 0.1028, 'å¤§åˆ†': 0.1022, 'å®®å´': 0.0998,
        'é¹¿å…å³¶': 0.1024, 'æ²–ç¸„': 0.0992
    },
    // ä»‹è­·ä¿é™ºæ–™ç‡ï¼ˆ40æ­³ä»¥ä¸Šï¼‰
    nursingCareRate: 0.0182,
    // åšç”Ÿå¹´é‡‘ä¿é™ºæ–™ç‡
    pensionRate: 0.183,
    // é›‡ç”¨ä¿é™ºæ–™ç‡
    employmentInsuranceRate: 0.006,
    // æ¨™æº–å ±é…¬æœˆé¡è¡¨ï¼ˆå¥åº·ä¿é™ºãƒ»åšç”Ÿå¹´é‡‘ï¼‰
    standardMonthlyRemuneration: [
        { min: 0, max: 63000, standard: 58000 },
        { min: 63000, max: 73000, standard: 68000 },
        { min: 73000, max: 83000, standard: 78000 },
        { min: 83000, max: 93000, standard: 88000 },
        { min: 93000, max: 101000, standard: 98000 },
        { min: 101000, max: 107000, standard: 104000 },
        { min: 107000, max: 114000, standard: 110000 },
        { min: 114000, max: 122000, standard: 118000 },
        { min: 122000, max: 130000, standard: 126000 },
        { min: 130000, max: 138000, standard: 134000 },
        { min: 138000, max: 146000, standard: 142000 },
        { min: 146000, max: 155000, standard: 150000 },
        { min: 155000, max: 165000, standard: 160000 },
        { min: 165000, max: 175000, standard: 170000 },
        { min: 175000, max: 185000, standard: 180000 },
        { min: 185000, max: 195000, standard: 190000 },
        { min: 195000, max: 210000, standard: 200000 },
        { min: 210000, max: 230000, standard: 220000 },
        { min: 230000, max: 250000, standard: 240000 },
        { min: 250000, max: 270000, standard: 260000 },
        { min: 270000, max: 290000, standard: 280000 },
        { min: 290000, max: 310000, standard: 300000 },
        { min: 310000, max: 330000, standard: 320000 },
        { min: 330000, max: 350000, standard: 340000 },
        { min: 350000, max: 370000, standard: 360000 },
        { min: 370000, max: 395000, standard: 380000 },
        { min: 395000, max: 425000, standard: 410000 },
        { min: 425000, max: 455000, standard: 440000 },
        { min: 455000, max: 485000, standard: 470000 },
        { min: 485000, max: 515000, standard: 500000 },
        { min: 515000, max: 545000, standard: 530000 },
        { min: 545000, max: 575000, standard: 560000 },
        { min: 575000, max: 605000, standard: 590000 },
        { min: 605000, max: 635000, standard: 620000 },
        { min: 635000, max: 665000, standard: 650000 },
        { min: 665000, max: 695000, standard: 680000 },
        { min: 695000, max: 730000, standard: 710000 },
        { min: 730000, max: 770000, standard: 750000 },
        { min: 770000, max: 810000, standard: 790000 },
        { min: 810000, max: 855000, standard: 830000 },
        { min: 855000, max: 905000, standard: 880000 },
        { min: 905000, max: 955000, standard: 930000 },
        { min: 955000, max: 1005000, standard: 980000 },
        { min: 1005000, max: 1055000, standard: 1030000 },
        { min: 1055000, max: 1115000, standard: 1090000 },
        { min: 1115000, max: 1175000, standard: 1150000 },
        { min: 1175000, max: 1235000, standard: 1210000 },
        { min: 1235000, max: 1295000, standard: 1270000 },
        { min: 1295000, max: 1355000, standard: 1330000 },
        { min: 1355000, max: Infinity, standard: 1390000 }
    ],
    // æœ€ä½è³ƒé‡‘ï¼ˆéƒ½é“åºœçœŒåˆ¥ã€2024å¹´10æœˆã€œï¼‰
    minimumWage: {
        'åŒ—æµ·é“': 1010, 'é’æ£®': 953, 'å²©æ‰‹': 952, 'å®®åŸ': 973, 'ç§‹ç”°': 948,
        'å±±å½¢': 951, 'ç¦å³¶': 960, 'èŒ¨åŸ': 1003, 'æ ƒæœ¨': 1004, 'ç¾¤é¦¬': 985,
        'åŸ¼ç‰': 1078, 'åƒè‘‰': 1076, 'æ±äº¬': 1163, 'ç¥å¥ˆå·': 1162, 'æ–°æ½Ÿ': 981,
        'å¯Œå±±': 998, 'çŸ³å·': 988, 'ç¦äº•': 982, 'å±±æ¢¨': 1003, 'é•·é‡': 1011,
        'å²é˜œ': 1001, 'é™å²¡': 1034, 'æ„›çŸ¥': 1067, 'ä¸‰é‡': 1023, 'æ»‹è³€': 1017,
        'äº¬éƒ½': 1058, 'å¤§é˜ª': 1094, 'å…µåº«': 1051, 'å¥ˆè‰¯': 1006, 'å’Œæ­Œå±±': 978,
        'é³¥å–': 950, 'å³¶æ ¹': 951, 'å²¡å±±': 982, 'åºƒå³¶': 1024, 'å±±å£': 970,
        'å¾³å³¶': 970, 'é¦™å·': 970, 'æ„›åª›': 960, 'é«˜çŸ¥': 952, 'ç¦å²¡': 1010,
        'ä½è³€': 952, 'é•·å´': 953, 'ç†Šæœ¬': 952, 'å¤§åˆ†': 952, 'å®®å´': 950,
        'é¹¿å…å³¶': 953, 'æ²–ç¸„': 952
    }
};
const AdminSystem = () => {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4, _5, _6;
    const [employees, setEmployees] = useState([]);
    const [attendanceData, setAttendanceData] = useState({});
    const [currentMonth, setCurrentMonth] = useState(new Date().getMonth());
    const [currentYear, setCurrentYear] = useState(new Date().getFullYear());
    const [editingEmployee, setEditingEmployee] = useState(null);
    const [showAddEmployee, setShowAddEmployee] = useState(false);
    const [selectedPayslipEmployee, setSelectedPayslipEmployee] = useState(null);
    const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(false);
    const [storeNameInput, setStoreNameInput] = useState('');
    const [passwordInput, setPasswordInput] = useState('');
    const [editingTime, setEditingTime] = useState(null);
    const [editingValue, setEditingValue] = useState('');
    const [editingMemo, setEditingMemo] = useState('');
    // ğŸ†• è¨ˆç®—ã•ã‚ŒãŸä½æ°‘ç¨ã‚’ä¿å­˜ï¼ˆæ™‚é–“çµ¦ãƒ»å›ºå®šçµ¦åˆ¥ã€…ï¼‰
    const [calculatedResidentTaxes, setCalculatedResidentTaxes] = useState({});
    // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šç”¨ã®state
    const [receiptSettings, setReceiptSettings] = useState({
        storeName: 'ç²‰ã‚‚ã‚“å±‹ å…«',
        branchName: 'ä¸‹èµ¤å¡šåº—',
        postalCode: '175-0092',
        address: 'æ±äº¬éƒ½æ¿æ©‹åŒºèµ¤å¡š2-2-4',
        phone: '03-6904-2888',
        message: 'ã”æ¥åº—ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ\nã¾ãŸã®ãŠè¶Šã—ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™',
        stampImage: '' // é›»å­å°é‘‘ã®base64ãƒ‡ãƒ¼ã‚¿
    });
    const [showReceiptSettings, setShowReceiptSettings] = useState(false);
    const [showAlertSettings, setShowAlertSettings] = useState(false);
    const [showEmployeeManagement, setShowEmployeeManagement] = useState(false);
    const [showDeleteSettings, setShowDeleteSettings] = useState(false);
    const [showBackupManagement, setShowBackupManagement] = useState(false);
    // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šç”¨ã®state
    const [alertSettings, setAlertSettings] = useState({
        completeMessage: 'å•†å“ãŒå‡ºæ¥ä¸ŠãŒã‚Šã¾ã—ãŸï¼\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç”»é¢ã®æ³¨æ–‡ç•ªå·ã‚’åº—å“¡ã«ãŠè¦‹ã›ãã ã•ã„',
        cancelMessage: 'æ³¨æ–‡ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç•ªå·ã‚’ãŠå‘¼ã³ã—ã¾ã—ãŸãŒã”ä¸åœ¨ã§ã—ãŸã®ã§\næ³¨æ–‡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã›ã¦é ‚ãã¾ã—ãŸ'
    });
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šç”¨ã®state
    const [statusDisplaySettings, setStatusDisplaySettings] = useState({
        preparing: '',
        completed: '',
        ready: '',
        cancelled: ''
    });
    const [showStatusDisplaySettings, setShowStatusDisplaySettings] = useState(false);
    // å–¶æ¥­æ™‚é–“å¤–è¨­å®šç”¨ã®state
    const [businessHoursSettings, setBusinessHoursSettings] = useState({
        enabled: false, // å–¶æ¥­æ™‚é–“å¤–è¨­å®šã‚’æœ‰åŠ¹ã«ã™ã‚‹ã‹
        openTime: '09:00',
        closeTime: '22:00',
        closedMessage: 'å–¶æ¥­æ™‚é–“å¤–ã§ã™\n\nå–¶æ¥­æ™‚é–“: {openTime} - {closeTime}\n\nå–¶æ¥­æ™‚é–“å†…ã«ã”åˆ©ç”¨ãã ã•ã„'
    });
    const [showBusinessHoursSettings, setShowBusinessHoursSettings] = useState(false);
    // ğŸ†• ä¼‘æ¥­æ—¥è¨­å®šç”¨ã®state
    const [closedDaysSettings, setClosedDaysSettings] = useState({
        weeklyClosedDays: [], // å®šä¼‘æ—¥ï¼ˆ0=æ—¥æ›œã€1=æœˆæ›œã€...ã€6=åœŸæ›œï¼‰
        specificClosedDates: [], // æŒ‡å®šä¼‘æ¥­æ—¥ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰
        closedMessage: 'æœ¬æ—¥ã¯ä¼‘æ¥­æ—¥ã§ã™'
    });
    const [showClosedDaysSettings, setShowClosedDaysSettings] = useState(false);
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºè¨­å®šç”¨ã®state
    const [menuSettings, setMenuSettings] = useState({
        showMemoField: true, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤º
        showNameField: false,
        showPostalCodeField: false,
        showAddressField: false,
        showEmailField: false,
        showPhoneField: false, // é›»è©±ç•ªå·æ¬„
        nameRequired: false,
        postalCodeRequired: false,
        addressRequired: false,
        emailRequired: false,
        phoneRequired: false, // é›»è©±ç•ªå·ã‚’å¿…é ˆã«ã™ã‚‹
        statusMessage: 'ã“ã®ç•ªå·ã§ãŠå‘¼ã³ã—ã¾ã™ã®ã§\nå•†å“ã‚’å—ã‘å–ã‚‹ã¾ã§\nã“ã®ç”»é¢ã‚’é–‰ã˜ãªã„ã§ãã ã•ã„',
        warningMessage: 'é‡è¦ãªãŠçŸ¥ã‚‰ã›\n\nâ€¢ å¸­ã‚’å¤–ã™éš›ã«ã¯å…ˆã«\nãŠä¼šè¨ˆã‚’æ¸ˆã¾ã›ã¦ãã ã•ã„\n\nâ€¢ ç•ªå·ã‚’ãŠå‘¼ã³ã—ã¦ã‚‚æœªä¼šè¨ˆã®ã¾ã¾å¸­ã‚’å¤–ã•ã‚Œã¾ã™ã¨æ³¨æ–‡ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™',
        // ãƒ¬ã‚¸è¢‹è¨­å®š
        showBagOption: true, // ãƒ¬ã‚¸è¢‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹ã‹
        bagPrice: 3, // ãƒ¬ã‚¸è¢‹1æšã®ä¾¡æ ¼
        bagMessage: 'â€» 1æš3å•†å“ç¨‹åº¦å…¥ã‚Šã¾ã™' // ãƒ¬ã‚¸è¢‹ã®èª¬æ˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    });
    const [showMenuSettings, setShowMenuSettings] = useState(false);
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šç”¨ã®state
    const [tableSettings, setTableSettings] = useState({});
    const [showTableSettings, setShowTableSettings] = useState(false);
    const [selectedTable, setSelectedTable] = useState('');
    const [availableMenuItems, setAvailableMenuItems] = useState([]);
    const [availableTables, setAvailableTables] = useState([]); // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§
    const [selectedCategory, setSelectedCategory] = useState('all'); // ğŸ†• ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    // ğŸ†• menu.htmlå…¨ä½“ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†ç”¨ã®state
    const [showMenuManagement, setShowMenuManagement] = useState(false);
    const [menuManagementCategory, setMenuManagementCategory] = useState('all');
    const [globalMenuSettings, setGlobalMenuSettings] = useState({
        hiddenCategories: [], // éè¡¨ç¤ºã«ã™ã‚‹ã‚«ãƒ†ã‚´ãƒª
        menuOrder: [] // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®è¡¨ç¤ºé †ï¼ˆidã®é…åˆ—ï¼‰
    });
    // ğŸ†• å•†å“ç®¡ç†ç”¨ã®state
    const [showProductManagement, setShowProductManagement] = useState(false);
    const [showProductRegistration, setShowProductRegistration] = useState(false);
    const [showProductEdit, setShowProductEdit] = useState(false);
    const [showProductDelete, setShowProductDelete] = useState(false);
    const [deleteTab, setDeleteTab] = useState('active'); // 'active' or 'hidden'
    const [productForm, setProductForm] = useState({
        name: '',
        price: '',
        category: '',
        customCategory: '',
        note: '',
        image: '',
        taxRate: 10,
        taxType: 'inclusive', // 'inclusive'(å†…ç¨) or 'exclusive'(å¤–ç¨)
        foodType: 'food' // 'food'(é£Ÿæ) or 'non-food'(é£Ÿæä»¥å¤–)
    });
    const [editingProductId, setEditingProductId] = useState(null);
    const [productToppingSets, setProductToppingSets] = useState([]);
    const [productsForDelete, setProductsForDelete] = useState([]);
    const [productsForEdit, setProductsForEdit] = useState([]);
    const [productSearchQuery, setProductSearchQuery] = useState('');
    const [editSearchQuery, setEditSearchQuery] = useState('');
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ç®¡ç†ç”¨ã®state
    const [showTableManagement, setShowTableManagement] = useState(false);
    const [showAddTable, setShowAddTable] = useState(false);
    const [showEditTable, setShowEditTable] = useState(false);
    const [showQrCode, setShowQrCode] = useState(false);
    const [tables, setTables] = useState([]);
    const [newTableForm, setNewTableForm] = useState({
        name: '',
        staffMemo: '',
        memoEnabled: false
    });
    const [editTableForm, setEditTableForm] = useState({
        id: '',
        name: '',
        staffMemo: '',
        memoEnabled: false
    });
    const [qrCodeData, setQrCodeData] = useState({ name: '', url: '' });
    // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆç”¨ã®çŠ¶æ…‹
    const [showCustomAlert, setShowCustomAlert] = useState(false);
    const [alertMessage, setAlertMessage] = useState('');
    // ğŸ†• åœ¨åº«ç®¡ç†ç”¨ã®state
    const [showInventoryManagement, setShowInventoryManagement] = useState(false);
    const [inventoryCurrentPage, setInventoryCurrentPage] = useState(1);
    const inventoryItemsPerPage = 10;
    const [selectedInventoryCategory, setSelectedInventoryCategory] = useState('å…¨ã¦');
    const [selectedInventoryStatus, setSelectedInventoryStatus] = useState('å…¨ã¦');
    const [inventorySearchQuery, setInventorySearchQuery] = useState('');
    const [inventorySettings, setInventorySettings] = useState({}); // { menuItemId: { stock: number, alertThreshold: number } }
    const [alertTitle, setAlertTitle] = useState('');
    const [alertIcon, setAlertIcon] = useState('');
    const [showCustomConfirm, setShowCustomConfirm] = useState(false);
    const [confirmMessage, setConfirmMessage] = useState('');
    const [confirmTitle, setConfirmTitle] = useState('');
    const [confirmIcon, setConfirmIcon] = useState('');
    const [confirmOkText, setConfirmOkText] = useState('OK');
    const [confirmCancelText, setConfirmCancelText] = useState('ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
    const [confirmResolve, setConfirmResolve] = useState(null);
    const [editingIsHoliday, setEditingIsHoliday] = useState(false);
    const [editingHourlyRate, setEditingHourlyRate] = useState('');
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState(null);
    // ğŸ†• ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ãƒšãƒ¼ã‚¸ç”»åƒè¨­å®šç”¨ã®state
    const [showImageSettings, setShowImageSettings] = useState(false);
    const [currentStoreData, setCurrentStoreData] = useState(null);
    const [imageUploading, setImageUploading] = useState({
        main: false,
        welcome: false,
        button: false,
        header: false,
        background: false
    });
    // ğŸ†• ãƒ‡ãƒ¼ã‚¿é€£æºç”¨ã®state
    const [showDataExport, setShowDataExport] = useState(false);
    const [exportStartDate, setExportStartDate] = useState(() => {
        const now = new Date();
        return `${now.getFullYear()}-01-01`;
    });
    const [exportEndDate, setExportEndDate] = useState(() => {
        const now = new Date();
        return `${now.getFullYear()}-12-31`;
    });
    // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºé–¢æ•°
    const showCustomAlertFunc = (message, title = 'ãŠçŸ¥ã‚‰ã›', icon = 'â„¹ï¸') => {
        setAlertMessage(message);
        setAlertTitle(title);
        setAlertIcon(icon);
        setShowCustomAlert(true);
    };
    // ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºé–¢æ•°
    const showCustomConfirmFunc = (message, title = 'ç¢ºèª', okText = 'OK', cancelText = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«', icon = 'â“') => {
        return new Promise((resolve) => {
            setConfirmMessage(message);
            setConfirmTitle(title);
            setConfirmOkText(okText);
            setConfirmCancelText(cancelText);
            setConfirmIcon(icon);
            setConfirmResolve(() => resolve);
            setShowCustomConfirm(true);
        });
    };
    // ğŸ†• ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ãƒšãƒ¼ã‚¸ç”»åƒè¨­å®šã‚’é–‹ã
    const openImageSettings = async () => {
        setShowImageSettings(true);
        // ç¾åœ¨ã®åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
        try {
            if (window.currentStoreId) {
                const { doc, getDoc } = window.firebaseModules;
                const storeRef = doc(window.db, 'stores', window.currentStoreId);
                const storeDoc = await getDoc(storeRef);
                if (storeDoc.exists()) {
                    setCurrentStoreData(Object.assign({ id: storeDoc.id }, storeDoc.data()));
                }
            }
        }
        catch (error) {
            console.error('åº—èˆ—ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
    const handleImageUpload = async (imageType, file) => {
        if (!file)
            return;
        if (!window.currentStoreId) {
            showCustomAlertFunc('ã“ã®æ©Ÿèƒ½ã¯æ–°åº—èˆ—ã®ã¿åˆ©ç”¨å¯èƒ½ã§ã™', 'âš ï¸ ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
            return;
        }
        const { ref, uploadBytes, getDownloadURL, updateDoc, doc, signInAnonymously } = window.firebaseModules;
        setImageUploading(prev => (Object.assign(Object.assign({}, prev), { [imageType]: true })));
        try {
            // FirebaseåŒ¿åãƒ­ã‚°ã‚¤ãƒ³ï¼ˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã®ã¿ï¼‰
            try {
                await signInAnonymously(window.auth);
                console.log('âœ… FirebaseåŒ¿åãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ');
            }
            catch (authError) {
                console.log('åŒ¿åãƒ­ã‚°ã‚¤ãƒ³ã‚¹ã‚­ãƒƒãƒ—ï¼ˆæ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®å¯èƒ½æ€§ï¼‰:', authError.code);
            }
            // Firebase Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
            const timestamp = Date.now();
            const fileName = `${window.currentStoreId}_${imageType}_${timestamp}_${file.name}`;
            const storageRef = ref(window.storage, `store-images/${fileName}`);
            await uploadBytes(storageRef, file);
            const imageUrl = await getDownloadURL(storageRef);
            // Firestoreã«ç”»åƒURLã‚’ä¿å­˜
            const imageField = {
                main: 'mainImageUrl',
                button: 'buttonImageUrl',
                welcome: 'welcomeImageUrl',
                header: 'headerImageUrl',
                background: 'backgroundImageUrl'
            }[imageType];
            await updateDoc(doc(window.db, 'stores', window.currentStoreId), {
                [imageField]: imageUrl
            });
            const imageNames = {
                main: 'çœ‹æ¿ç”»åƒ',
                button: 'ãƒœã‚¿ãƒ³ç”»åƒ',
                welcome: 'ãƒ˜ãƒƒãƒ€ä¸‹ç”»åƒ',
                header: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ãƒ˜ãƒƒãƒ€ç”»åƒ',
                background: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢èƒŒæ™¯ç”»åƒ'
            };
            showCustomAlertFunc(`${imageNames[imageType]}ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ`, 'âœ… å®Œäº†', 'âœ…');
            // åº—èˆ—æƒ…å ±ã‚’æ›´æ–°
            setCurrentStoreData(prev => (Object.assign(Object.assign({}, prev), { [imageField]: imageUrl })));
        }
        catch (error) {
            console.error('ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setImageUploading(prev => (Object.assign(Object.assign({}, prev), { [imageType]: false })));
        }
    };
    // æ™‚åˆ»ã‚’15åˆ†å˜ä½ã«ä¸¸ã‚ã‚‹é–¢æ•°
    const roundTimeToQuarter = (timeStr, isClockIn) => {
        if (!timeStr)
            return null;
        const [hours, minutes] = timeStr.split(':').map(Number);
        const totalMinutes = hours * 60 + minutes;
        // 15åˆ†å˜ä½ã«ä¸¸ã‚ã‚‹
        let roundedMinutes;
        if (isClockIn) {
            // å‡ºå‹¤ãƒ»ä¼‘æ†©å…¥: åˆ‡ã‚Šä¸Šã’ï¼ˆä¾‹: 09:05 â†’ 09:15ï¼‰
            roundedMinutes = Math.ceil(totalMinutes / 15) * 15;
        }
        else {
            // é€€å‹¤ãƒ»ä¼‘æ†©å‡º: åˆ‡ã‚Šæ¨ã¦ï¼ˆä¾‹: 17:07 â†’ 17:00ï¼‰
            roundedMinutes = Math.floor(totalMinutes / 15) * 15;
        }
        const roundedHours = Math.floor(roundedMinutes / 60);
        const roundedMins = roundedMinutes % 60;
        return `${String(roundedHours).padStart(2, '0')}:${String(roundedMins).padStart(2, '0')}`;
    };
    // Firestoreã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
    useEffect(() => {
        if (isAdminAuthenticated) {
            loadAllData();
        }
    }, [isAdminAuthenticated, currentMonth, currentYear]);
    // ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å…ƒ
    useEffect(() => {
        // CRITICAL: å¤ã„å€¤ã‚’å¼·åˆ¶å‰Šé™¤
        const storedStoreId = sessionStorage.getItem('kanriStoreId');
        if (storedStoreId === 'shimoarekasuka' || storedStoreId === 'shimoakatsuka') {
            console.warn('âš ï¸ ä¸‹èµ¤å¡šåº—ã®ID "' + storedStoreId + '" ã‚’æ¤œå‡º â†’ null ã«å¤‰æ›ï¼ˆæ—§ãƒ‘ã‚¹ä½¿ç”¨ï¼‰');
            sessionStorage.setItem('kanriStoreId', ''); // ç©ºæ–‡å­—åˆ—ã«å¤‰æ›
            window.currentStoreId = null;
            const storedStoreName = sessionStorage.getItem('kanriStoreName');
            window.currentStoreName = storedStoreName;
            setIsAdminAuthenticated(true);
            console.log('âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å…ƒ: storeId = null (ä¸‹èµ¤å¡šåº—), storeName =', storedStoreName);
            return;
        }
        const storedStoreName = sessionStorage.getItem('kanriStoreName');
        if (storedStoreName) {
            // storeIdãŒç©ºæ–‡å­—åˆ—ã¾ãŸã¯nullã®å ´åˆã¯nullï¼ˆä¸‹èµ¤å¡šåº—ï¼‰
            let actualStoreId = null;
            if (storedStoreId && storedStoreId !== '') {
                actualStoreId = storedStoreId;
            }
            window.currentStoreId = actualStoreId;
            window.currentStoreName = storedStoreName;
            setIsAdminAuthenticated(true);
            console.log('âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å…ƒ: storeId =', window.currentStoreId, ', storeName =', storedStoreName);
        }
    }, []);
    // ğŸ†• keisan-shousai-v6.htmlã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡
    useEffect(() => {
        const handleMessage = (event) => {
            if (event.data.type === 'residentTaxCalculated') {
                console.log('âœ… ä½æ°‘ç¨ãƒ‡ãƒ¼ã‚¿å—ä¿¡:', event.data);
                const salaryTypeKey = event.data.salaryType;
                const key = `${event.data.employeeId}_${salaryTypeKey}`;
                setCalculatedResidentTaxes(prev => {
                    const newTaxes = Object.assign(Object.assign({}, prev), { [key]: event.data.residentTax });
                    console.log('ğŸ’¾ æ›´æ–°å¾Œã®ä½æ°‘ç¨:', newTaxes);
                    return newTaxes;
                });
                const salaryTypeText = salaryTypeKey === 'hourly' ? 'æ™‚é–“çµ¦' : 'å›ºå®šçµ¦';
                showCustomAlertFunc(`${event.data.employeeName}ã•ã‚“ã®ä½æ°‘ç¨ã‚’è¨ˆç®—ã—ã¾ã—ãŸ\n\n` +
                    `è¨ˆç®—ã‚¿ã‚¤ãƒ—: ${salaryTypeText}\n` +
                    `æœˆé¡ä½æ°‘ç¨: Â¥${event.data.residentTax.toLocaleString()}\n\n` +
                    `çµ¦ä¸è¨ˆç®—ã«åæ˜ ã•ã‚Œã¾ã™ã€‚`, 'âœ… ä½æ°‘ç¨è¨ˆç®—å®Œäº†', 'âœ…');
            }
        };
        window.addEventListener('message', handleMessage);
        return () => window.removeEventListener('message', handleMessage);
    }, []);
    const loadAllData = async () => {
        setIsLoading(true);
        setError(null);
        try {
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            const { collection, getDocs } = window.firebaseModules;
            // âœ… æœ€å„ªå…ˆ: å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã®ã¿å…ˆã«èª­ã¿è¾¼ã¿
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ï¼ˆstoreId=nullï¼‰ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ä¸‹èµ¤å¡šåº—ï¼ˆæ—§ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™');
                // æ—§ãƒ‘ã‚¹ã‹ã‚‰å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const empRef = collection(window.db, 'kintai_employees');
                const empSnapshot = await getDocs(empRef);
                const empList = [];
                empSnapshot.forEach(doc => {
                    empList.push(Object.assign({ id: doc.id }, doc.data()));
                });
                empList.sort((a, b) => {
                    if (a.sortOrder !== undefined && b.sortOrder !== undefined) {
                        return a.sortOrder - b.sortOrder;
                    }
                    if (a.sortOrder !== undefined)
                        return -1;
                    if (b.sortOrder !== undefined)
                        return 1;
                    return (a.name || '').localeCompare(b.name || '');
                });
                setEmployees(empList);
                // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã¯å¾Œã§èª­ã¿è¾¼ã‚€ï¼ˆé…å»¶èª­ã¿è¾¼ã¿ï¼‰
                setTimeout(() => loadAttendanceData(), 100);
            }
            else {
                // æ–°ãƒ‘ã‚¹: åº—èˆ—åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                console.log('ğŸ“ åº—èˆ—åˆ¥ã®å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™: stores/' + window.currentStoreId);
                const empRef = collection(window.db, 'stores', window.currentStoreId, 'employees');
                const empSnapshot = await getDocs(empRef);
                const empList = [];
                empSnapshot.forEach(doc => {
                    empList.push(Object.assign({ id: doc.id }, doc.data()));
                });
                empList.sort((a, b) => {
                    if (a.sortOrder !== undefined && b.sortOrder !== undefined) {
                        return a.sortOrder - b.sortOrder;
                    }
                    if (a.sortOrder !== undefined)
                        return -1;
                    if (b.sortOrder !== undefined)
                        return 1;
                    return (a.name || '').localeCompare(b.name || '');
                });
                setEmployees(empList);
                // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã¯å¾Œã§èª­ã¿è¾¼ã‚€ï¼ˆé…å»¶èª­ã¿è¾¼ã¿ï¼‰
                setTimeout(() => loadAttendanceData(), 100);
            }
            // â±ï¸ åˆæœŸè¡¨ç¤ºå®Œäº†ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è§£é™¤ï¼‰
            setIsLoading(false);
            // ğŸ”„ ãã®ä»–ã®è¨­å®šãƒ‡ãƒ¼ã‚¿ã¯éåŒæœŸã§é…å»¶èª­ã¿è¾¼ã¿ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¾…ã¡æ™‚é–“ã‚’æ¸›ã‚‰ã™ï¼‰
            setTimeout(() => {
                loadReceiptSettings();
                loadMenuSettings();
                loadAlertSettings();
                loadStatusDisplaySettings(); // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’èª­ã¿è¾¼ã¿
                loadBusinessHoursSettings(); // å–¶æ¥­æ™‚é–“è¨­å®šã‚’èª­ã¿è¾¼ã¿
                loadClosedDaysSettings(); // ğŸ†• ä¼‘æ¥­æ—¥è¨­å®šã‚’èª­ã¿è¾¼ã¿
                loadTableSettings();
                loadMenuItems();
                loadGlobalMenuSettings();
                loadInventorySettings();
            }, 200);
        }
        catch (err) {
            console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', err);
            setError('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message);
            setIsLoading(false);
        }
    };
    // âœ… å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚’åˆ†é›¢
    const loadAttendanceData = async () => {
        try {
            const { collection, getDocs } = window.firebaseModules;
            // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID "{employeeId}_{YYYY-MM-DD}" ã‚’æ­£ã—ãåˆ†å‰²ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼
            // æ—¥ä»˜éƒ¨åˆ†ã¯å¿…ãš YYYY-MM-DD å½¢å¼ãªã®ã§ã€æ­£è¦è¡¨ç¾ã§æœ«å°¾ã‹ã‚‰æŠ½å‡ºã™ã‚‹
            const parseDocId = (docId, docData) => {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³: æœ«å°¾ãŒ YYYY-MM-DD å½¢å¼
                const dateMatch = docId.match(/^(.+?)_(\d{4}-\d{2}-\d{2})$/);
                if (dateMatch) {
                    return { employeeId: dateMatch[1], dateKey: dateMatch[2] };
                }
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—
                return { employeeId: docData.employeeId, dateKey: docData.date || docId };
            };
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                // æ—§ãƒ‘ã‚¹ã‹ã‚‰å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const attRef = collection(window.db, 'kintai_attendance');
                const attSnapshot = await getDocs(attRef);
                const attData = {};
                attSnapshot.forEach(doc => {
                    const docId = doc.id;
                    const docData = doc.data();
                    const { employeeId, dateKey } = parseDocId(docId, docData);
                    const dateMatch = dateKey.match(/^(\d{4})-(\d{2})-/);
                    if (dateMatch && employeeId) {
                        const year = parseInt(dateMatch[1]);
                        const month = parseInt(dateMatch[2]) - 1;
                        if (year === currentYear && month === currentMonth) {
                            if (!attData[employeeId]) {
                                attData[employeeId] = {};
                            }
                            attData[employeeId][dateKey] = docData;
                        }
                    }
                });
                setAttendanceData(attData);
            }
            else {
                const attRef = collection(window.db, 'stores', window.currentStoreId, 'attendance');
                const attSnapshot = await getDocs(attRef);
                const attData = {};
                attSnapshot.forEach(doc => {
                    const docId = doc.id;
                    const docData = doc.data();
                    const { employeeId, dateKey } = parseDocId(docId, docData);
                    if (!employeeId || !dateKey) return;
                    const dateMatch = dateKey.match(/^(\d{4})-(\d{2})-/);
                    if (dateMatch && employeeId) {
                        const year = parseInt(dateMatch[1]);
                        const month = parseInt(dateMatch[2]) - 1;
                        if (year === currentYear && month === currentMonth) {
                            if (!attData[employeeId]) {
                                attData[employeeId] = {};
                            }
                            attData[employeeId][dateKey] = docData;
                        }
                    }
                });
                setAttendanceData(attData);
            }
        }
        catch (err) {
            console.error('å‹¤æ€ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', err);
        }
    };
    const handleLogin = async (e) => {
        e.preventDefault();
        setIsLoading(true);
        try {
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            const { doc, getDoc, collection, query, where, getDocs } = window.firebaseModules;
            // ä¸‹èµ¤å¡šåº—ï¼ˆæ—§ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®ç‰¹åˆ¥å‡¦ç†
            if (storeNameInput === 'ç²‰ã‚‚ã‚“å±‹ å…«' && passwordInput === 'hachi888') {
                // sessionStorageã‚’ã‚¯ãƒªã‚¢
                sessionStorage.removeItem('kanriStoreId');
                sessionStorage.removeItem('kanriStoreName');
                window.currentStoreId = null; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ = null
                window.currentStoreName = 'ç²‰ã‚‚ã‚“å±‹ å…«';
                // ç©ºæ–‡å­—åˆ—ã§ä¿å­˜ï¼ˆnullã¯ä¿å­˜ã§ããªã„ãŸã‚ï¼‰
                sessionStorage.setItem('kanriStoreId', '');
                sessionStorage.setItem('kanriStoreName', 'ç²‰ã‚‚ã‚“å±‹ å…«');
                setIsAdminAuthenticated(true);
                setPasswordInput('');
                setIsLoading(false);
                console.log('âœ… ä¸‹èµ¤å¡šåº—ï¼ˆæ—§ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ - currentStoreId: null');
                console.log('   sessionStorage cleared and reset');
                return;
            }
            // åº—èˆ—åã§æ¤œç´¢
            const storesRef = collection(window.db, 'stores');
            const q = query(storesRef, where('storeName', '==', storeNameInput));
            const querySnapshot = await getDocs(q);
            if (querySnapshot.empty) {
                showCustomAlertFunc('åº—èˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
                return;
            }
            let authenticated = false;
            let storeData = null;
            let storeDocId = null;
            querySnapshot.forEach((doc) => {
                const data = doc.data();
                if (data.storePassword === passwordInput) {
                    if (!data.isActive) {
                        showCustomAlertFunc('ã“ã®åº—èˆ—ã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™', 'âš ï¸ è­¦å‘Š', 'âš ï¸');
                        return;
                    }
                    authenticated = true;
                    storeData = data;
                    storeDocId = doc.id;
                }
            });
            if (authenticated && storeData) {
                // ğŸ”§ ä¸‹èµ¤å¡šåº—ã®ç‰¹åˆ¥å‡¦ç†: IDãŒ shimoarekasuka ã¾ãŸã¯ shimoakatsuka ã®å ´åˆã¯ null ã«å¤‰æ›
                if (storeDocId === 'shimoarekasuka' || storeDocId === 'shimoakatsuka') {
                    console.log('ğŸ”§ ä¸‹èµ¤å¡šåº—ã®IDã‚’æ¤œå‡º: ' + storeDocId + ' â†’ null (æ—§ãƒ‘ã‚¹ä½¿ç”¨)');
                    window.currentStoreId = null;
                    sessionStorage.setItem('kanriStoreId', '');
                }
                else {
                    window.currentStoreId = storeDocId;
                    sessionStorage.setItem('kanriStoreId', storeDocId);
                }
                window.currentStoreName = storeData.storeName;
                sessionStorage.setItem('kanriStoreName', storeData.storeName);
                setIsAdminAuthenticated(true);
                setPasswordInput('');
            }
            else {
                showCustomAlertFunc('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“', 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
            }
        }
        catch (err) {
            console.error('ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setIsLoading(false);
        }
    };
    const getDaysInMonth = (month, year) => {
        return new Date(year, month + 1, 0).getDate();
    };
    const calculateWorkHours = (record) => {
        if (!record || !record.clockIn || !record.clockOut)
            return 0;
        const parseTime = (timeStr) => {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        };
        // 15åˆ†å˜ä½ã«ä¸¸ã‚ã‚‹
        const roundedClockIn = roundTimeToQuarter(record.clockIn, true);
        const roundedClockOut = roundTimeToQuarter(record.clockOut, false);
        const roundedBreakStart1 = roundTimeToQuarter(record.breakStart1, true);
        const roundedBreakEnd1 = roundTimeToQuarter(record.breakEnd1, false);
        const roundedBreakStart2 = roundTimeToQuarter(record.breakStart2, true);
        const roundedBreakEnd2 = roundTimeToQuarter(record.breakEnd2, false);
        const clockInMin = parseTime(roundedClockIn);
        const clockOutMin = parseTime(roundedClockOut);
        let workMin = clockOutMin - clockInMin;
        if (roundedBreakStart1 && roundedBreakEnd1) {
            workMin -= (parseTime(roundedBreakEnd1) - parseTime(roundedBreakStart1));
        }
        if (roundedBreakStart2 && roundedBreakEnd2) {
            workMin -= (parseTime(roundedBreakEnd2) - parseTime(roundedBreakStart2));
        }
        return Math.max(0, workMin / 60);
    };
    const calculateDailyPay = (employee, record) => {
        if (!record)
            return {
                base: 0,
                overtime: 0,
                holiday: 0,
                lateNight: 0,
                total: 0,
                overtimeHours: 0,
                lateNightHours: 0
            };
        const workHours = calculateWorkHours(record);
        if (workHours === 0)
            return {
                base: 0,
                overtime: 0,
                holiday: 0,
                lateNight: 0,
                total: 0,
                overtimeHours: 0,
                lateNightHours: 0
            };
        // æ—¥åˆ¥ã®æ™‚çµ¦ã‚’å„ªå…ˆã€ãªã‘ã‚Œã°å¾“æ¥­å“¡ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ™‚çµ¦ã‚’ä½¿ç”¨
        const hourlyRate = record.hourlyRate || (employee === null || employee === void 0 ? void 0 : employee.hourlyRate) || 0;
        let basePay = 0;
        let overtimePay = 0;
        let holidayPay = 0;
        let lateNightPay = 0;
        let overtimeHours = 0;
        let lateNightHours = 0;
        // æ·±å¤œåŠ´åƒæ™‚é–“ã‚’è¨ˆç®—ï¼ˆ22:00-ç¿Œ5:00ï¼‰
        const calculateLateNightHours = () => {
            if (!record.clockIn || !record.clockOut)
                return 0;
            const parseTime = (timeStr) => {
                const [h, m] = timeStr.split(':').map(Number);
                return h * 60 + m;
            };
            let totalLateNightMinutes = 0;
            const clockInMinutes = parseTime(record.clockIn);
            const clockOutMinutes = parseTime(record.clockOut);
            // 22:00 = 1320åˆ†, ç¿Œ5:00 = 1440 + 300 = 1740åˆ†ï¼ˆæ—¥ã‚’è·¨ãå ´åˆï¼‰
            const lateNightStart = 22 * 60; // 1320
            const lateNightEnd = 5 * 60; // 300
            // é€€å‹¤ãŒå‡ºå‹¤ã‚ˆã‚Šå‰ã®å ´åˆã€æ—¥ã‚’è·¨ã„ã§ã„ã‚‹
            if (clockOutMinutes < clockInMinutes) {
                // å‡ºå‹¤æ—¥ã®22:00ä»¥é™
                if (clockInMinutes < 24 * 60) {
                    const startMinutes = Math.max(clockInMinutes, lateNightStart);
                    totalLateNightMinutes += (24 * 60 - startMinutes);
                }
                // ç¿Œæ—¥ã®0:00-5:00
                const endMinutes = Math.min(clockOutMinutes, lateNightEnd);
                if (endMinutes > 0) {
                    totalLateNightMinutes += endMinutes;
                }
            }
            else {
                // åŒæ—¥å†…
                if (clockInMinutes >= lateNightStart) {
                    // 22:00ä»¥é™ã«å‡ºå‹¤
                    totalLateNightMinutes = clockOutMinutes - clockInMinutes;
                }
                else if (clockOutMinutes > lateNightStart) {
                    // 22:00ã‚’è·¨ã
                    totalLateNightMinutes = clockOutMinutes - lateNightStart;
                }
            }
            // ä¼‘æ†©æ™‚é–“ã‚’å¼•ã
            if (record.breakStart1 && record.breakEnd1) {
                const breakStart1 = parseTime(record.breakStart1);
                const breakEnd1 = parseTime(record.breakEnd1);
                // ä¼‘æ†©æ™‚é–“ãŒæ·±å¤œæ™‚é–“å¸¯ã¨é‡ãªã‚‹å ´åˆ
                if (breakStart1 >= lateNightStart || breakEnd1 <= lateNightEnd ||
                    (breakStart1 < lateNightEnd && breakEnd1 > lateNightStart)) {
                    const overlapStart = Math.max(breakStart1, lateNightStart);
                    const overlapEnd = Math.min(breakEnd1, 24 * 60);
                    if (overlapEnd > overlapStart) {
                        totalLateNightMinutes -= (overlapEnd - overlapStart);
                    }
                }
            }
            if (record.breakStart2 && record.breakEnd2) {
                const breakStart2 = parseTime(record.breakStart2);
                const breakEnd2 = parseTime(record.breakEnd2);
                if (breakStart2 >= lateNightStart || breakEnd2 <= lateNightEnd ||
                    (breakStart2 < lateNightEnd && breakEnd2 > lateNightStart)) {
                    const overlapStart = Math.max(breakStart2, lateNightStart);
                    const overlapEnd = Math.min(breakEnd2, 24 * 60);
                    if (overlapEnd > overlapStart) {
                        totalLateNightMinutes -= (overlapEnd - overlapStart);
                    }
                }
            }
            return Math.max(0, totalLateNightMinutes / 60);
        };
        lateNightHours = calculateLateNightHours();
        if (record.isHoliday) {
            // ä¼‘æ—¥å‡ºå‹¤ã®è¨ˆç®—
            const regularHolidayHours = workHours - lateNightHours; // ä¼‘æ—¥ã®é€šå¸¸æ™‚é–“ï¼ˆ5æ™‚ï½22æ™‚ï¼‰
            const holidayLateNightHours = lateNightHours; // ä¼‘æ—¥ã®æ·±å¤œæ™‚é–“ï¼ˆ22æ™‚ï½ç¿Œ5æ™‚ï¼‰
            // ä¼‘æ—¥é€šå¸¸æ™‚é–“ï¼š35%å‰²å¢—ï¼ˆ1.35å€ï¼‰
            if (regularHolidayHours > 0) {
                holidayPay = regularHolidayHours * hourlyRate * 1.35;
            }
            // ä¼‘æ—¥æ·±å¤œæ™‚é–“ï¼š35% + 25% = 60%å‰²å¢—ï¼ˆ1.60å€ï¼‰
            if (holidayLateNightHours > 0) {
                lateNightPay = holidayLateNightHours * hourlyRate * 1.60;
            }
        }
        else {
            // é€šå¸¸å‹¤å‹™
            if (workHours <= 8) {
                basePay = workHours * hourlyRate;
            }
            else {
                basePay = 8 * hourlyRate;
                overtimeHours = workHours - 8;
                overtimePay = overtimeHours * hourlyRate * 1.25; // åŸºæœ¬çµ¦ + 25%å‰²å¢—
            }
            // æ·±å¤œåŠ´åƒï¼š25%å‰²å¢—
            if (lateNightHours > 0) {
                lateNightPay = lateNightHours * hourlyRate * 0.25;
            }
        }
        const total = basePay + overtimePay + holidayPay + lateNightPay;
        return {
            base: basePay,
            overtime: overtimePay,
            holiday: holidayPay,
            lateNight: lateNightPay,
            total,
            overtimeHours,
            lateNightHours
        };
    };
    const calculateMonthlyTotals = (employeeId) => {
        var _a;
        const employee = employees.find(e => e.id === employeeId);
        if (!employee)
            return {
                hours: 0, basePay: 0, overtimePay: 0, holidayPay: 0, lateNightPay: 0, transport: 0,
                workDays: 0, salaryType: 'æ™‚é–“çµ¦', minimumWage: 1000,
                // æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹
                hourlyGrossPay: 0, hourlyAllowances: 0, hourlyTotalGross: 0,
                hourlyDeductions: {}, hourlyNetPay: 0,
                // å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹
                fixedSalary: 0, dailyFixedRate: 0, fixedGrossPay: 0,
                fixedAllowances: 0, fixedTotalGross: 0,
                fixedDeductions: {}, fixedNetPay: 0,
                // å·®é¡
                grossDifference: 0, netDifference: 0,
                displayGrossDifference: 0, displayNetDifference: 0
            };
        let totalHours = 0;
        let totalBasePay = 0;
        let totalOvertimePay = 0;
        let totalHolidayPay = 0;
        let totalLateNightPay = 0;
        let workDays = 0;
        const daysInMonth = getDaysInMonth(currentMonth, currentYear);
        const salaryType = employee.salaryType || 'æ™‚é–“çµ¦';
        const minimumWage = employee.minimumWage || 1000;
        // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ™‚é–“çµ¦è¨ˆç®—
        // å›ºå®šçµ¦ã®å ´åˆã¯æœ€ä½è³ƒé‡‘ã§è¨ˆç®—
        const calculationRate = (salaryType === 'å›ºå®šçµ¦' && employee.monthlySalary > 0) ? minimumWage : employee.hourlyRate;
        // ä¸€æ™‚çš„ã«æ™‚çµ¦ã‚’æœ€ä½è³ƒé‡‘ã«å¤‰æ›´ã—ã¦è¨ˆç®—
        const tempEmployee = Object.assign(Object.assign({}, employee), { hourlyRate: calculationRate });
        for (let day = 1; day <= daysInMonth; day++) {
            const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const record = (_a = attendanceData[employeeId]) === null || _a === void 0 ? void 0 : _a[dateKey];
            if (record && record.clockIn) {
                workDays++;
                totalHours += calculateWorkHours(record);
                const dailyPay = calculateDailyPay(tempEmployee, record);
                totalBasePay += dailyPay.base;
                totalOvertimePay += dailyPay.overtime;
                totalHolidayPay += dailyPay.holiday;
                totalLateNightPay += dailyPay.lateNight;
            }
        }
        const transport = (employee.transportAllowance || 0) * workDays;
        // å„ç¨®æ‰‹å½“
        const allowances = employee.allowances || {};
        // çµŒè²»ï¼ˆåå…¥ã ãŒæ‰€å¾—ã§ã¯ãªã„ï¼‰- è¡¨ç¤ºç”¨ã®ã¿
        const expenseAmount = (allowances.commuting || 0) + (allowances.expense || 0);
        // çµŒè²»ä»¥å¤–ã®æ‰‹å½“
        const totalAllowances = (allowances.family || 0) + (allowances.sales || 0) +
            (allowances.position || 0) + (allowances.housing || 0);
        // ========== æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹ã®è¨ˆç®—ï¼ˆçµŒè²»ã‚’é™¤å¤–ã—ã¦è¨ˆç®—ï¼‰ ==========
        const hourlyBasePay = totalBasePay + totalOvertimePay + totalHolidayPay + totalLateNightPay + transport;
        const hourlyGrossBeforeExpense = hourlyBasePay + totalAllowances; // çµŒè²»é™¤å¤–ã®ç·æ”¯çµ¦é¡
        window.currentSalaryCalculationType = 'hourly'; // ğŸ†• æ™‚é–“çµ¦è¨ˆç®—ã‚’æ˜ç¤º
        const hourlyDeductions = calculateDeductions(employee, hourlyGrossBeforeExpense, 0); // çµŒè²»0ã§è¨ˆç®—
        const hourlyNetPay = hourlyGrossBeforeExpense - hourlyDeductions.totalDeductions + expenseAmount; // çµŒè²»ã‚’åŠ ç®—
        const hourlyTotalGross = hourlyGrossBeforeExpense + expenseAmount; // æœ€å¾Œã«çµŒè²»ã‚’åŠ ç®—ï¼ˆè¡¨ç¤ºç”¨ï¼‰
        // ========== å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹ã®è¨ˆç®—ï¼ˆçµŒè²»ã‚’é™¤å¤–ã—ã¦è¨ˆç®—ï¼‰ ==========
        let fixedSalary = 0;
        let dailyFixedRate = 0;
        let fixedGrossPay = 0;
        let fixedTotalGross = 0;
        let fixedDeductions = {};
        let fixedNetPay = 0;
        let grossDifference = 0;
        let netDifference = 0;
        let displayGrossDifference = 0;
        let displayNetDifference = 0;
        if (salaryType === 'å›ºå®šçµ¦' && employee.monthlySalary > 0) {
            fixedSalary = employee.monthlySalary;
            dailyFixedRate = fixedSalary / daysInMonth;
            fixedGrossPay = fixedSalary; // å›ºå®šçµ¦ã¯æ—¥å‰²ã‚Šã—ãªã„
            const fixedGrossBeforeExpense = fixedGrossPay + totalAllowances; // çµŒè²»é™¤å¤–ã®ç·æ”¯çµ¦é¡
            window.currentSalaryCalculationType = 'fixed'; // ğŸ†• å›ºå®šçµ¦è¨ˆç®—ã‚’æ˜ç¤º
            fixedDeductions = calculateDeductions(employee, fixedGrossBeforeExpense, 0); // çµŒè²»0ã§è¨ˆç®—
            fixedNetPay = fixedGrossBeforeExpense - fixedDeductions.totalDeductions + expenseAmount; // çµŒè²»ã‚’åŠ ç®—
            fixedTotalGross = fixedGrossBeforeExpense + expenseAmount; // æœ€å¾Œã«çµŒè²»ã‚’åŠ ç®—ï¼ˆè¡¨ç¤ºç”¨ï¼‰
            // å·®é¡è¨ˆç®—ï¼ˆå†…éƒ¨è¨ˆç®—ã¯æ­£ç¢ºã«ï¼‰
            grossDifference = hourlyTotalGross - fixedTotalGross;
            netDifference = hourlyNetPay - fixedNetPay;
            // è¡¨ç¤ºç”¨å·®é¡ï¼ˆãƒã‚¤ãƒŠã‚¹ã®å ´åˆã¯0ï¼‰
            displayGrossDifference = Math.max(0, grossDifference);
            displayNetDifference = Math.max(0, netDifference);
        }
        return {
            hours: totalHours,
            basePay: totalBasePay,
            overtimePay: totalOvertimePay,
            holidayPay: totalHolidayPay,
            lateNightPay: totalLateNightPay,
            transport,
            workDays,
            salaryType,
            minimumWage,
            allowances: employee.allowances || {},
            totalAllowances,
            // æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹
            hourlyBasePay,
            hourlyTotalGross,
            hourlyDeductions,
            hourlyNetPay,
            // å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹
            fixedSalary,
            dailyFixedRate,
            fixedGrossPay,
            fixedTotalGross,
            fixedDeductions,
            fixedNetPay,
            // å·®é¡ï¼ˆå†…éƒ¨è¨ˆç®—ç”¨ï¼‰
            grossDifference,
            netDifference,
            // å·®é¡ï¼ˆè¡¨ç¤ºç”¨ï¼‰
            displayGrossDifference,
            displayNetDifference
        };
    };
    // ç´¯è¨ˆå·®ç•°ã‚’è¨ˆç®—ï¼ˆå›ºå®šçµ¦å¾“æ¥­å“¡ã®ã¿ã€æ§é™¤å‰ã®å·®é¡ï¼‰
    const calculateCumulativeDifference = async (employeeId) => {
        const employee = employees.find(e => e.id === employeeId);
        if (!employee || employee.salaryType !== 'å›ºå®šçµ¦' || !employee.monthlySalary) {
            return { totalGrossDifference: 0, totalNetDifference: 0, months: [] };
        }
        try {
            const { collection, getDocs } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            let attendanceRef;
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ç´¯è¨ˆå·®ç•°è¨ˆç®—: æ—§ãƒ‘ã‚¹ã§å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ (kintai_attendance)');
                attendanceRef = collection(window.db, 'kintai_attendance');
            }
            else {
                console.log('ğŸ“ ç´¯è¨ˆå·®ç•°è¨ˆç®—: æ–°ãƒ‘ã‚¹ã§å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿');
                attendanceRef = collection(window.db, 'stores', window.currentStoreId, 'attendance');
            }
            const snapshot = await getDocs(attendanceRef);
            // æœˆã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆ
            const monthlyData = {};
            snapshot.forEach(doc => {
                const docId = doc.id;
                const data = doc.data();
                // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID "{employeeId}_{YYYY-MM-DD}" ã‚’æ­£ã—ãåˆ†å‰²
                const dateMatch = docId.match(/^(.+?)_(\d{4}-\d{2}-\d{2})$/);
                let docEmployeeId, dateKey;
                if (dateMatch) {
                    docEmployeeId = dateMatch[1];
                    dateKey = dateMatch[2];
                } else {
                    docEmployeeId = data.employeeId;
                    dateKey = data.date || '';
                }
                if (docEmployeeId === employeeId && data.clockIn && dateKey) {
                    const yearMonth = dateKey.substring(0, 7); // YYYY-MM
                    if (!monthlyData[yearMonth]) {
                        monthlyData[yearMonth] = [];
                    }
                    monthlyData[yearMonth].push({
                        date: dateKey,
                        record: data
                    });
                }
            });
            // å„æœˆã®å·®é¡ã‚’è¨ˆç®—
            const months = [];
            let totalGrossDifference = 0;
            let totalNetDifference = 0;
            Object.keys(monthlyData).sort().forEach(yearMonth => {
                const [year, month] = yearMonth.split('-').map(Number);
                const daysInMonth = new Date(year, month, 0).getDate();
                let totalHours = 0;
                let totalBasePay = 0;
                let totalOvertimePay = 0;
                let totalHolidayPay = 0;
                let workDays = 0;
                // å›ºå®šçµ¦ã®å ´åˆã¯æœ€ä½è³ƒé‡‘ã§è¨ˆç®—
                const minimumWage = employee.minimumWage || 1000;
                const tempEmployee = Object.assign(Object.assign({}, employee), { hourlyRate: minimumWage });
                monthlyData[yearMonth].forEach(({ record }) => {
                    if (record.clockIn) {
                        workDays++;
                        const workHours = calculateWorkHours(record);
                        totalHours += workHours;
                        const dailyPay = calculateDailyPay(tempEmployee, record);
                        totalBasePay += dailyPay.base;
                        totalOvertimePay += dailyPay.overtime;
                        totalHolidayPay += dailyPay.holiday;
                    }
                });
                const transport = (employee.transportAllowance || 0) * workDays;
                const allowances = employee.allowances || {};
                const expenseAmount = allowances.expense || 0; // çµŒè²»
                const totalAllowancesWithoutExpense = (allowances.family || 0) + (allowances.sales || 0) +
                    (allowances.position || 0) + (allowances.commuting || 0) +
                    (allowances.housing || 0);
                // æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹ï¼ˆçµŒè²»é™¤å¤–ã§æ§é™¤è¨ˆç®—ï¼‰
                const hourlyBasePay = totalBasePay + totalOvertimePay + totalHolidayPay + transport;
                const hourlyGrossBeforeExpense = hourlyBasePay + totalAllowancesWithoutExpense;
                const hourlyDeductions = calculateDeductions(employee, hourlyGrossBeforeExpense);
                const hourlyNetPay = hourlyGrossBeforeExpense - hourlyDeductions.totalDeductions + expenseAmount; // çµŒè²»ã‚’åŠ ç®—
                const hourlyTotalGross = hourlyGrossBeforeExpense + expenseAmount;
                // å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹ï¼ˆçµ¦ä¸å¤‰æ›´å±¥æ­´ã‚’è€ƒæ…®ã—ã¦å½“è©²æœˆã®çµ¦ä¸ãƒ»éƒ½é“åºœçœŒã‚’æ±ºå®šï¼‰
                const salaryHistory = employee.salaryHistory || [];
                let applicableSalary = employee.monthlySalary;
                let applicablePrefecture = employee.prefecture || 'æ±äº¬';
                if (salaryHistory.length > 0) {
                    // fromYearMonthé™é †ã§ã‚½ãƒ¼ãƒˆã—ã€yearMonthä»¥å‰ã§æœ€æ–°ã®ã‚¨ãƒ³ãƒˆãƒªã‚’å–å¾—
                    const sorted = [...salaryHistory].sort((a, b) => b.fromYearMonth.localeCompare(a.fromYearMonth));
                    const entry = sorted.find(e => e.fromYearMonth <= yearMonth);
                    if (entry) {
                        applicableSalary = entry.monthlySalary;
                        applicablePrefecture = entry.prefecture;
                    }
                    else {
                        // å…¨ã‚¨ãƒ³ãƒˆãƒªã‚ˆã‚Šå‰ã®æœˆã¯æœ€å¤ã‚¨ãƒ³ãƒˆãƒªã‚’ä½¿ç”¨
                        const oldest = [...salaryHistory].sort((a, b) => a.fromYearMonth.localeCompare(b.fromYearMonth))[0];
                        applicableSalary = oldest.monthlySalary;
                        applicablePrefecture = oldest.prefecture;
                    }
                }
                const employeeForMonth = Object.assign(Object.assign({}, employee), { monthlySalary: applicableSalary, prefecture: applicablePrefecture });
                const fixedGrossPay = applicableSalary;
                const fixedGrossBeforeExpense = fixedGrossPay + totalAllowancesWithoutExpense;
                const fixedDeductions = calculateDeductions(employeeForMonth, fixedGrossBeforeExpense);
                const fixedNetPay = fixedGrossBeforeExpense - fixedDeductions.totalDeductions + expenseAmount; // çµŒè²»ã‚’åŠ ç®—
                const fixedTotalGross = fixedGrossBeforeExpense + expenseAmount;
                // å·®é¡ï¼ˆæ§é™¤å‰ï¼‰
                const grossDifference = hourlyTotalGross - fixedTotalGross;
                // å·®é¡ï¼ˆæ§é™¤å¾Œï¼‰
                const netDifference = hourlyNetPay - fixedNetPay;
                months.push({
                    yearMonth,
                    year,
                    month,
                    workDays,
                    hourlyTotalGross,
                    fixedTotalGross,
                    grossDifference,
                    hourlyNetPay,
                    fixedNetPay,
                    netDifference
                });
                totalGrossDifference += grossDifference;
                totalNetDifference += netDifference;
            });
            // è¡¨ç¤ºç”¨ç´¯è¨ˆå·®é¡ï¼ˆãƒã‚¤ãƒŠã‚¹ã®å ´åˆã¯0ï¼‰
            const displayTotalGrossDifference = Math.max(0, totalGrossDifference);
            const displayTotalNetDifference = Math.max(0, totalNetDifference);
            return {
                totalGrossDifference,
                totalNetDifference,
                displayTotalGrossDifference,
                displayTotalNetDifference,
                months
            };
        }
        catch (err) {
            console.error('ç´¯è¨ˆå·®ç•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:', err);
            return { totalGrossDifference: 0, totalNetDifference: 0, displayTotalGrossDifference: 0, displayTotalNetDifference: 0, months: [] };
        }
    };
    // ç´¯è¨ˆå·®é¡è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const CumulativeDifferenceDisplay = ({ employeeId }) => {
        const [cumulativeData, setCumulativeData] = useState(null);
        const [loading, setLoading] = useState(true);
        useEffect(() => {
            const fetchCumulative = async () => {
                setLoading(true);
                const data = await calculateCumulativeDifference(employeeId);
                setCumulativeData(data);
                setLoading(false);
            };
            if (employeeId) {
                fetchCumulative();
            }
        }, [employeeId]);
        if (loading) {
            return React.createElement("div", { className: "text-sm text-gray-500" }, "\u7D2F\u8A08\u5DEE\u984D\u3092\u8A08\u7B97\u4E2D...");
        }
        if (!cumulativeData) {
            return React.createElement("div", { className: "text-sm text-red-500" }, "\u7D2F\u8A08\u5DEE\u984D\u306E\u8A08\u7B97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");
        }
        if (cumulativeData.months.length === 0) {
            return React.createElement("div", { className: "text-sm text-gray-500" }, "\u52E4\u6020\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u305B\u3093");
        }
        if (cumulativeData.months.length === 1) {
            return React.createElement("div", { className: "text-sm text-gray-500" },
                "\u7D2F\u8A08\u5DEE\u984D\u306F2\u30F6\u6708\u4EE5\u4E0A\u306E\u30C7\u30FC\u30BF\u304C\u5FC5\u8981\u3067\u3059\uFF08\u73FE\u5728: ",
                cumulativeData.months.length,
                "\u30F6\u6708\uFF09");
        }
        return (React.createElement("div", { className: "mb-4" },
            React.createElement("h4", { className: "bg-purple-500 text-white p-2 font-bold" },
                "\u3010\u7D2F\u8A08\u5DEE\u984D\uFF08\u5168",
                cumulativeData.months.length,
                "\u30F6\u6708\uFF09\u3011"),
            React.createElement("table", { className: "w-full border-collapse border" },
                React.createElement("tbody", null,
                    React.createElement("tr", { className: "bg-purple-50" },
                        React.createElement("td", { className: "border p-2 font-bold" }, "\u63A7\u9664\u524D\u7D2F\u8A08\u5DEE\u984D"),
                        React.createElement("td", { className: "border p-2 text-right font-bold text-purple-600 text-lg" },
                            "\u00A5",
                            Math.round(cumulativeData.displayTotalGrossDifference).toLocaleString())),
                    React.createElement("tr", { className: "bg-purple-50" },
                        React.createElement("td", { className: "border p-2 font-bold" }, "\u63A7\u9664\u5F8C\u7D2F\u8A08\u5DEE\u984D"),
                        React.createElement("td", { className: "border p-2 text-right font-bold text-purple-600 text-lg" },
                            "\u00A5",
                            Math.round(cumulativeData.displayTotalNetDifference).toLocaleString())),
                    React.createElement("tr", { className: "bg-blue-50" },
                        React.createElement("td", { className: "border p-2 font-bold" }, "\u7D2F\u8A08\u7D0D\u7A0E\u984D\uFF08\u5DEE\u984D\u5206\uFF09"),
                        React.createElement("td", { className: "border p-2 text-right font-bold text-blue-600 text-lg" },
                            "\u00A5",
                            Math.round(cumulativeData.displayTotalGrossDifference - cumulativeData.displayTotalNetDifference).toLocaleString())))),
            React.createElement("div", { className: "text-xs text-gray-600 mt-1" },
                "\u203B\u5168",
                cumulativeData.months.length,
                "\u30F6\u6708\u306E\u7D2F\u8A08\u3067\u3059\u3002\u30D7\u30E9\u30B9\u306E\u5834\u5408\u3001\u4F1A\u793E\u306B\u8ACB\u6C42\u53EF\u80FD\u306A\u91D1\u984D\u3067\u3059\u3002")));
    };
    // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜
    const saveReceiptSettings = async () => {
        try {
            console.log('========================================');
            console.log('ğŸ“ ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šä¿å­˜é–‹å§‹');
            console.log('  currentStoreId:', window.currentStoreId);
            console.log('  receiptSettings:', receiptSettings);
            console.log('========================================');
            // Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æº–å‚™ã‚’å¾…ã¤
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('âœ… Firebaseæº–å‚™å®Œäº†');
            const { setDoc, Timestamp } = window.firebaseModules;
            const settingsData = Object.assign(Object.assign({}, receiptSettings), { updatedAt: Timestamp.now() });
            // ğŸ”§ ä¿®æ­£: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯å¸¸ã«'default'ã‚’ä½¿ç”¨
            const docId = 'default';
            const receiptSettingsRef = window.getStoreDoc('receipt_settings', docId);
            console.log('ä¿å­˜ã™ã‚‹ãƒ‡ãƒ¼ã‚¿:', settingsData);
            console.log('ğŸ“ ä¿å­˜å…ˆ: ' + (window.currentStoreId ? 'stores/' + window.currentStoreId + '/receipt_settings/' + docId : 'receipt_settings/shimoakatsuka'));
            await setDoc(receiptSettingsRef, settingsData);
            console.log('========================================');
            console.log('âœ… ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            console.log('========================================');
            showCustomAlertFunc('âœ… ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.log('========================================');
            console.error('âŒ ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            console.error('  ã‚¨ãƒ©ãƒ¼è©³ç´°:', error.message);
            console.error('  ã‚¹ã‚¿ãƒƒã‚¯:', error.stack);
            console.log('========================================');
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’èª­ã¿è¾¼ã¿
    const loadReceiptSettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯å¸¸ã«'default'ã‚’ä½¿ç”¨
            const docId = 'default';
            const receiptSettingsRef = window.getStoreDoc('receipt_settings', docId);
            console.log('ğŸ” ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šèª­ã¿è¾¼ã¿: ' + (window.currentStoreId ? 'stores/' + window.currentStoreId + '/receipt_settings/' + docId : 'receipt_settings/shimoakatsuka'));
            const receiptSettingsDoc = await getDoc(receiptSettingsRef);
            if (receiptSettingsDoc.exists()) {
                setReceiptSettings(receiptSettingsDoc.data());
                console.log('âœ… ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
                console.log('âš ï¸ ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨');
                const defaultSettings = {
                    storeName: 'ç²‰ã‚‚ã‚“å±‹ å…«',
                    branchName: 'ä¸‹èµ¤å¡šåº—',
                    postalCode: '175-0092',
                    address: 'æ±äº¬éƒ½æ¿æ©‹åŒºèµ¤å¡š2-2-4',
                    phone: '03-6904-2888',
                    message: 'ã”æ¥åº—ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ\nã¾ãŸã®ãŠè¶Šã—ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™',
                    stampImage: ''
                };
                setReceiptSettings(defaultSettings);
            }
        }
        catch (error) {
            console.error('âŒ ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
    const resetReceiptSettings = async () => {
        const confirmed = await showCustomConfirmFunc('ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'è¨­å®šãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const defaultSettings = {
                storeName: 'ç²‰ã‚‚ã‚“å±‹ å…«',
                branchName: 'ä¸‹èµ¤å¡šåº—',
                postalCode: '175-0092',
                address: 'æ±äº¬éƒ½æ¿æ©‹åŒºèµ¤å¡š2-2-4',
                phone: '03-6904-2888',
                message: 'ã”æ¥åº—ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ\nã¾ãŸã®ãŠè¶Šã—ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™',
                stampImage: ''
            };
            setReceiptSettings(defaultSettings);
            const { setDoc, Timestamp } = window.firebaseModules;
            const docId = 'default';
            const receiptSettingsRef = window.getStoreDoc('receipt_settings', docId);
            await setDoc(receiptSettingsRef, Object.assign(Object.assign({}, defaultSettings), { updatedAt: Timestamp.now() }));
            showCustomAlertFunc('ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜
    const saveAlertSettings = async () => {
        try {
            // Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æº–å‚™ã‚’å¾…ã¤
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('ğŸ’¾ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šä¿å­˜é–‹å§‹');
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const alertSettingsRef = window.getStoreDoc('alert_settings', docId);
            await setDoc(alertSettingsRef, alertSettings);
            console.log('âœ… ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            showCustomAlertFunc('âœ… ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.error('âŒ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’èª­ã¿è¾¼ã¿
    const loadAlertSettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const docId = 'default';
            const alertSettingsRef = window.getStoreDoc('alert_settings', docId);
            console.log('ğŸ” ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šèª­ã¿è¾¼ã¿');
            const alertSettingsDoc = await getDoc(alertSettingsRef);
            if (alertSettingsDoc.exists()) {
                setAlertSettings(alertSettingsDoc.data());
                console.log('âœ… ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                console.log('âš ï¸ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨');
                const defaultSettings = {
                    completeMessage: 'å•†å“ãŒå‡ºæ¥ä¸ŠãŒã‚Šã¾ã—ãŸï¼\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç”»é¢ã®æ³¨æ–‡ç•ªå·ã‚’åº—å“¡ã«ãŠè¦‹ã›ãã ã•ã„',
                    cancelMessage: 'æ³¨æ–‡ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç•ªå·ã‚’ãŠå‘¼ã³ã—ã¾ã—ãŸãŒã”ä¸åœ¨ã§ã—ãŸã®ã§\næ³¨æ–‡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã›ã¦é ‚ãã¾ã—ãŸ'
                };
                setAlertSettings(defaultSettings);
            }
        }
        catch (error) {
            console.error('âŒ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’èª­ã¿è¾¼ã‚€
    const loadStatusDisplaySettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const docId = 'default';
            const statusDisplayRef = window.getStoreDoc('status_display_settings', docId);
            console.log('ğŸ” ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šèª­ã¿è¾¼ã¿');
            const statusDisplayDoc = await getDoc(statusDisplayRef);
            if (statusDisplayDoc.exists()) {
                setStatusDisplaySettings(statusDisplayDoc.data());
                console.log('âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                console.log('âš ï¸ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨');
            }
        }
        catch (error) {
            console.error('âŒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ä¿å­˜
    const saveStatusDisplaySettings = async () => {
        try {
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('ğŸ’¾ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šä¿å­˜é–‹å§‹');
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const statusDisplayRef = window.getStoreDoc('status_display_settings', docId);
            await setDoc(statusDisplayRef, statusDisplaySettings);
            console.log('âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            showCustomAlertFunc('âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.error('âŒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
    const resetStatusDisplaySettings = async () => {
        const confirmed = await showCustomConfirmFunc('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'è¨­å®šãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const defaultSettings = {
                preparing: '',
                completed: '',
                ready: '',
                cancelled: ''
            };
            setStatusDisplaySettings(defaultSettings);
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const statusDisplayRef = window.getStoreDoc('status_display_settings', docId);
            await setDoc(statusDisplayRef, defaultSettings);
            showCustomAlertFunc('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
    const resetAlertSettings = async () => {
        const confirmed = await showCustomConfirmFunc('ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'è¨­å®šãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const defaultSettings = {
                completeMessage: 'å•†å“ãŒå‡ºæ¥ä¸ŠãŒã‚Šã¾ã—ãŸï¼\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç”»é¢ã®æ³¨æ–‡ç•ªå·ã‚’åº—å“¡ã«ãŠè¦‹ã›ãã ã•ã„',
                cancelMessage: 'æ³¨æ–‡ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ\n\næ³¨æ–‡ç•ªå· #{orderNumber}\n\nç•ªå·ã‚’ãŠå‘¼ã³ã—ã¾ã—ãŸãŒã”ä¸åœ¨ã§ã—ãŸã®ã§\næ³¨æ–‡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã›ã¦é ‚ãã¾ã—ãŸ'
            };
            setAlertSettings(defaultSettings);
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const alertSettingsRef = window.getStoreDoc('alert_settings', docId);
            await setDoc(alertSettingsRef, defaultSettings);
            showCustomAlertFunc('ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // å–¶æ¥­æ™‚é–“è¨­å®šã‚’ä¿å­˜
    const saveBusinessHoursSettings = async () => {
        try {
            // Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æº–å‚™ã‚’å¾…ã¤
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('ğŸ’¾ å–¶æ¥­æ™‚é–“è¨­å®šä¿å­˜é–‹å§‹');
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const businessHoursRef = window.getStoreDoc('business_hours_settings', docId);
            await setDoc(businessHoursRef, businessHoursSettings);
            console.log('âœ… å–¶æ¥­æ™‚é–“è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            showCustomAlertFunc('âœ… å–¶æ¥­æ™‚é–“è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.error('âŒ å–¶æ¥­æ™‚é–“è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // å–¶æ¥­æ™‚é–“è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
    const resetBusinessHoursSettings = async () => {
        const confirmed = await showCustomConfirmFunc('å–¶æ¥­æ™‚é–“è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'è¨­å®šãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const defaultSettings = {
                enabled: false,
                openTime: '09:00',
                closeTime: '22:00',
                closedMessage: 'å–¶æ¥­æ™‚é–“å¤–ã§ã™\n\nå–¶æ¥­æ™‚é–“: {openTime} - {closeTime}\n\nå–¶æ¥­æ™‚é–“å†…ã«ã”åˆ©ç”¨ãã ã•ã„'
            };
            setBusinessHoursSettings(defaultSettings);
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const businessHoursRef = window.getStoreDoc('business_hours_settings', docId);
            await setDoc(businessHoursRef, defaultSettings);
            showCustomAlertFunc('å–¶æ¥­æ™‚é–“è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // å–¶æ¥­æ™‚é–“è¨­å®šã‚’èª­ã¿è¾¼ã¿
    const loadBusinessHoursSettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const docId = 'default';
            const businessHoursRef = window.getStoreDoc('business_hours_settings', docId);
            console.log('ğŸ” å–¶æ¥­æ™‚é–“è¨­å®šèª­ã¿è¾¼ã¿');
            const businessHoursDoc = await getDoc(businessHoursRef);
            if (businessHoursDoc.exists()) {
                setBusinessHoursSettings(businessHoursDoc.data());
                console.log('âœ… å–¶æ¥­æ™‚é–“è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                console.log('âš ï¸ å–¶æ¥­æ™‚é–“è¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨');
                const defaultSettings = {
                    enabled: false,
                    openTime: '09:00',
                    closeTime: '22:00',
                    closedMessage: 'å–¶æ¥­æ™‚é–“å¤–ã§ã™\n\nå–¶æ¥­æ™‚é–“: {openTime} - {closeTime}\n\nå–¶æ¥­æ™‚é–“å†…ã«ã”åˆ©ç”¨ãã ã•ã„'
                };
                setBusinessHoursSettings(defaultSettings);
            }
        }
        catch (error) {
            console.error('âŒ å–¶æ¥­æ™‚é–“è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• ä¼‘æ¥­æ—¥è¨­å®šã‚’ä¿å­˜
    const saveClosedDaysSettings = async () => {
        try {
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('ğŸ’¾ ä¼‘æ¥­æ—¥è¨­å®šä¿å­˜é–‹å§‹');
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const closedDaysRef = window.getStoreDoc('closed_days_settings', docId);
            await setDoc(closedDaysRef, closedDaysSettings);
            console.log('âœ… ä¼‘æ¥­æ—¥è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            showCustomAlertFunc('âœ… ä¼‘æ¥­æ—¥è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.error('âŒ ä¼‘æ¥­æ—¥è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ä¼‘æ¥­æ—¥è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
    const resetClosedDaysSettings = async () => {
        const confirmed = await showCustomConfirmFunc('ä¼‘æ¥­æ—¥è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'è¨­å®šãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const defaultSettings = {
                weeklyClosedDays: [],
                specificClosedDates: [],
                closedMessage: 'æœ¬æ—¥ã¯ä¼‘æ¥­æ—¥ã§ã™'
            };
            setClosedDaysSettings(defaultSettings);
            const { setDoc } = window.firebaseModules;
            const docId = 'default';
            const closedDaysRef = window.getStoreDoc('closed_days_settings', docId);
            await setDoc(closedDaysRef, defaultSettings);
            showCustomAlertFunc('ä¼‘æ¥­æ—¥è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ğŸ†• ä¼‘æ¥­æ—¥è¨­å®šã‚’èª­ã¿è¾¼ã¿
    const loadClosedDaysSettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const docId = 'default';
            const closedDaysRef = window.getStoreDoc('closed_days_settings', docId);
            console.log('ğŸ” ä¼‘æ¥­æ—¥è¨­å®šèª­ã¿è¾¼ã¿');
            const closedDaysDoc = await getDoc(closedDaysRef);
            if (closedDaysDoc.exists()) {
                setClosedDaysSettings(closedDaysDoc.data());
                console.log('âœ… ä¼‘æ¥­æ—¥è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                console.log('âš ï¸ ä¼‘æ¥­æ—¥è¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨');
                const defaultSettings = {
                    weeklyClosedDays: [],
                    specificClosedDates: [],
                    closedMessage: 'æœ¬æ—¥ã¯ä¼‘æ¥­æ—¥ã§ã™'
                };
                setClosedDaysSettings(defaultSettings);
            }
        }
        catch (error) {
            console.error('âŒ ä¼‘æ¥­æ—¥è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• å®šä¼‘æ—¥ã®ãƒˆã‚°ãƒ«
    const toggleWeeklyClosedDay = (dayIndex) => {
        const newWeeklyClosedDays = [...closedDaysSettings.weeklyClosedDays];
        const index = newWeeklyClosedDays.indexOf(dayIndex);
        if (index > -1) {
            newWeeklyClosedDays.splice(index, 1);
        }
        else {
            newWeeklyClosedDays.push(dayIndex);
        }
        setClosedDaysSettings(Object.assign(Object.assign({}, closedDaysSettings), { weeklyClosedDays: newWeeklyClosedDays }));
    };
    // ğŸ†• æŒ‡å®šä¼‘æ¥­æ—¥ã‚’è¿½åŠ 
    const addSpecificClosedDate = (date) => {
        if (date && !closedDaysSettings.specificClosedDates.includes(date)) {
            setClosedDaysSettings(Object.assign(Object.assign({}, closedDaysSettings), { specificClosedDates: [...closedDaysSettings.specificClosedDates, date].sort() }));
        }
    };
    // ğŸ†• æŒ‡å®šä¼‘æ¥­æ—¥ã‚’å‰Šé™¤
    const removeSpecificClosedDate = (date) => {
        setClosedDaysSettings(Object.assign(Object.assign({}, closedDaysSettings), { specificClosedDates: closedDaysSettings.specificClosedDates.filter(d => d !== date) }));
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§èª­ã¿è¾¼ã¿
    const loadTables = async () => {
        try {
            const tablesSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('tables'));
            const tables = [];
            tablesSnapshot.forEach(doc => {
                const data = doc.data();
                tables.push({
                    id: doc.id,
                    name: data.name || doc.id
                });
            });
            // ã‚½ãƒ¼ãƒˆï¼ˆåå‰é †ï¼‰
            tables.sort((a, b) => {
                // æ•°å­—ã®å ´åˆã¯æ•°å€¤ã¨ã—ã¦ã‚½ãƒ¼ãƒˆ
                const aNum = parseInt(a.name);
                const bNum = parseInt(b.name);
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return aNum - bNum;
                }
                return a.name.localeCompare(b.name);
            });
            setAvailableTables(tables);
            console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', tables.length, 'ä»¶');
        }
        catch (e) {
            console.error('âŒ ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        }
    };
    // ğŸ†• åœ¨åº«è¨­å®šèª­ã¿è¾¼ã¿
    const loadInventorySettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            console.log('ğŸ” åœ¨åº«è¨­å®šèª­ã¿è¾¼ã¿');
            const inventoryDoc = await getDoc(inventoryRef);
            if (inventoryDoc.exists()) {
                setInventorySettings(inventoryDoc.data().items || {});
                console.log('âœ… åœ¨åº«è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
            else {
                console.log('âš ï¸ åœ¨åº«è¨­å®šãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ç©ºã®è¨­å®šã‚’ä½¿ç”¨');
                setInventorySettings({});
            }
        }
        catch (error) {
            console.error('âŒ åœ¨åº«è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• åœ¨åº«è¨­å®šä¿å­˜
    const saveInventorySettings = async () => {
        console.log('ğŸ”µ saveInventorySettingsé–¢æ•°ãŒå‘¼ã°ã‚Œã¾ã—ãŸ');
        console.log('ğŸ“¦ ä¿å­˜ã™ã‚‹åœ¨åº«è¨­å®š:', inventorySettings);
        try {
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            console.log('ğŸ“ inventoryRef:', inventoryRef);
            await setDoc(inventoryRef, {
                items: inventorySettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc('åœ¨åº«è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
            console.log('âœ… åœ¨åº«è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }
        catch (error) {
            console.error('âŒ åœ¨åº«è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // åœ¨åº«è¨­å®šã‚’å…¨ã¦æœªè¨­å®šï¼ˆæº€ã‚¿ãƒ³ï¼‰ã«ã™ã‚‹
    const resetInventorySettings = async () => {
        const confirmed = await showCustomConfirmFunc('å…¨ã¦ã®åœ¨åº«ã‚’æœªè¨­å®šï¼ˆæº€ã‚¿ãƒ³ï¼‰ã«ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'åœ¨åº«ãƒªã‚»ãƒƒãƒˆ', 'ãƒªã‚»ãƒƒãƒˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            // å…¨ã¦ã®å•†å“ã®åœ¨åº«ã‚’nullã«è¨­å®šï¼ˆåœ¨åº«ç®¡ç†ãªã—ï¼æº€ã‚¿ãƒ³ï¼‰
            const resetSettings = {};
            Object.keys(inventorySettings).forEach(itemId => {
                resetSettings[itemId] = {
                    stock: null,
                    alertThreshold: null
                };
            });
            setInventorySettings(resetSettings);
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            await setDoc(inventoryRef, {
                items: resetSettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc('å…¨ã¦ã®åœ¨åº«ã‚’æœªè¨­å®šï¼ˆæº€ã‚¿ãƒ³ï¼‰ã«ã—ã¾ã—ãŸ', 'ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        catch (error) {
            console.error('âŒ ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ğŸ†• åœ¨åº«è¨­å®šæ›´æ–°
    const updateInventorySetting = (itemId, field, value) => {
        setInventorySettings(prev => (Object.assign(Object.assign({}, prev), { [itemId]: Object.assign(Object.assign({}, prev[itemId]), { [field]: value }) })));
    };
    // ğŸ†• ä¸€æ‹¬åœ¨åº«0è¨­å®šï¼ˆè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ†ã‚´ãƒªã®ã¿ï¼‰
    const setAllStockToZero = async () => {
        const confirmed = await showCustomConfirmFunc('è¡¨ç¤ºä¸­ã®å…¨ã¦ã®å•†å“ã®åœ¨åº«ã‚’0ï¼ˆå“åˆ‡ã‚Œï¼‰ã«è¨­å®šã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'ä¸€æ‹¬åœ¨åº«0è¨­å®š', 'è¨­å®šã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { getDocs } = window.firebaseModules;
            // ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å•†å“ã‚’å–å¾—
            const menuSnapshot = await getDocs(window.getStoreCollection('menus'));
            const itemsToUpdate = [];
            menuSnapshot.forEach(doc => {
                const data = doc.data();
                const itemId = data.id || doc.id;
                // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨
                if (selectedInventoryCategory !== 'å…¨ã¦' && data.category !== selectedInventoryCategory) {
                    return;
                }
                // æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’é©ç”¨
                if (inventorySearchQuery) {
                    const query = inventorySearchQuery.toLowerCase();
                    if (!data.name.toLowerCase().includes(query)) {
                        return;
                    }
                }
                // åœ¨åº«çŠ¶æ…‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨
                const currentInventory = inventorySettings[itemId] || {};
                const currentStock = currentInventory.stock;
                const alertThreshold = currentInventory.alertThreshold;
                if (selectedInventoryStatus !== 'å…¨ã¦') {
                    if (selectedInventoryStatus === 'å“åˆ‡ã‚Œ' && currentStock !== 0)
                        return;
                    if (selectedInventoryStatus === 'åœ¨åº«å°‘' && (currentStock === 0 || currentStock === null || (alertThreshold !== null && currentStock > alertThreshold)))
                        return;
                    if (selectedInventoryStatus === 'åœ¨åº«å……åˆ†' && (currentStock === 0 || currentStock === null || (alertThreshold !== null && currentStock <= alertThreshold)))
                        return;
                    if (selectedInventoryStatus === 'ç„¡é™' && currentStock !== null)
                        return;
                }
                itemsToUpdate.push(itemId);
            });
            if (itemsToUpdate.length === 0) {
                showCustomAlertFunc('å¯¾è±¡å•†å“ãŒã‚ã‚Šã¾ã›ã‚“', 'è­¦å‘Š', 'âš ï¸');
                return;
            }
            // åœ¨åº«ã‚’0ã«è¨­å®š
            const newSettings = Object.assign({}, inventorySettings);
            itemsToUpdate.forEach(itemId => {
                newSettings[itemId] = Object.assign(Object.assign({}, newSettings[itemId]), { stock: 0 });
            });
            setInventorySettings(newSettings);
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            await setDoc(inventoryRef, {
                items: newSettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc(`${itemsToUpdate.length}ä»¶ã®å•†å“ã‚’åœ¨åº«0ï¼ˆå“åˆ‡ã‚Œï¼‰ã«è¨­å®šã—ã¾ã—ãŸ`, 'ä¸€æ‹¬è¨­å®šå®Œäº†', 'âœ…');
            console.log('âœ… ä¸€æ‹¬åœ¨åº«0è¨­å®šå®Œäº†:', itemsToUpdate.length, 'ä»¶');
        }
        catch (error) {
            console.error('âŒ ä¸€æ‹¬åœ¨åº«0è¨­å®šã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ä¸€æ‹¬è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ä¸€æ‹¬åœ¨åº«0è§£é™¤ï¼ˆåœ¨åº«nullã«æˆ»ã™ã€è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ†ã‚´ãƒªã®ã¿ï¼‰
    const clearAllStockZero = async () => {
        const confirmed = await showCustomConfirmFunc('è¡¨ç¤ºä¸­ã®åœ¨åº«0ã®å•†å“ã‚’å…¨ã¦æœªè¨­å®šï¼ˆç„¡é™ï¼‰ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'ä¸€æ‹¬åœ¨åº«0è§£é™¤', 'è§£é™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { getDocs } = window.firebaseModules;
            // ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å•†å“ã‚’å–å¾—
            const menuSnapshot = await getDocs(window.getStoreCollection('menus'));
            const itemsToUpdate = [];
            menuSnapshot.forEach(doc => {
                const data = doc.data();
                const itemId = data.id || doc.id;
                // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨
                if (selectedInventoryCategory !== 'å…¨ã¦' && data.category !== selectedInventoryCategory) {
                    return;
                }
                // æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’é©ç”¨
                if (inventorySearchQuery) {
                    const query = inventorySearchQuery.toLowerCase();
                    if (!data.name.toLowerCase().includes(query)) {
                        return;
                    }
                }
                // åœ¨åº«çŠ¶æ…‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨
                const currentInventory = inventorySettings[itemId] || {};
                const currentStock = currentInventory.stock;
                const alertThreshold = currentInventory.alertThreshold;
                if (selectedInventoryStatus !== 'å…¨ã¦') {
                    if (selectedInventoryStatus === 'å“åˆ‡ã‚Œ' && currentStock !== 0)
                        return;
                    if (selectedInventoryStatus === 'åœ¨åº«å°‘' && (currentStock === 0 || currentStock === null || (alertThreshold !== null && currentStock > alertThreshold)))
                        return;
                    if (selectedInventoryStatus === 'åœ¨åº«å……åˆ†' && (currentStock === 0 || currentStock === null || (alertThreshold !== null && currentStock <= alertThreshold)))
                        return;
                    if (selectedInventoryStatus === 'ç„¡é™' && currentStock !== null)
                        return;
                }
                // åœ¨åº«ãŒ0ã®å•†å“ã®ã¿å¯¾è±¡
                if (currentStock === 0) {
                    itemsToUpdate.push(itemId);
                }
            });
            if (itemsToUpdate.length === 0) {
                showCustomAlertFunc('åœ¨åº«0ã®å•†å“ãŒã‚ã‚Šã¾ã›ã‚“', 'è­¦å‘Š', 'âš ï¸');
                return;
            }
            // åœ¨åº«ã‚’nullã«è¨­å®šï¼ˆç„¡é™åœ¨åº«ï¼‰
            const newSettings = Object.assign({}, inventorySettings);
            itemsToUpdate.forEach(itemId => {
                newSettings[itemId] = Object.assign(Object.assign({}, newSettings[itemId]), { stock: null, alertThreshold: null });
            });
            setInventorySettings(newSettings);
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            await setDoc(inventoryRef, {
                items: newSettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc(`${itemsToUpdate.length}ä»¶ã®å•†å“ã‚’ç„¡é™åœ¨åº«ã«æˆ»ã—ã¾ã—ãŸ`, 'ä¸€æ‹¬è§£é™¤å®Œäº†', 'âœ…');
            console.log('âœ… ä¸€æ‹¬åœ¨åº«0è§£é™¤å®Œäº†:', itemsToUpdate.length, 'ä»¶');
        }
        catch (error) {
            console.error('âŒ ä¸€æ‹¬åœ¨åº«0è§£é™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ä¸€æ‹¬è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• å…¨å•†å“ã‚’ä¸€æ‹¬ã§å“åˆ‡ã‚Œã«ã™ã‚‹ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç„¡è¦–ï¼‰
    const setAllProductsToZero = async () => {
        const confirmed = await showCustomConfirmFunc('å…¨å•†å“ã‚’å“åˆ‡ã‚Œï¼ˆåœ¨åº«0ï¼‰ã«è¨­å®šã—ã¾ã™ã‹ï¼Ÿ\n\nä¼‘æ¥­æ—¥ãªã©ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\nãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã«é–¢ã‚ã‚‰ãšã€å…¨ã¦ã®å•†å“ãŒå¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'å…¨å•†å“å“åˆ‡', 'è¨­å®šã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { getDocs } = window.firebaseModules;
            // å…¨å•†å“ã‚’å–å¾—
            const menuSnapshot = await getDocs(window.getStoreCollection('menus'));
            const itemsToUpdate = [];
            menuSnapshot.forEach(doc => {
                const data = doc.data();
                const itemId = data.id || doc.id;
                itemsToUpdate.push(itemId);
            });
            if (itemsToUpdate.length === 0) {
                showCustomAlertFunc('å•†å“ãŒã‚ã‚Šã¾ã›ã‚“', 'è­¦å‘Š');
                return;
            }
            // åœ¨åº«ã‚’0ã«è¨­å®š
            const newSettings = Object.assign({}, inventorySettings);
            itemsToUpdate.forEach(itemId => {
                newSettings[itemId] = Object.assign(Object.assign({}, newSettings[itemId]), { stock: 0 });
            });
            setInventorySettings(newSettings);
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            await setDoc(inventoryRef, {
                items: newSettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc(`${itemsToUpdate.length}ä»¶ã®å…¨å•†å“ã‚’å“åˆ‡ã‚Œã«è¨­å®šã—ã¾ã—ãŸ`, 'å…¨å•†å“å“åˆ‡å®Œäº†');
            console.log('âœ… å…¨å•†å“å“åˆ‡å®Œäº†:', itemsToUpdate.length, 'ä»¶');
        }
        catch (error) {
            console.error('âŒ å…¨å•†å“å“åˆ‡ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å…¨å•†å“å“åˆ‡ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ğŸ†• å…¨å•†å“ã‚’ä¸€æ‹¬ã§å¾©æ´»ã•ã›ã‚‹ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç„¡è¦–ï¼‰
    const clearAllProductsZero = async () => {
        const confirmed = await showCustomConfirmFunc('å…¨å•†å“ã®å“åˆ‡ã‚Œã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nå…¨ã¦ã®å•†å“ãŒç„¡é™åœ¨åº«ï¼ˆæœªè¨­å®šï¼‰ã«æˆ»ã‚Šã¾ã™ã€‚\nãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã«é–¢ã‚ã‚‰ãšã€åœ¨åº«0ã®å…¨å•†å“ãŒå¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“', 'å…¨å•†å“å¾©æ´»', 'å¾©æ´»ã•ã›ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { getDocs } = window.firebaseModules;
            // å…¨å•†å“ã‚’å–å¾—
            const menuSnapshot = await getDocs(window.getStoreCollection('menus'));
            const itemsToUpdate = [];
            menuSnapshot.forEach(doc => {
                const data = doc.data();
                const itemId = data.id || doc.id;
                // åœ¨åº«ãŒ0ã®å•†å“ã®ã¿å¯¾è±¡
                const currentInventory = inventorySettings[itemId] || {};
                if (currentInventory.stock === 0) {
                    itemsToUpdate.push(itemId);
                }
            });
            if (itemsToUpdate.length === 0) {
                showCustomAlertFunc('åœ¨åº«0ã®å•†å“ãŒã‚ã‚Šã¾ã›ã‚“', 'è­¦å‘Š');
                return;
            }
            // åœ¨åº«ã‚’nullã«è¨­å®šï¼ˆç„¡é™åœ¨åº«ï¼‰
            const newSettings = Object.assign({}, inventorySettings);
            itemsToUpdate.forEach(itemId => {
                newSettings[itemId] = Object.assign(Object.assign({}, newSettings[itemId]), { stock: null, alertThreshold: null });
            });
            setInventorySettings(newSettings);
            const { setDoc } = window.firebaseModules;
            const inventoryRef = window.getStoreDoc('inventory_settings', 'default');
            await setDoc(inventoryRef, {
                items: newSettings,
                updatedAt: new Date().toISOString()
            });
            showCustomAlertFunc(`${itemsToUpdate.length}ä»¶ã®å…¨å•†å“ã‚’å¾©æ´»ã•ã›ã¾ã—ãŸ`, 'å…¨å•†å“å¾©æ´»å®Œäº†');
            console.log('âœ… å…¨å•†å“å¾©æ´»å®Œäº†:', itemsToUpdate.length, 'ä»¶');
        }
        catch (error) {
            console.error('âŒ å…¨å•†å“å¾©æ´»ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å…¨å•†å“å¾©æ´»ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šèª­ã¿è¾¼ã¿
    const loadTableSettings = async () => {
        try {
            const settingsSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('tableSettings'));
            const settings = {};
            settingsSnapshot.forEach(doc => {
                settings[doc.id] = doc.data();
            });
            setTableSettings(settings);
            console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', Object.keys(settings).length, 'ä»¶');
        }
        catch (e) {
            console.error('âŒ ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        }
    };
    // ğŸ†• ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®èª­ã¿è¾¼ã¿ï¼ˆæ”¹å–„ç‰ˆ: POSã§ä½œæˆã—ãŸãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã‚‚å¯¾å¿œï¼‰
    const loadMenuItems = async () => {
        try {
            const menuSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('menus'));
            const items = [];
            menuSnapshot.forEach(doc => {
                const data = doc.data();
                // ğŸ”§ ä¿®æ­£: idãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã„å ´åˆã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã‚’ä½¿ç”¨
                const itemId = data.id || doc.id;
                // ğŸ†• éè¡¨ç¤ºå•†å“ã¯ã‚¹ã‚­ãƒƒãƒ—
                if (data.hidden)
                    return;
                if (data.name) { // nameãŒã‚ã‚Œã°OK
                    items.push({
                        id: itemId,
                        docId: doc.id, // Firestoreã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆidï¼ˆæ›´æ–°æ™‚ã«å¿…è¦ï¼‰
                        name: data.name,
                        category: data.category || 'æœªåˆ†é¡',
                        order: data.order || 999999 // orderãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
                    });
                }
            });
            // ğŸ†• æ”¹å–„: orderé †ã§ã‚½ãƒ¼ãƒˆï¼ˆorderãŒãªã„å ´åˆã¯å¾Œã‚ã«ï¼‰
            items.sort((a, b) => {
                // orderã§æ¯”è¼ƒ
                if (a.order !== b.order) {
                    return a.order - b.order;
                }
                // orderãŒåŒã˜å ´åˆã¯idé †
                if (a.id < b.id)
                    return -1;
                if (a.id > b.id)
                    return 1;
                return 0;
            });
            setAvailableMenuItems(items);
            console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', items.length, 'ä»¶');
            console.log('   ã‚µãƒ³ãƒ—ãƒ«:', items.slice(0, 3));
        }
        catch (e) {
            console.error('âŒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        }
    };
    // ğŸ†• ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š
    const getDefaultTableSettings = () => ({
        inputFields: {
            name: { visible: false, required: false },
            phone: { visible: false, required: false },
            postalCode: { visible: false, required: false },
            address: { visible: false, required: false },
            email: { visible: false, required: false },
            pickupTime: { visible: false, required: false },
            notes: { visible: true, required: false }
        },
        menuType: 'default',
        customMenuItems: [],
        visibleCategories: [], // ğŸ†• ç©ºé…åˆ— = å…¨ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºã€ã‚«ãƒ†ã‚´ãƒªåã‚’æŒ‡å®š = ãã®ã‚«ãƒ†ã‚´ãƒªã®ã¿è¡¨ç¤º
        timeOverride: {
            enabled: false // æ™‚é–“å¤–è§£é™¤ï¼ˆ24æ™‚é–“å–¶æ¥­ï¼‰
        },
        businessHours: {
            enabled: false, // ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«å°‚ç”¨ã®å–¶æ¥­æ™‚é–“è¨­å®šã‚’ä½¿ç”¨ã™ã‚‹ã‹
            openTime: '11:00',
            closeTime: '22:00'
        },
        taxRule: 'none' // 'none', 'takeout', 'dine-in', 'all-10'
    });
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šä¿å­˜
    const saveTableSettings = async (tableName) => {
        try {
            const settings = tableSettings[tableName] || getDefaultTableSettings();
            await window.firebaseModules.setDoc(window.getStoreDoc('tableSettings', tableName), settings);
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'âœ… ä¿å­˜å®Œäº†', 'âœ…');
            console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šã‚’ä¿å­˜:', tableName);
        }
        catch (e) {
            console.error('âŒ ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
            showCustomAlertFunc('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«å…¥åŠ›æ¬„è¨­å®šæ›´æ–°
    const updateTableInputField = (tableName, fieldName, property, value) => {
        setTableSettings(prev => {
            const current = prev[tableName] || getDefaultTableSettings();
            return Object.assign(Object.assign({}, prev), { [tableName]: Object.assign(Object.assign({}, current), { inputFields: Object.assign(Object.assign({}, current.inputFields), { [fieldName]: Object.assign(Object.assign({}, current.inputFields[fieldName]), { [property]: value }) }) }) });
        });
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¿ã‚¤ãƒ—æ›´æ–°
    const updateTableMenuType = (tableName, menuType) => {
        setTableSettings(prev => {
            const current = prev[tableName] || getDefaultTableSettings();
            return Object.assign(Object.assign({}, prev), { [tableName]: Object.assign(Object.assign({}, current), { menuType: menuType, customMenuItems: menuType === 'default' ? [] : current.customMenuItems }) });
        });
    };
    // ğŸ†• ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ãƒˆã‚°ãƒ«ï¼ˆæ”¹å–„ç‰ˆ: è¡¨ç¤ºé †ã‚‚ç®¡ç†ï¼‰
    const toggleCustomMenuItem = (tableName, itemId) => {
        setTableSettings(prev => {
            const current = prev[tableName] || getDefaultTableSettings();
            const currentItems = current.customMenuItems || [];
            const isCurrentlySelected = currentItems.includes(itemId);
            let newItems;
            if (isCurrentlySelected) {
                // å‰Šé™¤
                newItems = currentItems.filter(id => id !== itemId);
            }
            else {
                // è¿½åŠ ï¼ˆæœ«å°¾ã«è¿½åŠ ï¼‰
                newItems = [...currentItems, itemId];
            }
            return Object.assign(Object.assign({}, prev), { [tableName]: Object.assign(Object.assign({}, current), { customMenuItems: newItems }) });
        });
    };
    // ğŸ†• ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®é †åºã‚’å¤‰æ›´
    const moveCustomMenuItem = (tableName, fromIndex, toIndex) => {
        setTableSettings(prev => {
            const current = prev[tableName] || getDefaultTableSettings();
            const items = [...(current.customMenuItems || [])];
            // é…åˆ—ã®è¦ç´ ã‚’ç§»å‹•
            const [movedItem] = items.splice(fromIndex, 1);
            items.splice(toIndex, 0, movedItem);
            return Object.assign(Object.assign({}, prev), { [tableName]: Object.assign(Object.assign({}, current), { customMenuItems: items }) });
        });
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºè¨­å®šã‚’æ›´æ–°
    const toggleTableCategory = (tableName, category) => {
        setTableSettings(prev => {
            const current = prev[tableName] || getDefaultTableSettings();
            const currentCategories = current.visibleCategories || [];
            let newCategories;
            if (currentCategories.includes(category)) {
                // ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ï¼ˆéè¡¨ç¤ºã«ï¼‰
                newCategories = currentCategories.filter(cat => cat !== category);
            }
            else {
                // ã‚«ãƒ†ã‚´ãƒªã‚’è¿½åŠ ï¼ˆè¡¨ç¤ºã«ï¼‰
                newCategories = [...currentCategories, category];
            }
            return Object.assign(Object.assign({}, prev), { [tableName]: Object.assign(Object.assign({}, current), { visibleCategories: newCategories }) });
        });
    };
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜
    const saveMenuSettings = async () => {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r;
        try {
            // Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æº–å‚™ã‚’å¾…ã¤
            while (!window.FirebaseReady || !window.db) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            console.log('ğŸ’¾ ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šä¿å­˜é–‹å§‹');
            console.log('   window.currentStoreId:', window.currentStoreId);
            console.log('   menuSettings:', menuSettings);
            const { setDoc, Timestamp } = window.firebaseModules;
            // undefinedã‚’falseã«å¤‰æ›ã—ã¦Firestoreã‚¨ãƒ©ãƒ¼ã‚’é˜²ã
            const cleanedSettings = {
                showMemoField: (_a = menuSettings.showMemoField) !== null && _a !== void 0 ? _a : false,
                showNameField: (_b = menuSettings.showNameField) !== null && _b !== void 0 ? _b : false,
                showPostalCodeField: (_c = menuSettings.showPostalCodeField) !== null && _c !== void 0 ? _c : false,
                showAddressField: (_d = menuSettings.showAddressField) !== null && _d !== void 0 ? _d : false,
                showEmailField: (_e = menuSettings.showEmailField) !== null && _e !== void 0 ? _e : false,
                showPhoneField: (_f = menuSettings.showPhoneField) !== null && _f !== void 0 ? _f : false,
                nameRequired: (_g = menuSettings.nameRequired) !== null && _g !== void 0 ? _g : false,
                postalCodeRequired: (_h = menuSettings.postalCodeRequired) !== null && _h !== void 0 ? _h : false,
                addressRequired: (_j = menuSettings.addressRequired) !== null && _j !== void 0 ? _j : false,
                emailRequired: (_k = menuSettings.emailRequired) !== null && _k !== void 0 ? _k : false,
                phoneRequired: (_l = menuSettings.phoneRequired) !== null && _l !== void 0 ? _l : false,
                statusMessage: (_m = menuSettings.statusMessage) !== null && _m !== void 0 ? _m : '',
                warningMessage: (_o = menuSettings.warningMessage) !== null && _o !== void 0 ? _o : '',
                // ãƒ¬ã‚¸è¢‹è¨­å®š
                showBagOption: (_p = menuSettings.showBagOption) !== null && _p !== void 0 ? _p : true,
                bagPrice: (_q = menuSettings.bagPrice) !== null && _q !== void 0 ? _q : 3,
                bagMessage: (_r = menuSettings.bagMessage) !== null && _r !== void 0 ? _r : 'â€» 1æš3å•†å“ç¨‹åº¦å…¥ã‚Šã¾ã™'
            };
            const settingsData = Object.assign(Object.assign({}, cleanedSettings), { updatedAt: Timestamp.now() });
            // ğŸ”§ ä¿®æ­£: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯å¸¸ã«'default'ã‚’ä½¿ç”¨
            const docId = 'default';
            const menuSettingsRef = window.getStoreDoc('menu_settings', docId);
            console.log('ä¿å­˜ã™ã‚‹ãƒ‡ãƒ¼ã‚¿:', settingsData);
            console.log('ä¿å­˜å…ˆ: ' + (window.currentStoreId ? 'stores/' + window.currentStoreId + '/menu_settings/' + docId : 'menu_settings/shimoakatsuka'));
            await setDoc(menuSettingsRef, settingsData);
            console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ:', settingsData);
            showCustomAlertFunc('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
        }
        catch (error) {
            console.error('âŒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿
    const loadMenuSettings = async () => {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r;
        try {
            console.log('ğŸ“– ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šèª­ã¿è¾¼ã¿é–‹å§‹');
            console.log('   window.currentStoreId:', window.currentStoreId);
            const { doc, getDoc } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯å¸¸ã«'default'ã‚’ä½¿ç”¨
            const docId = 'default';
            const menuSettingsRef = window.getStoreDoc('menu_settings', docId);
            console.log('ğŸ“– èª­ã¿è¾¼ã¿ãƒ‘ã‚¹:', window.currentStoreId ?
                'stores/' + window.currentStoreId + '/menu_settings/default' :
                'menu_settings/shimoakatsuka');
            const menuSettingsDoc = await getDoc(menuSettingsRef);
            console.log('ğŸ“– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå­˜åœ¨:', menuSettingsDoc.exists());
            if (menuSettingsDoc.exists()) {
                const loadedSettings = menuSettingsDoc.data();
                console.log('ğŸ“– èª­ã¿è¾¼ã‚“ã è¨­å®š:', loadedSettings);
                // å¤ã„è¨­å®šã«ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’é©ç”¨
                const mergedSettings = {
                    showMemoField: (_a = loadedSettings.showMemoField) !== null && _a !== void 0 ? _a : false,
                    showNameField: (_b = loadedSettings.showNameField) !== null && _b !== void 0 ? _b : false,
                    showPostalCodeField: (_c = loadedSettings.showPostalCodeField) !== null && _c !== void 0 ? _c : false,
                    showAddressField: (_d = loadedSettings.showAddressField) !== null && _d !== void 0 ? _d : false,
                    showEmailField: (_e = loadedSettings.showEmailField) !== null && _e !== void 0 ? _e : false,
                    showPhoneField: (_f = loadedSettings.showPhoneField) !== null && _f !== void 0 ? _f : false,
                    nameRequired: (_g = loadedSettings.nameRequired) !== null && _g !== void 0 ? _g : false,
                    postalCodeRequired: (_h = loadedSettings.postalCodeRequired) !== null && _h !== void 0 ? _h : false,
                    addressRequired: (_j = loadedSettings.addressRequired) !== null && _j !== void 0 ? _j : false,
                    emailRequired: (_k = loadedSettings.emailRequired) !== null && _k !== void 0 ? _k : false,
                    phoneRequired: (_l = loadedSettings.phoneRequired) !== null && _l !== void 0 ? _l : false,
                    statusMessage: (_m = loadedSettings.statusMessage) !== null && _m !== void 0 ? _m : '',
                    warningMessage: (_o = loadedSettings.warningMessage) !== null && _o !== void 0 ? _o : '',
                    // ãƒ¬ã‚¸è¢‹è¨­å®š
                    showBagOption: (_p = loadedSettings.showBagOption) !== null && _p !== void 0 ? _p : true,
                    bagPrice: (_q = loadedSettings.bagPrice) !== null && _q !== void 0 ? _q : 3,
                    bagMessage: (_r = loadedSettings.bagMessage) !== null && _r !== void 0 ? _r : 'â€» 1æš3å•†å“ç¨‹åº¦å…¥ã‚Šã¾ã™'
                };
                setMenuSettings(mergedSettings);
                console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤é©ç”¨æ¸ˆã¿ï¼‰');
            }
            else {
                console.log('âš ï¸ ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ç·¨é›†å¯èƒ½ã§ã™ã€‚');
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã™ã§ã«stateã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ä½•ã‚‚ã—ãªã„
            }
        }
        catch (error) {
            console.error('âŒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿ï¼ˆmenu.htmlå…¨ä½“ã®è¨­å®šï¼‰
    const loadGlobalMenuSettings = async () => {
        try {
            const { getDoc } = window.firebaseModules;
            const settingsRef = window.getStoreDoc('global_menu_settings', 'default');
            const settingsDoc = await getDoc(settingsRef);
            if (settingsDoc.exists()) {
                const data = settingsDoc.data();
                setGlobalMenuSettings({
                    hiddenCategories: data.hiddenCategories || [],
                    menuOrder: data.menuOrder || []
                });
                console.log('âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
        }
        catch (error) {
            console.error('âŒ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜
    const saveGlobalMenuSettings = async () => {
        try {
            const { setDoc, Timestamp } = window.firebaseModules;
            const settingsRef = window.getStoreDoc('global_menu_settings', 'default');
            await setDoc(settingsRef, Object.assign(Object.assign({}, globalMenuSettings), { updatedAt: Timestamp.now() }));
            showCustomAlertFunc('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'ä¿å­˜å®Œäº†', 'âœ…');
            console.log('âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }
        catch (error) {
            console.error('âŒ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ã‚«ãƒ†ã‚´ãƒªã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
    const toggleCategoryVisibility = (category) => {
        setGlobalMenuSettings(prev => {
            const hidden = [...prev.hiddenCategories];
            const index = hidden.indexOf(category);
            if (index > -1) {
                hidden.splice(index, 1); // è¡¨ç¤ºã™ã‚‹
            }
            else {
                hidden.push(category); // éè¡¨ç¤ºã«ã™ã‚‹
            }
            return Object.assign(Object.assign({}, prev), { hiddenCategories: hidden });
        });
    };
    // ğŸ†• ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®è¡¨ç¤ºé †ã‚’å¤‰æ›´
    const moveGlobalMenuItem = (fromIndex, toIndex) => {
        setGlobalMenuSettings(prev => {
            const order = [...prev.menuOrder];
            const [movedItem] = order.splice(fromIndex, 1);
            order.splice(toIndex, 0, movedItem);
            return Object.assign(Object.assign({}, prev), { menuOrder: order });
        });
    };
    // ğŸ†• ç¾åœ¨ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼é †åºã‚’åˆæœŸåŒ–ï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨å¾Œï¼‰
    const initializeMenuOrder = () => {
        const filtered = availableMenuItems.filter(item => {
            if (menuManagementCategory === 'all')
                return true;
            return item.category === menuManagementCategory;
        });
        setGlobalMenuSettings(prev => (Object.assign(Object.assign({}, prev), { menuOrder: filtered.map(item => item.id) })));
    };
    // ğŸ†• å•†å“ç™»éŒ²é–¢æ•°
    const registerProduct = async () => {
        try {
            const { name, price, category, customCategory, note, image, taxRate, taxType, foodType } = productForm;
            if (!name.trim()) {
                showCustomAlertFunc('å•†å“åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            if (!price || price < 0) {
                showCustomAlertFunc('æ­£ã—ã„ä¾¡æ ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            const finalCategory = customCategory.trim() || category;
            if (!finalCategory) {
                showCustomAlertFunc('ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã™ã‚‹ã‹ã€ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ†ã‚´ãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆã‚’å‡¦ç†
            const toppingSets = productToppingSets.filter(set => set.name && set.options.length > 0);
            const toppingIds = [];
            if (toppingSets.length > 0) {
                const toppingsSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('toppings'));
                let maxNum = 15;
                toppingsSnapshot.forEach(doc => {
                    const data = doc.data();
                    if (data.id && data.id.startsWith('T')) {
                        const num = parseInt(data.id.substring(1));
                        if (num > maxNum)
                            maxNum = num;
                    }
                });
                for (const set of toppingSets) {
                    for (const option of set.options) {
                        maxNum++;
                        const toppingId = 'T' + String(maxNum).padStart(4, '0');
                        await window.firebaseModules.addDoc(window.getStoreCollection('toppings'), {
                            id: toppingId,
                            name: option.name,
                            price: option.price || 0,
                            order: maxNum
                        });
                        toppingIds.push(toppingId);
                    }
                }
            }
            // æœ€å¤§IDã‚’å–å¾—
            const menusSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('menus'));
            let maxMenuNum = 0;
            let maxOrder = 0;
            menusSnapshot.forEach(doc => {
                const data = doc.data();
                if (data.id) {
                    const match = data.id.match(/\d+$/);
                    if (match) {
                        const num = parseInt(match[0]);
                        if (num > maxMenuNum)
                            maxMenuNum = num;
                    }
                }
                if (data.order && data.order > maxOrder) {
                    maxOrder = data.order;
                }
            });
            maxMenuNum++;
            const productId = 'M' + String(maxMenuNum).padStart(4, '0');
            maxOrder++;
            const productData = {
                id: productId,
                name: name.trim(),
                price: parseInt(price),
                category: finalCategory,
                toppingSets: toppingSets,
                toppingsId: toppingIds.join(','),
                note: note.trim(),
                image: image.trim() || '',
                taxRate: taxRate,
                taxType: taxType || 'inclusive', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å†…ç¨
                foodType: foodType || 'food', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯é£Ÿæ
                order: maxOrder,
                createdAt: window.firebaseModules.Timestamp.now()
            };
            await window.firebaseModules.addDoc(window.getStoreCollection('menus'), productData);
            showCustomAlertFunc('å•†å“ã‚’ç™»éŒ²ã—ã¾ã—ãŸ', 'âœ… ç™»éŒ²å®Œäº†', 'âœ…');
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
            setProductForm({
                name: '',
                price: '',
                category: '',
                customCategory: '',
                note: '',
                image: '',
                taxRate: 10,
                taxType: 'inclusive',
                foodType: 'food'
            });
            setProductToppingSets([]);
            setShowProductRegistration(false);
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å†èª­ã¿è¾¼ã¿
            await loadMenuItems();
        }
        catch (error) {
            console.error('å•†å“ç™»éŒ²ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å•†å“ã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• å•†å“å‰Šé™¤é–¢æ•°ï¼ˆã‚½ãƒ•ãƒˆå‰Šé™¤ï¼šhidden: trueã«è¨­å®šï¼‰
    const deleteProduct = async (docId, productName) => {
        const confirmed = await showCustomConfirmFunc(`ã€Œ${productName}ã€ã‚’éè¡¨ç¤ºã«ã—ã¾ã™ã‹ï¼Ÿ\n\néè¡¨ç¤ºã«ã—ãŸå•†å“ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰è¦‹ãˆãªããªã‚Šã¾ã™ãŒã€å¾Œã‹ã‚‰å¾©å…ƒã§ãã¾ã™ã€‚`, 'âš ï¸ å•†å“ã‚’éè¡¨ç¤ºã«ã™ã‚‹', 'âš ï¸');
        if (!confirmed)
            return;
        try {
            // ğŸ”§ ä¿®æ­£: window.getStoreDocã‚’ä½¿ç”¨ã—ã¦æ­£ã—ã„ãƒ‘ã‚¹ã«ä¿å­˜
            await window.firebaseModules.updateDoc(window.getStoreDoc('menus', docId), { hidden: true });
            showCustomAlertFunc('å•†å“ã‚’éè¡¨ç¤ºã«ã—ã¾ã—ãŸã€‚ã€Œå¾©å…ƒæ¸ˆã¿å•†å“ã€ã‹ã‚‰å…ƒã«æˆ»ã›ã¾ã™ã€‚', 'âœ… éè¡¨ç¤ºå®Œäº†', 'âœ…');
            // å•†å“ãƒªã‚¹ãƒˆã‚’å†èª­ã¿è¾¼ã¿
            await loadProductsForDelete();
            await loadMenuItems();
        }
        catch (error) {
            console.error('å•†å“å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å•†å“ã®éè¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• å•†å“å¾©å…ƒé–¢æ•°ï¼ˆhidden: falseã«æˆ»ã™ï¼‰
    const restoreProduct = async (docId, productName) => {
        const confirmed = await showCustomConfirmFunc(`ã€Œ${productName}ã€ã‚’å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ\n\nãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«å†åº¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚`, 'ğŸ”„ å•†å“å¾©å…ƒã®ç¢ºèª', 'ğŸ”„');
        if (!confirmed)
            return;
        try {
            // ğŸ”§ ä¿®æ­£: window.getStoreDocã‚’ä½¿ç”¨ã—ã¦æ­£ã—ã„ãƒ‘ã‚¹ã«ä¿å­˜
            await window.firebaseModules.updateDoc(window.getStoreDoc('menus', docId), { hidden: false });
            showCustomAlertFunc('å•†å“ã‚’å¾©å…ƒã—ã¾ã—ãŸã€‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«å†åº¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚', 'âœ… å¾©å…ƒå®Œäº†', 'âœ…');
            // å•†å“ãƒªã‚¹ãƒˆã‚’å†èª­ã¿è¾¼ã¿
            await loadProductsForDelete();
            await loadMenuItems();
        }
        catch (error) {
            console.error('å•†å“å¾©å…ƒã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å•†å“ã®å¾©å…ƒã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• å•†å“å‰Šé™¤ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿ï¼ˆéè¡¨ç¤ºå•†å“ã‚‚å«ã‚€ï¼‰
    const loadProductsForDelete = async () => {
        try {
            const menuSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('menus'));
            const products = [];
            menuSnapshot.forEach(doc => {
                products.push(Object.assign({ docId: doc.id, hidden: doc.data().hidden || false }, doc.data()));
            });
            products.sort((a, b) => {
                if (a.category !== b.category) {
                    return a.category.localeCompare(b.category);
                }
                return a.name.localeCompare(b.name);
            });
            setProductsForDelete(products);
        }
        catch (error) {
            console.error('å•†å“ãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• å•†å“ç·¨é›†ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿
    const loadProductsForEdit = async () => {
        try {
            const menuSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('menus'));
            const products = [];
            menuSnapshot.forEach(doc => {
                products.push(Object.assign({ docId: doc.id }, doc.data()));
            });
            products.sort((a, b) => {
                if (a.category !== b.category) {
                    return a.category.localeCompare(b.category);
                }
                return a.name.localeCompare(b.name);
            });
            setProductsForEdit(products);
        }
        catch (error) {
            console.error('å•†å“ãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• å•†å“ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
    const openEditProduct = (product) => {
        setEditingProductId(product.docId);
        setProductForm({
            name: product.name || '',
            price: product.price || '',
            category: product.category || '',
            customCategory: '',
            note: product.note || '',
            image: product.image || '',
            taxRate: product.taxRate || 10,
            taxType: product.taxType || 'inclusive', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å†…ç¨
            foodType: product.foodType || 'food' // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯é£Ÿæ
        });
        setProductToppingSets(product.toppingSets || []);
        setShowProductEdit(true);
    };
    // ğŸ†• å•†å“ã‚’æ›´æ–°
    const updateProduct = async () => {
        try {
            const { name, price, category, customCategory, note, image, taxRate, taxType, foodType } = productForm;
            if (!name.trim()) {
                showCustomAlertFunc('å•†å“åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            if (!price || price < 0) {
                showCustomAlertFunc('æ­£ã—ã„ä¾¡æ ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            const finalCategory = customCategory.trim() || category;
            if (!finalCategory) {
                showCustomAlertFunc('ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã™ã‚‹ã‹ã€ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ†ã‚´ãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆã‚’å‡¦ç†
            const toppingSets = productToppingSets.filter(set => set.name && set.options.length > 0);
            const updateData = {
                name: name.trim(),
                price: parseInt(price),
                category: finalCategory,
                toppingSets: toppingSets,
                note: note.trim(),
                image: image.trim() || '',
                taxRate: taxRate,
                taxType: taxType || 'inclusive', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å†…ç¨
                foodType: foodType || 'food' // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯é£Ÿæ
            };
            await window.firebaseModules.updateDoc(window.firebaseModules.doc(window.db, 'stores', window.currentStoreId, 'menus', editingProductId), updateData);
            showCustomAlertFunc('å•†å“ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'âœ… æ›´æ–°å®Œäº†', 'âœ…');
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
            setProductForm({
                name: '',
                price: '',
                category: '',
                customCategory: '',
                note: '',
                image: '',
                taxRate: 10,
                taxType: 'inclusive',
                foodType: 'food'
            });
            setProductToppingSets([]);
            setEditingProductId(null);
            setShowProductEdit(false);
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å†èª­ã¿è¾¼ã¿
            await loadMenuItems();
            await loadProductsForEdit();
        }
        catch (error) {
            console.error('å•†å“æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å•†å“ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆã‚’è¿½åŠ 
    const addToppingSet = () => {
        setProductToppingSets([...productToppingSets, {
                name: '',
                type: 'single',
                options: [{ name: '', price: 0 }]
            }]);
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆã‚’å‰Šé™¤
    const removeToppingSet = (index) => {
        setProductToppingSets(productToppingSets.filter((_, i) => i !== index));
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
    const addToppingOption = (setIndex) => {
        const newSets = [...productToppingSets];
        newSets[setIndex].options.push({ name: '', price: 0 });
        setProductToppingSets(newSets);
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤
    const removeToppingOption = (setIndex, optionIndex) => {
        const newSets = [...productToppingSets];
        newSets[setIndex].options = newSets[setIndex].options.filter((_, i) => i !== optionIndex);
        setProductToppingSets(newSets);
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆåã‚’æ›´æ–°
    const updateToppingSetName = (setIndex, name) => {
        const newSets = [...productToppingSets];
        newSets[setIndex].name = name;
        setProductToppingSets(newSets);
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒƒãƒˆã‚¿ã‚¤ãƒ—ã‚’æ›´æ–°
    const updateToppingSetType = (setIndex, type) => {
        const newSets = [...productToppingSets];
        newSets[setIndex].type = type;
        setProductToppingSets(newSets);
    };
    // ğŸ†• ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°
    const updateToppingOption = (setIndex, optionIndex, field, value) => {
        const newSets = [...productToppingSets];
        newSets[setIndex].options[optionIndex][field] = value;
        setProductToppingSets(newSets);
    };
    // ğŸ†• ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ï¼ˆå•†å“ç™»éŒ²ç”¨ï¼‰
    const uploadProductImage = async (fileInputId, progressId, previewId, targetInputId) => {
        const fileInput = document.getElementById(fileInputId);
        const file = fileInput.files[0];
        if (!file) {
            showCustomAlertFunc('ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„', 'âš ï¸ ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
            return;
        }
        const progressDiv = document.getElementById(progressId);
        const previewDiv = document.getElementById(previewId);
        progressDiv.textContent = 'â³ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...';
        progressDiv.style.color = '#2196F3';
        try {
            const timestamp = Date.now();
            const fileName = `${timestamp}_${file.name}`;
            const storageReference = window.storageRef(window.storage, `products/${fileName}`);
            await window.uploadBytes(storageReference, file);
            const imageUrl = await window.getDownloadURL(storageReference);
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ›´æ–°
            setProductForm(prev => (Object.assign(Object.assign({}, prev), { image: imageUrl })));
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
            previewDiv.innerHTML = `<img src="${imageUrl}" style="max-width: 200px; max-height: 200px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">`;
            progressDiv.textContent = 'âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†';
            progressDiv.style.color = '#4CAF50';
            setTimeout(() => {
                progressDiv.textContent = '';
            }, 3000);
        }
        catch (error) {
            console.error('ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
            progressDiv.textContent = 'âŒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—: ' + error.message;
            progressDiv.style.color = '#f44336';
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
    const loadTablesList = async () => {
        try {
            const tablesSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('tables'));
            const tablesList = [];
            tablesSnapshot.forEach(doc => {
                tablesList.push(Object.assign({ id: doc.id }, doc.data()));
            });
            tablesList.sort((a, b) => (a.order || 0) - (b.order || 0) || a.name.localeCompare(b.name));
            setTables(tablesList);
        }
        catch (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
    const addTable = async () => {
        const { name, staffMemo, memoEnabled } = newTableForm;
        if (!name.trim()) {
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
            return;
        }
        try {
            const tablesSnapshot = await window.firebaseModules.getDocs(window.getStoreCollection('tables'));
            let exists = false;
            tablesSnapshot.forEach(doc => {
                if (doc.data().name === name.trim()) {
                    exists = true;
                }
            });
            if (exists) {
                showCustomAlertFunc('åŒã˜åå‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™', 'âš ï¸ ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                return;
            }
            const maxOrder = tables.reduce((max, t) => Math.max(max, t.order || 0), 0);
            await window.firebaseModules.addDoc(window.getStoreCollection('tables'), {
                name: name.trim(),
                staffMemo: staffMemo.trim(),
                memoEnabled: memoEnabled,
                order: maxOrder + 1,
                createdAt: window.firebaseModules.Timestamp.now()
            });
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
            setNewTableForm({ name: '', staffMemo: '', memoEnabled: false });
            setShowAddTable(false);
            await loadTablesList();
            await loadTables(); // ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šç”¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚‚æ›´æ–°
        }
        catch (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç·¨é›†
    const updateTable = async () => {
        const { id, name, staffMemo, memoEnabled } = editTableForm;
        if (!name.trim()) {
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
            return;
        }
        try {
            await window.firebaseModules.updateDoc(window.firebaseModules.doc(window.db, 'stores', window.currentStoreId, 'tables', id), {
                name: name.trim(),
                staffMemo: staffMemo.trim(),
                memoEnabled: memoEnabled
            });
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
            setShowEditTable(false);
            await loadTablesList();
            await loadTables(); // ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šç”¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚‚æ›´æ–°
        }
        catch (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤
    const deleteTable = async (tableId, tableName) => {
        const confirmed = await showCustomConfirmFunc(`ã€Œ${tableName}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nâš ï¸ ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®QRã‚³ãƒ¼ãƒ‰ã¯ä½¿ç”¨ã§ããªããªã‚Šã¾ã™`, 'âš ï¸ ç¢ºèª', 'âš ï¸');
        if (!confirmed)
            return;
        try {
            await window.firebaseModules.deleteDoc(window.firebaseModules.doc(window.db, 'stores', window.currentStoreId, 'tables', tableId));
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
            await loadTablesList();
        }
        catch (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ã®é †åºã‚’å¤‰æ›´
    const moveTable = async (fromIndex, toIndex) => {
        if (toIndex < 0 || toIndex >= tables.length)
            return;
        const newTables = [...tables];
        const [movedTable] = newTables.splice(fromIndex, 1);
        newTables.splice(toIndex, 0, movedTable);
        try {
            const updatePromises = newTables.map((table, index) => window.firebaseModules.updateDoc(window.firebaseModules.doc(window.db, 'stores', window.currentStoreId, 'tables', table.id), { order: index + 1 }));
            await Promise.all(updatePromises);
            setTables(newTables);
        }
        catch (error) {
            console.error('é †åºå¤‰æ›´ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('é †åºã®å¤‰æ›´ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• QRã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
    const showQrCodeModal = (tableName) => {
        const baseUrl = window.location.origin + window.location.pathname.replace('kanri.html', 'menu.html');
        const url = `${baseUrl}?table=${tableName}&store=${window.currentStoreId}`;
        setQrCodeData({ name: tableName, url: url });
        setShowQrCode(true);
    };
    // é›»å­å°é‘‘ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
    const handleStampUpload = (e) => {
        const file = e.target.files[0];
        if (!file)
            return;
        const reader = new FileReader();
        reader.onload = (event) => {
            setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { stampImage: event.target.result }));
        };
        reader.readAsDataURL(file);
    };
    // ğŸ†• CSVå‡ºåŠ›é–¢æ•°: å£²ä¸Šãƒ‡ãƒ¼ã‚¿
    const exportSalesCSV = async () => {
        try {
            showCustomAlertFunc('å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆä¸­...', 'â„¹ï¸ å‡¦ç†ä¸­', 'â„¹ï¸');
            const startDate = new Date(exportStartDate);
            startDate.setHours(0, 0, 0, 0);
            const endDate = new Date(exportEndDate);
            endDate.setHours(23, 59, 59, 999);
            // æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const ordersSnapshot = await window.firebaseModules.getDocs(window.firebaseModules.query(window.getStoreCollection('orders'), window.firebaseModules.where('timestamp', '>=', window.firebaseModules.Timestamp.fromDate(startDate)), window.firebaseModules.where('timestamp', '<=', window.firebaseModules.Timestamp.fromDate(endDate)), window.firebaseModules.orderBy('timestamp', 'asc')));
            let csvContent = '\uFEFF'; // BOM for Excel
            csvContent += 'æ—¥ä»˜,æ³¨æ–‡ç•ªå·,ãƒ†ãƒ¼ãƒ–ãƒ«,åˆè¨ˆé‡‘é¡,ç¨ç‡8%å£²ä¸Š,ç¨ç‡10%å£²ä¸Š,å•†å“æ˜ç´°,ãƒ¡ãƒ¢\n';
            ordersSnapshot.forEach(doc => {
                const order = doc.data();
                // å‰Šé™¤æ¸ˆã¿ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ¸ˆã¿ã¯é™¤å¤–
                if (order.deleted || order.cancelledAt)
                    return;
                const date = order.timestamp.toDate();
                const dateStr = `${date.getFullYear()}/${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getDate()).padStart(2, '0')}`;
                const orderNum = order.orderNumber || '';
                const table = order.tableNumber || '';
                const total = order.totalAmount || 0;
                // ç¨ç‡åˆ¥å£²ä¸Šã‚’è¨ˆç®—
                let sales8 = 0;
                let sales10 = 0;
                let itemsDetail = [];
                if (order.items && Array.isArray(order.items)) {
                    order.items.forEach(item => {
                        const itemName = item.name || '';
                        const itemPrice = item.price || 0;
                        const itemQty = item.quantity || 1;
                        const toppingPrice = item.toppingPrice || 0;
                        const taxRate = item.taxRate || 10;
                        const itemTotal = (itemPrice + toppingPrice) * itemQty;
                        if (taxRate === 8) {
                            sales8 += itemTotal;
                        }
                        else {
                            sales10 += itemTotal;
                        }
                        itemsDetail.push(`${itemName}Ã—${itemQty}`);
                    });
                }
                const itemsStr = itemsDetail.join('; ');
                const memo = (order.memo || '').replace(/"/g, '""').replace(/\n/g, ' ');
                csvContent += `${dateStr},${orderNum},${table},${total},${sales8},${sales10},"${itemsStr}","${memo}"\n`;
            });
            // CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `å£²ä¸Šãƒ‡ãƒ¼ã‚¿_${exportStartDate}_${exportEndDate}.csv`;
            link.click();
            showCustomAlertFunc('å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
        }
        catch (e) {
            console.error('å£²ä¸ŠCSVå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', e);
            showCustomAlertFunc('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + e.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• CSVå‡ºåŠ›é–¢æ•°: æ”¯å‡ºãƒ‡ãƒ¼ã‚¿ï¼ˆå°†æ¥å®Ÿè£…ç”¨ã®ä»®é–¢æ•°ï¼‰
    const exportExpensesCSV = async () => {
        showCustomAlertFunc('æ”¯å‡ºãƒ‡ãƒ¼ã‚¿æ©Ÿèƒ½ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™', 'â„¹ï¸ æƒ…å ±', 'â„¹ï¸');
    };
    // ğŸ†• CSVå‡ºåŠ›é–¢æ•°: äººä»¶è²»ãƒ‡ãƒ¼ã‚¿
    const exportPayrollCSV = async () => {
        try {
            showCustomAlertFunc('äººä»¶è²»ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆä¸­...', 'â„¹ï¸ å‡¦ç†ä¸­', 'â„¹ï¸');
            const startDate = new Date(exportStartDate);
            const endDate = new Date(exportEndDate);
            let csvContent = '\uFEFF';
            csvContent += 'å¹´æœˆ,å¾“æ¥­å“¡å,å¾“æ¥­å“¡ç•ªå·,ç·æ”¯çµ¦é¡,å¥åº·ä¿é™º,åšç”Ÿå¹´é‡‘,é›‡ç”¨ä¿é™º,æ‰€å¾—ç¨,ä½æ°‘ç¨,æ‰‹å–é¡\n';
            // æœŸé–“å†…ã®å„æœˆã‚’ãƒ«ãƒ¼ãƒ—
            const currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const yearMonth = `${year}å¹´${month + 1}æœˆ`;
                // å„å¾“æ¥­å“¡ã®çµ¦ä¸ã‚’è¨ˆç®—
                for (const employee of employees) {
                    const totals = calculateMonthlyTotals(employee.id, year, month);
                    if (totals.hours === 0 && totals.monthlySalary === 0) {
                        // å‹¤å‹™å®Ÿç¸¾ãªã—ã¯ã‚¹ã‚­ãƒƒãƒ—
                        continue;
                    }
                    const salaryType = employee.salaryType || 'æ™‚é–“çµ¦';
                    const grossPay = salaryType === 'æœˆçµ¦' ? totals.monthlyTotalGross : totals.hourlyTotalGross;
                    const netPay = salaryType === 'æœˆçµ¦' ? totals.monthlyNetPay : totals.hourlyNetPay;
                    csvContent += `${yearMonth},${employee.name},${employee.id},${Math.round(grossPay)},${Math.round(totals.healthInsurance)},${Math.round(totals.pension)},${Math.round(totals.employmentInsurance)},${Math.round(totals.incomeTax)},${Math.round(totals.residentTax)},${Math.round(netPay)}\n`;
                }
                // æ¬¡ã®æœˆã¸
                currentDate.setMonth(currentDate.getMonth() + 1);
            }
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `äººä»¶è²»ãƒ‡ãƒ¼ã‚¿_${exportStartDate}_${exportEndDate}.csv`;
            link.click();
            showCustomAlertFunc('äººä»¶è²»ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
        }
        catch (e) {
            console.error('äººä»¶è²»CSVå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', e);
            showCustomAlertFunc('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + e.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• CSVå‡ºåŠ›é–¢æ•°: å¾“æ¥­å“¡ä¸€è¦§
    const exportEmployeesCSV = async () => {
        try {
            let csvContent = '\uFEFF';
            csvContent += 'å¾“æ¥­å“¡ç•ªå·,æ°å,åŒºåˆ†,æ™‚çµ¦/æœˆçµ¦,äº¤é€šè²»,å…¥ç¤¾æ—¥,ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹\n';
            employees.forEach(emp => {
                const empId = emp.id || '';
                const name = emp.name || '';
                const salaryType = emp.salaryType || 'æ™‚é–“çµ¦';
                const rate = emp.rate || 0;
                const monthlySalary = emp.monthlySalary || 0;
                const transport = emp.transport || 0;
                const hireDate = emp.hireDate || '';
                const status = 'åœ¨ç±';
                const amount = salaryType === 'æœˆçµ¦' ? monthlySalary : rate;
                csvContent += `${empId},${name},${salaryType},${amount},${transport},${hireDate},${status}\n`;
            });
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `å¾“æ¥­å“¡ä¸€è¦§_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            showCustomAlertFunc('å¾“æ¥­å“¡ä¸€è¦§ã‚’å‡ºåŠ›ã—ã¾ã—ãŸ', 'âœ… å®Œäº†', 'âœ…');
        }
        catch (e) {
            console.error('å¾“æ¥­å“¡CSVå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', e);
            showCustomAlertFunc('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + e.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ğŸ†• å¼¥ç”Ÿä¼šè¨ˆç­‰å‘ã‘ãƒ‡ãƒ¼ã‚¿é€£æºCSVå‡ºåŠ›æ©Ÿèƒ½ï¼ˆå¹´æŒ‡å®šå¯¾å¿œ + è¿½åŠ ãƒ‡ãƒ¼ã‚¿ï¼‰
    const exportAccountingDataCSV = async () => {
        try {
            // å¹´é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            const currentYear = new Date().getFullYear();
            const yearOptions = [];
            for (let y = currentYear - 5; y <= currentYear + 1; y++) {
                yearOptions.push(y);
            }
            const selectedYear = await new Promise((resolve) => {
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999; overflow-y: auto; padding: 20px;';
                const content = document.createElement('div');
                content.style.cssText = 'background: white; padding: 30px; border-radius: 12px; max-width: 400px; width: 90%; max-height: 90vh; overflow-y: auto; margin: auto;';
                content.innerHTML = `
                            <h3 style="margin: 0 0 20px 0; font-size: 20px; font-weight: bold;">ğŸ“… å‡ºåŠ›å¹´åº¦ã‚’é¸æŠ</h3>
                            <select id="yearSelect" style="width: 100%; padding: 10px; font-size: 16px; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
                                ${yearOptions.map(y => `<option value="${y}" ${y === currentYear ? 'selected' : ''}>${y}å¹´</option>`).join('')}
                            </select>
                            <div style="display: flex; gap: 10px;">
                                <button id="cancelBtn" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                                <button id="confirmBtn" style="flex: 1; padding: 12px; background: #8b5cf6; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">å‡ºåŠ›ã™ã‚‹</button>
                            </div>
                        `;
                modal.appendChild(content);
                document.body.appendChild(modal);
                document.getElementById('confirmBtn').onclick = () => {
                    const year = parseInt(document.getElementById('yearSelect').value);
                    document.body.removeChild(modal);
                    resolve(year);
                };
                document.getElementById('cancelBtn').onclick = () => {
                    document.body.removeChild(modal);
                    resolve(null);
                };
            });
            if (!selectedYear)
                return;
            const { collection, getDocs, query, where, orderBy } = window.firebaseModules;
            // æœŸé–“è¨­å®šï¼ˆé¸æŠå¹´ã®1æœˆ1æ—¥ã€œ12æœˆ31æ—¥ï¼‰
            const startDate = `${selectedYear}-01-01`;
            const endDate = `${selectedYear}-12-31`;
            showCustomAlertFunc('ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆä¸­ã§ã™...', 'â³ å‡¦ç†ä¸­', 'â³');
            // ==================== 1. å£²ä¸Šãƒ‡ãƒ¼ã‚¿ ====================
            let totalSales = 0;
            let totalCashSales = 0;
            let totalCreditSales = 0;
            let totalEmoneSales = 0;
            let totalCustomerCount = 0;
            let totalTax8 = 0;
            let totalTax10 = 0;
            const dailyDataArray = [];
            const dailySalesRef = window.getStoreCollection('dailySales');
            const salesSnapshot = await getDocs(dailySalesRef);
            salesSnapshot.forEach(doc => {
                const dateKey = doc.id;
                if (dateKey >= startDate && dateKey <= endDate) {
                    const data = doc.data();
                    totalSales += data.totalSales || 0;
                    totalCashSales += data.cashSales || 0;
                    totalCreditSales += data.creditSales || 0;
                    totalEmoneSales += data.emoneSales || 0;
                    totalCustomerCount += data.customerCount || 0;
                    totalTax8 += data.tax8Total || 0;
                    totalTax10 += data.tax10Total || 0;
                    dailyDataArray.push({
                        date: dateKey,
                        totalSales: data.totalSales || 0,
                        cashSales: data.cashSales || 0,
                        creditSales: data.creditSales || 0,
                        emoneSales: data.emoneSales || 0,
                        customerCount: data.customerCount || 0,
                        tax8: data.tax8Total || 0,
                        tax10: data.tax10Total || 0
                    });
                }
            });
            // ==================== 2. å•†å“åˆ¥å£²ä¸Šãƒ‡ãƒ¼ã‚¿ ====================
            const productSales = {};
            const ordersRef = window.getStoreCollection('orders');
            const ordersSnapshot = await getDocs(ordersRef);
            ordersSnapshot.forEach(doc => {
                const orderData = doc.data();
                if (orderData.paidAt && !orderData.deleted) {
                    const paidDate = orderData.paidAt.toDate ? orderData.paidAt.toDate() : new Date(orderData.paidAt);
                    const dateStr = paidDate.toISOString().split('T')[0];
                    if (dateStr >= startDate && dateStr <= endDate) {
                        orderData.items.forEach(item => {
                            const itemName = item.name;
                            if (!productSales[itemName]) {
                                productSales[itemName] = {
                                    quantity: 0,
                                    revenue: 0
                                };
                            }
                            productSales[itemName].quantity += item.quantity || 1;
                            productSales[itemName].revenue += (item.price * (item.quantity || 1));
                        });
                    }
                }
            });
            // ==================== 3. äººä»¶è²»ãƒ‡ãƒ¼ã‚¿ ====================
            let totalLaborCost = 0;
            const laborCostByEmployee = {};
            const laborDetailByEmployee = {};
            for (const emp of employees) {
                const employeeId = emp.id;
                let employeeTotalCost = 0;
                let workDays = 0;
                let totalWorkHours = 0;
                let totalTransport = 0;
                const attendanceRef = window.getStoreCollection('attendance');
                const attSnapshot = await getDocs(attendanceRef);
                attSnapshot.forEach(doc => {
                    const attData = doc.data();
                    const docId = doc.id;
                    let attEmployeeId, dateKey;
                    const dateMatchResult = docId.match(/^(.+?)_(\d{4}-\d{2}-\d{2})$/);
                    if (dateMatchResult) {
                        attEmployeeId = dateMatchResult[1];
                        dateKey = dateMatchResult[2];
                    }
                    else if (attData.employeeId && attData.date) {
                        attEmployeeId = attData.employeeId;
                        dateKey = attData.date;
                    }
                    if (attEmployeeId === employeeId && dateKey >= startDate && dateKey <= endDate) {
                        if (attData.checkIn && attData.checkOut) {
                            workDays++;
                            const checkIn = attData.checkIn.toDate ? attData.checkIn.toDate() : new Date(attData.checkIn);
                            const checkOut = attData.checkOut.toDate ? attData.checkOut.toDate() : new Date(attData.checkOut);
                            const breakMinutes = attData.breakTime || 0;
                            const workMilliseconds = checkOut - checkIn;
                            const workMinutes = Math.floor(workMilliseconds / (1000 * 60));
                            const netWorkMinutes = Math.max(0, workMinutes - breakMinutes);
                            const workHours = netWorkMinutes / 60;
                            totalWorkHours += workHours;
                            const hourlyRate = attData.hourlyRate || emp.hourlyRate || 0;
                            const dailyPay = Math.floor(workHours * hourlyRate);
                            const transportAllowance = attData.transportAllowance || emp.transportAllowance || 0;
                            totalTransport += transportAllowance;
                            employeeTotalCost += dailyPay + transportAllowance;
                        }
                    }
                });
                if (emp.salaryType === 'å›ºå®šçµ¦' && emp.monthlySalary) {
                    const monthsInPeriod = 12;
                    employeeTotalCost = emp.monthlySalary * monthsInPeriod;
                }
                laborCostByEmployee[emp.name] = employeeTotalCost;
                laborDetailByEmployee[emp.name] = {
                    totalCost: employeeTotalCost,
                    workDays: workDays,
                    workHours: totalWorkHours,
                    transport: totalTransport,
                    salaryType: emp.salaryType || 'æ™‚é–“çµ¦',
                    hourlyRate: emp.hourlyRate || 0,
                    monthlySalary: emp.monthlySalary || 0
                };
                totalLaborCost += employeeTotalCost;
            }
            // ==================== 4. åœ¨åº«ãƒ‡ãƒ¼ã‚¿ ====================
            const inventoryData = {};
            if (window.currentStoreId) {
                const inventoryRef = collection(window.db, 'stores', window.currentStoreId, 'inventory_settings');
                const inventorySnapshot = await getDocs(inventoryRef);
                inventorySnapshot.forEach(doc => {
                    inventoryData[doc.id] = doc.data();
                });
            }
            // ==================== CSVç”Ÿæˆ ====================
            const timestamp = new Date().toISOString().split('T')[0];
            // === 1. å£²ä¸Šã‚µãƒãƒªãƒ¼CSV ===
            let salesCSV = '\uFEFF';
            salesCSV += 'é …ç›®,é‡‘é¡\n';
            salesCSV += `å¯¾è±¡å¹´åº¦,${selectedYear}å¹´\n`;
            salesCSV += `æœŸé–“,${startDate}ã€œ${endDate}\n`;
            salesCSV += `ç·å£²ä¸Š,${totalSales}\n`;
            salesCSV += `ç¾é‡‘å£²ä¸Š,${totalCashSales}\n`;
            salesCSV += `ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰å£²ä¸Š,${totalCreditSales}\n`;
            salesCSV += `é›»å­ãƒãƒãƒ¼å£²ä¸Š,${totalEmoneSales}\n`;
            salesCSV += `ç·å®¢æ•°,${totalCustomerCount}\n`;
            salesCSV += `å¹³å‡å®¢å˜ä¾¡,${totalCustomerCount > 0 ? Math.round(totalSales / totalCustomerCount) : 0}\n`;
            salesCSV += `8%å¯¾è±¡ç¨é¡,${totalTax8}\n`;
            salesCSV += `10%å¯¾è±¡ç¨é¡,${totalTax10}\n`;
            salesCSV += `ç·ç¨é¡,${totalTax8 + totalTax10}\n`;
            const salesBlob = new Blob([salesCSV], { type: 'text/csv;charset=utf-8;' });
            const salesLink = document.createElement('a');
            salesLink.href = URL.createObjectURL(salesBlob);
            salesLink.download = `å£²ä¸Šã‚µãƒãƒªãƒ¼_${selectedYear}å¹´_${timestamp}.csv`;
            salesLink.click();
            // === 2. æ—¥æ¬¡å£²ä¸Šæ˜ç´°CSV ===
            let dailySalesDetailCSV = '\uFEFF';
            dailySalesDetailCSV += 'æ—¥ä»˜,ç·å£²ä¸Š,ç¾é‡‘å£²ä¸Š,ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆå£²ä¸Š,é›»å­ãƒãƒãƒ¼å£²ä¸Š,å®¢æ•°,8%ç¨é¡,10%ç¨é¡,å¹³å‡å®¢å˜ä¾¡\n';
            dailyDataArray.sort((a, b) => a.date.localeCompare(b.date));
            dailyDataArray.forEach(data => {
                const avgCustomerPrice = data.customerCount > 0 ? Math.round(data.totalSales / data.customerCount) : 0;
                dailySalesDetailCSV += `${data.date},${data.totalSales},${data.cashSales},${data.creditSales},${data.emoneSales},${data.customerCount},${data.tax8},${data.tax10},${avgCustomerPrice}\n`;
            });
            const dailySalesDetailBlob = new Blob([dailySalesDetailCSV], { type: 'text/csv;charset=utf-8;' });
            const dailySalesDetailLink = document.createElement('a');
            dailySalesDetailLink.href = URL.createObjectURL(dailySalesDetailBlob);
            dailySalesDetailLink.download = `æ—¥æ¬¡å£²ä¸Šæ˜ç´°_${selectedYear}å¹´_${timestamp}.csv`;
            dailySalesDetailLink.click();
            // === 3. å•†å“åˆ¥å£²ä¸ŠCSV ===
            let productSalesCSV = '\uFEFF';
            productSalesCSV += 'å•†å“å,è²©å£²æ•°é‡,å£²ä¸Šé‡‘é¡,å¹³å‡å˜ä¾¡\n';
            const sortedProducts = Object.entries(productSales).sort((a, b) => b[1].revenue - a[1].revenue);
            sortedProducts.forEach(([name, data]) => {
                const avgPrice = data.quantity > 0 ? Math.round(data.revenue / data.quantity) : 0;
                productSalesCSV += `${name},${data.quantity},${data.revenue},${avgPrice}\n`;
            });
            const productSalesBlob = new Blob([productSalesCSV], { type: 'text/csv;charset=utf-8;' });
            const productSalesLink = document.createElement('a');
            productSalesLink.href = URL.createObjectURL(productSalesBlob);
            productSalesLink.download = `å•†å“åˆ¥å£²ä¸Š_${selectedYear}å¹´_${timestamp}.csv`;
            productSalesLink.click();
            // === 4. äººä»¶è²»ã‚µãƒãƒªãƒ¼CSV ===
            let laborCSV = '\uFEFF';
            laborCSV += 'å¾“æ¥­å“¡å,çµ¦ä¸åŒºåˆ†,å‡ºå‹¤æ—¥æ•°,ç·å‹¤å‹™æ™‚é–“,çµ¦ä¸åˆè¨ˆ,äº¤é€šè²»åˆè¨ˆ,åˆè¨ˆæ”¯çµ¦é¡,æ™‚çµ¦,æœˆçµ¦\n';
            employees.forEach(emp => {
                const detail = laborDetailByEmployee[emp.name] || {};
                const cost = laborCostByEmployee[emp.name] || 0;
                const salaryAmount = cost - (detail.transport || 0);
                laborCSV += `${emp.name},${detail.salaryType || 'æ™‚é–“çµ¦'},${detail.workDays || 0},${(detail.workHours || 0).toFixed(1)},${salaryAmount},${detail.transport || 0},${cost},${detail.hourlyRate || 0},${detail.monthlySalary || 0}\n`;
            });
            laborCSV += `\nåˆè¨ˆ,,,,${totalLaborCost - Object.values(laborDetailByEmployee).reduce((sum, d) => sum + (d.transport || 0), 0)},${Object.values(laborDetailByEmployee).reduce((sum, d) => sum + (d.transport || 0), 0)},${totalLaborCost},,,\n`;
            const laborBlob = new Blob([laborCSV], { type: 'text/csv;charset=utf-8;' });
            const laborLink = document.createElement('a');
            laborLink.href = URL.createObjectURL(laborBlob);
            laborLink.download = `äººä»¶è²»ãƒ‡ãƒ¼ã‚¿_${selectedYear}å¹´_${timestamp}.csv`;
            laborLink.click();
            // === 5. å¾“æ¥­å“¡ãƒã‚¹ã‚¿CSVï¼ˆå¼¥ç”Ÿä¼šè¨ˆç”¨ï¼‰ ===
            let employeeCSV = '\uFEFF';
            employeeCSV += 'å¾“æ¥­å“¡ã‚³ãƒ¼ãƒ‰,å¾“æ¥­å“¡å,åŒºåˆ†,æ™‚çµ¦,æœˆçµ¦,äº¤é€šè²»,éƒ½é“åºœçœŒ,å¹´é½¢,å…¥ç¤¾æ—¥\n';
            employees.forEach(emp => {
                const empId = emp.id || '';
                const name = emp.name || '';
                const salaryType = emp.salaryType || 'æ™‚é–“çµ¦';
                const hourlyRate = emp.hourlyRate || 0;
                const monthlySalary = emp.monthlySalary || 0;
                const transport = emp.transportAllowance || 0;
                const prefecture = emp.prefecture || '';
                const age = emp.age || '';
                const hireDate = emp.hireDate || '';
                employeeCSV += `${empId},${name},${salaryType},${hourlyRate},${monthlySalary},${transport},${prefecture},${age},${hireDate}\n`;
            });
            const employeeBlob = new Blob([employeeCSV], { type: 'text/csv;charset=utf-8;' });
            const employeeLink = document.createElement('a');
            employeeLink.href = URL.createObjectURL(employeeBlob);
            employeeLink.download = `å¾“æ¥­å“¡ãƒã‚¹ã‚¿_${selectedYear}å¹´_${timestamp}.csv`;
            employeeLink.click();
            // === 6. å¼¥ç”Ÿä¼šè¨ˆå‘ã‘ä»•è¨³å¸³CSV ===
            let journalCSV = '\uFEFF';
            journalCSV += 'ä¼ç¥¨No,æ—¥ä»˜,å€Ÿæ–¹ç§‘ç›®,å€Ÿæ–¹è£œåŠ©,å€Ÿæ–¹é‡‘é¡,å€Ÿæ–¹ç¨åŒºåˆ†,è²¸æ–¹ç§‘ç›®,è²¸æ–¹è£œåŠ©,è²¸æ–¹é‡‘é¡,è²¸æ–¹ç¨åŒºåˆ†,æ‘˜è¦\n';
            let slipNo = 1;
            // å£²ä¸Šä»•è¨³ï¼ˆç¾é‡‘ï¼‰
            if (totalCashSales > 0) {
                journalCSV += `${slipNo++},${endDate},ç¾é‡‘,,${totalCashSales},èª²ç¨å£²ä¸Š10%,å£²ä¸Šé«˜,,${totalCashSales},èª²ç¨å£²ä¸Š10%,${selectedYear}å¹´åº¦ç¾é‡‘å£²ä¸Š\n`;
            }
            // å£²ä¸Šä»•è¨³ï¼ˆã‚«ãƒ¼ãƒ‰ãƒ»é›»å­ãƒãƒãƒ¼ï¼‰
            if (totalCreditSales > 0 || totalEmoneSales > 0) {
                journalCSV += `${slipNo++},${endDate},å£²æ›é‡‘,ã‚«ãƒ¼ãƒ‰ãƒ»é›»å­ãƒãƒãƒ¼,${totalCreditSales + totalEmoneSales},èª²ç¨å£²ä¸Š10%,å£²ä¸Šé«˜,,${totalCreditSales + totalEmoneSales},èª²ç¨å£²ä¸Š10%,${selectedYear}å¹´åº¦ã‚«ãƒ¼ãƒ‰ãƒ»é›»å­ãƒãƒãƒ¼å£²ä¸Š\n`;
            }
            // äººä»¶è²»ä»•è¨³
            if (totalLaborCost > 0) {
                journalCSV += `${slipNo++},${endDate},çµ¦æ–™æ‰‹å½“,,${totalLaborCost},å¯¾è±¡å¤–,æœªæ‰•é‡‘,çµ¦ä¸,${totalLaborCost},å¯¾è±¡å¤–,${selectedYear}å¹´åº¦äººä»¶è²»è¨ˆä¸Š\n`;
            }
            // æ¶ˆè²»ç¨ä»•è¨³
            const totalTaxAmount = totalTax8 + totalTax10;
            if (totalTaxAmount > 0) {
                journalCSV += `${slipNo++},${endDate},ä»®å—æ¶ˆè²»ç¨,,${totalTaxAmount},å¯¾è±¡å¤–,å£²ä¸Šé«˜,,${totalTaxAmount},å¯¾è±¡å¤–,${selectedYear}å¹´åº¦æ¶ˆè²»ç¨æŒ¯æ›¿\n`;
            }
            const journalBlob = new Blob([journalCSV], { type: 'text/csv;charset=utf-8;' });
            const journalLink = document.createElement('a');
            journalLink.href = URL.createObjectURL(journalBlob);
            journalLink.download = `ä»•è¨³å¸³_${selectedYear}å¹´_${timestamp}.csv`;
            journalLink.click();
            // === 7. åœ¨åº«ãƒ‡ãƒ¼ã‚¿CSV ===
            if (Object.keys(inventoryData).length > 0) {
                let inventoryCSV = '\uFEFF';
                inventoryCSV += 'å•†å“ID,å•†å“å,åœ¨åº«æ•°,è­¦å‘Šã—ãã„å€¤,å˜ä½\n';
                Object.entries(inventoryData).forEach(([id, data]) => {
                    const stock = data.stock !== undefined ? data.stock : '';
                    const threshold = data.alertThreshold !== undefined ? data.alertThreshold : '';
                    const unit = data.unit || '';
                    const name = data.name || id;
                    inventoryCSV += `${id},${name},${stock},${threshold},${unit}\n`;
                });
                const inventoryBlob = new Blob([inventoryCSV], { type: 'text/csv;charset=utf-8;' });
                const inventoryLink = document.createElement('a');
                inventoryLink.href = URL.createObjectURL(inventoryBlob);
                inventoryLink.download = `åœ¨åº«ãƒ‡ãƒ¼ã‚¿_${timestamp}.csv`;
                inventoryLink.click();
            }
            // å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            showCustomAlertFunc(`${selectedYear}å¹´åº¦ã®ãƒ‡ãƒ¼ã‚¿é€£æºCSVã‚’å‡ºåŠ›ã—ã¾ã—ãŸ\n\n` +
                `ğŸ“Š ç·å£²ä¸Š: Â¥${totalSales.toLocaleString()}\n` +
                `ğŸ’° ç·äººä»¶è²»: Â¥${totalLaborCost.toLocaleString()}\n` +
                `ğŸ“¦ è²©å£²å•†å“æ•°: ${Object.keys(productSales).length}ç¨®é¡\n` +
                `ğŸ‘¥ å¾“æ¥­å“¡æ•°: ${employees.length}å\n` +
                `ğŸ“… æœŸé–“: ${startDate} ï½ ${endDate}\n\n` +
                `ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ:\n` +
                `1. å£²ä¸Šã‚µãƒãƒªãƒ¼\n` +
                `2. æ—¥æ¬¡å£²ä¸Šæ˜ç´°\n` +
                `3. å•†å“åˆ¥å£²ä¸Š\n` +
                `4. äººä»¶è²»ãƒ‡ãƒ¼ã‚¿\n` +
                `5. å¾“æ¥­å“¡ãƒã‚¹ã‚¿\n` +
                `6. ä»•è¨³å¸³ï¼ˆå¼¥ç”Ÿä¼šè¨ˆç”¨ï¼‰\n` +
                `7. åœ¨åº«ãƒ‡ãƒ¼ã‚¿`, 'âœ… ãƒ‡ãƒ¼ã‚¿é€£æºCSVå‡ºåŠ›å®Œäº†', 'ğŸ“¥');
        }
        catch (e) {
            console.error('ãƒ‡ãƒ¼ã‚¿é€£æºCSVå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', e);
            showCustomAlertFunc('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + e.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    const addEmployee = async (name, hourlyRate, transportAllowance, salaryType, monthlySalary, prefecture, age, allowances, deductions, minimumWage, insuranceSwitches) => {
        setIsLoading(true);
        try {
            const { collection, addDoc, Timestamp } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ï¼ˆcurrentStoreId = nullï¼‰ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            let empRef;
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ä¸‹èµ¤å¡šåº—: æ—§ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’è¿½åŠ  (kintai_employees)');
                empRef = collection(window.db, 'kintai_employees');
            }
            else {
                console.log('ğŸ“ æ–°ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’è¿½åŠ : stores/' + window.currentStoreId + '/employees');
                empRef = collection(window.db, 'stores', window.currentStoreId, 'employees');
            }
            await addDoc(empRef, {
                name,
                hourlyRate: parseFloat(hourlyRate) || 0,
                transportAllowance: parseFloat(transportAllowance) || 0,
                salaryType: salaryType || 'æ™‚é–“çµ¦',
                monthlySalary: parseFloat(monthlySalary) || 0,
                prefecture: prefecture || 'æ±äº¬',
                age: parseInt(age) || 30,
                minimumWage: parseFloat(minimumWage) || 1000,
                insuranceSwitches: insuranceSwitches || {
                    healthInsurance: true,
                    pension: true,
                    residentTax: true
                },
                allowances: allowances || {
                    family: 0,
                    sales: 0,
                    position: 0,
                    commuting: 0,
                    expense: 0,
                    housing: 0
                },
                deductions: deductions || {
                    rent: 0,
                    utilities: 0
                },
                salaryHistory: [],
                createdAt: Timestamp.now()
            });
            await loadAllData();
            setShowAddEmployee(false);
        }
        catch (err) {
            console.error('å¾“æ¥­å“¡è¿½åŠ ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('å¾“æ¥­å“¡ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setIsLoading(false);
        }
    };
    const updateEmployee = async (id, name, hourlyRate, transportAllowance, salaryType, monthlySalary, prefecture, age, allowances, deductions, minimumWage, insuranceSwitches, salaryHistory) => {
        setIsLoading(true);
        try {
            const { doc, updateDoc, Timestamp } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ï¼ˆcurrentStoreId = nullï¼‰ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            let employeeRef;
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ä¸‹èµ¤å¡šåº—: æ—§ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’æ›´æ–° (kintai_employees/' + id + ')');
                employeeRef = doc(window.db, 'kintai_employees', id);
            }
            else {
                console.log('ğŸ“ æ–°ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’æ›´æ–°: stores/' + window.currentStoreId + '/employees/' + id);
                employeeRef = doc(window.db, `stores/${window.currentStoreId}/employees`, id);
            }
            await updateDoc(employeeRef, {
                name,
                hourlyRate: parseFloat(hourlyRate) || 0,
                transportAllowance: parseFloat(transportAllowance) || 0,
                salaryType: salaryType || 'æ™‚é–“çµ¦',
                monthlySalary: parseFloat(monthlySalary) || 0,
                prefecture: prefecture || 'æ±äº¬',
                age: parseInt(age) || 30,
                minimumWage: parseFloat(minimumWage) || 1000,
                insuranceSwitches: insuranceSwitches || {
                    healthInsurance: true,
                    pension: true,
                    residentTax: true
                },
                allowances: allowances || {
                    family: 0,
                    sales: 0,
                    position: 0,
                    commuting: 0,
                    expense: 0,
                    housing: 0
                },
                deductions: deductions || {
                    rent: 0,
                    utilities: 0
                },
                salaryHistory: salaryHistory || [],
                updatedAt: Timestamp.now()
            });
            await loadAllData();
            setEditingEmployee(null);
            // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ
            showCustomAlertFunc('å¾“æ¥­å“¡æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'âœ… æ›´æ–°å®Œäº†', 'âœ…');
        }
        catch (err) {
            console.error('å¾“æ¥­å“¡æ›´æ–°ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('å¾“æ¥­å“¡ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setIsLoading(false);
        }
    };
    // ç¤¾ä¼šä¿é™ºæ–™ãƒ»ç¨é‡‘è¨ˆç®—é–¢æ•°
    // â˜…é‡è¦ï¼šã“ã®é–¢æ•°ã«æ¸¡ã•ã‚Œã‚‹grossPayã«ã¯æ—¢ã«çµŒè²»ãŒå«ã¾ã‚Œã¦ã„ãªã„
    const calculateDeductions = (employee, grossPay) => {
        var _a, _b;
        if (!employee)
            return {
                healthInsurance: 0,
                pension: 0,
                employmentInsurance: 0,
                incomeTax: 0,
                residentTax: 0,
                rent: 0,
                utilities: 0,
                totalDeductions: 0
            };
        const prefecture = employee.prefecture || 'æ±äº¬';
        const age = employee.age || 30;
        const insuranceSwitches = employee.insuranceSwitches || {
            healthInsurance: true,
            pension: true,
            employmentInsurance: true,
            residentTax: true
        };
        // æ™‚é–“çµ¦ã®å ´åˆï¼š88,000å††æœªæº€ãªã‚‰ç¤¾ä¼šä¿é™ºæ–™ã¯0
        const salaryType = employee.salaryType || 'æ™‚é–“çµ¦';
        const shouldCalculateInsurance = salaryType === 'å›ºå®šçµ¦' || grossPay >= 88000;
        let healthInsurance = 0;
        let pension = 0;
        if (shouldCalculateInsurance) {
            // æ¨™æº–å ±é…¬æœˆé¡ã‚’æ±ºå®š
            let standardRemuneration = 58000;
            const monthlySalary = employee.monthlySalary || grossPay;
            for (const bracket of INSURANCE_DATA.standardMonthlyRemuneration) {
                if (monthlySalary >= bracket.min && monthlySalary < bracket.max) {
                    standardRemuneration = bracket.standard;
                    break;
                }
            }
            // å¥åº·ä¿é™ºæ–™è¨ˆç®—ï¼ˆã‚¹ã‚¤ãƒƒãƒONã®å ´åˆã®ã¿ï¼‰
            if (insuranceSwitches.healthInsurance) {
                const healthRate = INSURANCE_DATA.healthInsuranceRates[prefecture] || 0.1000;
                const nursingRate = age >= 40 ? INSURANCE_DATA.nursingCareRate : 0;
                const totalHealthRate = healthRate + nursingRate;
                healthInsurance = Math.floor(standardRemuneration * totalHealthRate / 2);
            }
            // åšç”Ÿå¹´é‡‘ä¿é™ºæ–™è¨ˆç®—ï¼ˆã‚¹ã‚¤ãƒƒãƒONã®å ´åˆã®ã¿ï¼‰
            if (insuranceSwitches.pension) {
                pension = Math.floor(standardRemuneration * INSURANCE_DATA.pensionRate / 2);
            }
        }
        // é›‡ç”¨ä¿é™ºæ–™è¨ˆç®—ï¼ˆç·æ”¯çµ¦é¡ã®0.55%ï¼‰ï¼ˆã‚¹ã‚¤ãƒƒãƒONã®å ´åˆã®ã¿ï¼‰
        let employmentInsurance = 0;
        if (insuranceSwitches.employmentInsurance) {
            employmentInsurance = Math.floor(grossPay * 0.0055);
        }
        // æ‰€å¾—ç¨è¨ˆç®—
        const socialInsuranceTotal = healthInsurance + pension + employmentInsurance;
        const taxableIncome = grossPay - socialInsuranceTotal - 88000;
        let incomeTax = 0;
        if (taxableIncome > 0) {
            const annualTaxableIncome = taxableIncome * 12;
            if (annualTaxableIncome <= 1950000) {
                incomeTax = Math.floor(annualTaxableIncome * 0.05 / 12);
            }
            else if (annualTaxableIncome <= 3300000) {
                incomeTax = Math.floor((annualTaxableIncome * 0.10 - 97500) / 12);
            }
            else if (annualTaxableIncome <= 6950000) {
                incomeTax = Math.floor((annualTaxableIncome * 0.20 - 427500) / 12);
            }
            else if (annualTaxableIncome <= 9000000) {
                incomeTax = Math.floor((annualTaxableIncome * 0.23 - 636000) / 12);
            }
            else if (annualTaxableIncome <= 18000000) {
                incomeTax = Math.floor((annualTaxableIncome * 0.33 - 1536000) / 12);
            }
            else if (annualTaxableIncome <= 40000000) {
                incomeTax = Math.floor((annualTaxableIncome * 0.40 - 2796000) / 12);
            }
            else {
                incomeTax = Math.floor((annualTaxableIncome * 0.45 - 4796000) / 12);
            }
        }
        // ğŸ†• ä½æ°‘ç¨ã¯å¤–éƒ¨è¨ˆç®—ï¼ˆkeisan-shousai-v6.htmlï¼‰ã‹ã‚‰ã®ã¿å–å¾—
        let residentTax = 0;
        if (insuranceSwitches.residentTax) {
            const salaryTypeKey = window.currentSalaryCalculationType || 'hourly';
            const key = `${employee.id}_${salaryTypeKey}`;
            // å¤–éƒ¨è¨ˆç®—ã•ã‚ŒãŸä½æ°‘ç¨ã®ã¿ã‚’ä½¿ç”¨ï¼ˆæ¦‚ç®—è¨ˆç®—ã¯å‰Šé™¤ï¼‰
            residentTax = calculatedResidentTaxes[key] || 0;
            if (residentTax > 0) {
                console.log(`âœ… ä½æ°‘ç¨ï¼ˆå¤–éƒ¨è¨ˆç®—ï¼‰: ${employee.name} (${salaryTypeKey}) = Â¥${residentTax}`);
            }
            else {
                console.log(`âš ï¸ ä½æ°‘ç¨æœªè¨ˆç®—: ${employee.name} (${salaryTypeKey}) â†’ Â¥0 (ã€Œä½æ°‘ç¨è¨ˆç®—ã€ãƒœã‚¿ãƒ³ã§è¨ˆç®—ã—ã¦ãã ã•ã„)`);
            }
        }
        // å®¶è³ƒãƒ»å…‰ç†±è²»ï¼ˆå¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—ï¼‰
        const rent = ((_a = employee.deductions) === null || _a === void 0 ? void 0 : _a.rent) || 0;
        const utilities = ((_b = employee.deductions) === null || _b === void 0 ? void 0 : _b.utilities) || 0;
        const totalDeductions = healthInsurance + pension + employmentInsurance + incomeTax + residentTax + rent + utilities;
        return {
            healthInsurance,
            pension,
            employmentInsurance,
            incomeTax,
            residentTax,
            rent,
            utilities,
            totalDeductions,
            socialInsuranceTotal
        };
    };
    // å¾“æ¥­å“¡ã®ä¸¦ã³é †ã‚’å¤‰æ›´
    const moveEmployee = async (index, direction) => {
        if (direction === 'up' && index === 0)
            return;
        if (direction === 'down' && index === employees.length - 1)
            return;
        const newIndex = direction === 'up' ? index - 1 : index + 1;
        const newEmployees = [...employees];
        const temp = newEmployees[index];
        newEmployees[index] = newEmployees[newIndex];
        newEmployees[newIndex] = temp;
        setEmployees(newEmployees);
        // Firestoreã«æ–°ã—ã„é †åºã‚’ä¿å­˜
        try {
            const { doc, updateDoc } = window.firebaseModules;
            for (let i = 0; i < newEmployees.length; i++) {
                // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ï¼ˆcurrentStoreId = nullï¼‰ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
                let empRef;
                if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                    empRef = doc(window.db, 'kintai_employees', newEmployees[i].id);
                }
                else {
                    empRef = doc(window.db, `stores/${window.currentStoreId}/employees`, newEmployees[i].id);
                }
                await updateDoc(empRef, {
                    sortOrder: i
                });
            }
            console.log('âœ… ä¸¦ã³é †ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }
        catch (err) {
            console.error('ä¸¦ã³é †ä¿å­˜ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('ä¸¦ã³é †ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    const deleteEmployee = async (id) => {
        const confirmed = await showCustomConfirmFunc('ã“ã®å¾“æ¥­å“¡ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?', 'ğŸ—‘ï¸ å¾“æ¥­å“¡å‰Šé™¤ã®ç¢ºèª', 'ğŸ—‘ï¸');
        if (!confirmed)
            return;
        setIsLoading(true);
        try {
            const { doc, deleteDoc } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ï¼ˆcurrentStoreId = nullï¼‰ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            let employeeRef;
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ä¸‹èµ¤å¡šåº—: æ—§ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’å‰Šé™¤ (kintai_employees/' + id + ')');
                employeeRef = doc(window.db, 'kintai_employees', id);
            }
            else {
                console.log('ğŸ“ æ–°ãƒ‘ã‚¹ã§å¾“æ¥­å“¡ã‚’å‰Šé™¤: stores/' + window.currentStoreId + '/employees/' + id);
                employeeRef = doc(window.db, 'stores', window.currentStoreId, 'employees', id);
            }
            await deleteDoc(employeeRef);
            await loadAllData();
        }
        catch (err) {
            console.error('å¾“æ¥­å“¡å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('å¾“æ¥­å“¡ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setIsLoading(false);
        }
    };
    const startEditingTime = (employeeId, dateKey, field, currentValue) => {
        var _a;
        setEditingTime({ employeeId, dateKey, field });
        setEditingValue(currentValue || '');
        setEditingMemo('');
        // æ—¢å­˜ã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ä¼‘æ—¥ãƒ•ãƒ©ã‚°ã¨æ™‚çµ¦ã‚’èª­ã¿è¾¼ã‚€
        const dayData = (_a = attendanceData[employeeId]) === null || _a === void 0 ? void 0 : _a[dateKey];
        setEditingIsHoliday((dayData === null || dayData === void 0 ? void 0 : dayData.isHoliday) || false);
        // å¾“æ¥­å“¡ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ™‚çµ¦ã‚’å–å¾—
        const employee = employees.find(e => e.id === employeeId);
        setEditingHourlyRate((dayData === null || dayData === void 0 ? void 0 : dayData.hourlyRate) || (employee === null || employee === void 0 ? void 0 : employee.hourlyRate) || '');
    };
    const saveEditedTime = async () => {
        if (!editingTime)
            return;
        const { employeeId, dateKey, field } = editingTime;
        const timeRegex = /^([0-1]?[0-9]|2[0-3]):([0-5][0-9])$/;
        if (editingValue && !timeRegex.test(editingValue)) {
            showCustomAlertFunc('æ™‚åˆ»ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“(HH:MMå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„)', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
            return;
        }
        setIsLoading(true);
        try {
            const { doc, getDoc, setDoc, updateDoc, Timestamp } = window.firebaseModules;
            // ğŸ”§ ä¿®æ­£: ä¸‹èµ¤å¡šåº—ã®å ´åˆã¯æ—§ãƒ‘ã‚¹ã‚’ä½¿ç”¨
            let docRef;
            if (!window.currentStoreId || window.currentStoreId === null || window.currentStoreId === '') {
                console.log('ğŸ“ ä¸‹èµ¤å¡šåº—: æ—§ãƒ‘ã‚¹ã§å‹¤æ€ ã‚’ä¿å­˜ (kintai_attendance)');
                // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID: {employeeId}_{dateKey}
                docRef = doc(window.db, 'kintai_attendance', `${employeeId}_${dateKey}`);
            }
            else {
                console.log('ğŸ“ æ–°ãƒ‘ã‚¹ã§å‹¤æ€ ã‚’ä¿å­˜: stores/' + window.currentStoreId + '/attendance');
                // ğŸ”§ ä¿®æ­£: kintai.htmlã¨åŒã˜å½¢å¼ ({employeeId}_{dateKey}) ã§ä¿å­˜
                docRef = doc(window.db, 'stores', window.currentStoreId, 'attendance', `${employeeId}_${dateKey}`);
            }
            const docSnap = await getDoc(docRef);
            const employee = employees.find(e => e.id === employeeId);
            let employeeData;
            // ğŸ”§ ä¿®æ­£: æ—§ãƒ‘ã‚¹ã¨æ–°ãƒ‘ã‚¹ã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒåŒã˜ï¼ˆ1ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ=1å¾“æ¥­å“¡ï¼‰
            if (docSnap.exists()) {
                employeeData = docSnap.data();
            }
            else {
                employeeData = {
                    employeeId: employeeId,
                    employeeName: (employee === null || employee === void 0 ? void 0 : employee.name) || '',
                    date: dateKey,
                    clockIn: null,
                    breakStart1: null,
                    breakEnd1: null,
                    breakStart2: null,
                    breakEnd2: null,
                    clockOut: null,
                    isHoliday: false,
                    hourlyRate: (employee === null || employee === void 0 ? void 0 : employee.hourlyRate) || 0,
                    editHistory: [],
                    createdAt: Timestamp.now(),
                    updatedAt: Timestamp.now()
                };
            }
            const oldValue = employeeData[field];
            employeeData[field] = editingValue || null;
            employeeData.isHoliday = editingIsHoliday;
            employeeData.hourlyRate = parseFloat(editingHourlyRate) || (employee === null || employee === void 0 ? void 0 : employee.hourlyRate) || 0;
            if (!employeeData.editHistory) {
                employeeData.editHistory = [];
            }
            employeeData.editHistory.push({
                field,
                oldValue,
                newValue: editingValue || null,
                isHoliday: editingIsHoliday,
                hourlyRate: employeeData.hourlyRate,
                memo: editingMemo || '',
                timestamp: new Date().toISOString(),
                editor: 'ç®¡ç†è€…'
            });
            // ğŸ”§ ä¿®æ­£: æ—§ãƒ‘ã‚¹ã¨æ–°ãƒ‘ã‚¹ã§åŒã˜æ§‹é€ ï¼ˆ1ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ=1å¾“æ¥­å“¡ï¼‰
            employeeData.updatedAt = Timestamp.now();
            await setDoc(docRef, employeeData);
            await loadAllData();
            showCustomAlertFunc('æ™‚åˆ»ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'âœ… ä¿å­˜å®Œäº†', 'âœ…');
            setEditingTime(null);
            setEditingValue('');
            setEditingMemo('');
            setEditingIsHoliday(false);
            setEditingHourlyRate('');
        }
        catch (err) {
            console.error('æ™‚åˆ»ä¿å­˜ã‚¨ãƒ©ãƒ¼:', err);
            showCustomAlertFunc('æ™‚åˆ»ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message, 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
        finally {
            setIsLoading(false);
        }
    };
    const cancelEditingTime = () => {
        setEditingTime(null);
        setEditingValue('');
        setEditingMemo('');
        setEditingIsHoliday(false);
        setEditingHourlyRate('');
    };
    const exportToPNG = async (employeeId) => {
        const employee = employees.find(e => e.id === employeeId);
        if (!employee)
            return;
        const totals = calculateMonthlyTotals(employeeId);
        const daysInMonth = getDaysInMonth(currentMonth, currentYear);
        const prefecture = employee.prefecture || 'æ±äº¬';
        const minimumWage = employee.minimumWage || INSURANCE_DATA.minimumWage[prefecture] || 1000;
        // ç´¯è¨ˆå·®ç•°ã‚’å–å¾—ï¼ˆå›ºå®šçµ¦ã®å ´åˆã®ã¿ï¼‰
        let cumulativeData = { totalGrossDifference: 0, totalNetDifference: 0, months: [] };
        if (employee.salaryType === 'å›ºå®šçµ¦' && employee.monthlySalary > 0) {
            cumulativeData = await calculateCumulativeDifference(employeeId);
        }
        // ä¸€æ™‚çš„ãªHTMLãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
        const tempDiv = document.createElement('div');
        tempDiv.style.position = 'absolute';
        tempDiv.style.left = '-9999px';
        tempDiv.style.background = 'white';
        tempDiv.style.padding = '30px';
        tempDiv.style.width = '740px'; // A4å¹…ï¼ˆ210mm - ä½™ç™½ï¼‰â‰ˆ 740px
        tempDiv.style.fontFamily = 'Arial, sans-serif';
        tempDiv.style.fontSize = '11px'; // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å°‘ã—å°ã•ã
        const isFixed = employee.salaryType === 'å›ºå®šçµ¦' && employee.monthlySalary > 0;
        let tableHTML = `
                    <div style="font-family: Arial, sans-serif; font-size: 13px;">
                        <h2 style="text-align: center; font-size: 26px; margin-bottom: 15px; border-bottom: 4px solid #000; padding-bottom: 10px;">çµ¦ä¸æ˜ç´°æ›¸</h2>
                        <div style="text-align: center; font-size: 18px; margin-bottom: 25px; font-weight: bold;">${currentYear}å¹´${currentMonth + 1}æœˆåˆ†</div>
                        
                        <!-- åŸºæœ¬æƒ…å ± -->
                        <table style="width: 100%; margin-bottom: 20px; border-collapse: collapse;">
                            <tr>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold; width: 120px;">æ°å</td>
                                <td style="border: 2px solid #000; padding: 8px;">${employee.name}</td>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold; width: 120px;">éƒ½é“åºœçœŒ</td>
                                <td style="border: 2px solid #000; padding: 8px;">${prefecture}</td>
                            </tr>
                            <tr>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">çµ¦ä¸ã‚¿ã‚¤ãƒ—</td>
                                <td style="border: 2px solid #000; padding: 8px;">${employee.salaryType || 'æ™‚é–“çµ¦'}</td>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">æœ€ä½è³ƒé‡‘</td>
                                <td style="border: 2px solid #000; padding: 8px;">Â¥${minimumWage.toLocaleString()}/æ™‚</td>
                            </tr>
                            <tr>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">æ™‚çµ¦</td>
                                <td style="border: 2px solid #000; padding: 8px;">Â¥${employee.hourlyRate.toLocaleString()}</td>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">æ—¥é¡äº¤é€šè²»</td>
                                <td style="border: 2px solid #000; padding: 8px;">Â¥${employee.transportAllowance.toLocaleString()}</td>
                            </tr>`;
        if (isFixed) {
            tableHTML += `
                            <tr>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">å›ºå®šçµ¦(æœˆé¡)</td>
                                <td style="border: 2px solid #000; padding: 8px; font-weight: bold; color: #0066cc;">Â¥${employee.monthlySalary.toLocaleString()}</td>
                                <td style="border: 2px solid #000; padding: 8px; background: #e0e0e0; font-weight: bold;">æ—¥é¡(å›ºå®šçµ¦Ã·å‡ºå‹¤æ—¥æ•°)</td>
                                <td style="border: 2px solid #000; padding: 8px;">Â¥${totals.workDays > 0 ? Math.round(employee.monthlySalary / totals.workDays).toLocaleString() : '0'}</td>
                            </tr>`;
        }
        tableHTML += `
                        </table>
                        
                        <!-- æ”¯çµ¦ -->
                        <h3 style="font-size: 16px; margin: 20px 0 10px 0; padding: 5px 10px; background: #4CAF50; color: white; border-radius: 3px;">ã€æ”¯çµ¦ã€‘</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                            <thead>
                                <tr style="background: #333; color: white;">
                                    <th style="border: 2px solid #000; padding: 8px; text-align: left;">é …ç›®</th>
                                    <th style="border: 2px solid #000; padding: 8px; text-align: right; width: 150px;">æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹</th>
                                    ${isFixed ? '<th style="border: 2px solid #000; padding: 8px; text-align: right; width: 150px;">å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹</th>' : ''}
                                </tr>
                            </thead>
                            <tbody>`;
        if (isFixed) {
            tableHTML += `
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">åŸºæœ¬çµ¦</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.basePay + totals.overtimePay + totals.holidayPay).toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.fixedSalary.toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ã€€â”” é€šå¸¸(${totals.hours.toFixed(1)}h)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.basePay).toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right; background: #f5f5f5;">-</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ã€€â”” æ™‚é–“å¤–(25%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.overtimePay).toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right; background: #f5f5f5;">-</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ã€€â”” ä¼‘æ—¥(35%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.holidayPay).toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right; background: #f5f5f5;">-</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ã€€â”” æ·±å¤œ(25%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.lateNightPay).toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right; background: #f5f5f5;">-</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">é€šå‹¤è²»(${totals.workDays}æ—¥)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.transport.toLocaleString()}</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right; background: #f5f5f5;">-</td>
                                </tr>`;
        }
        else {
            tableHTML += `
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">åŸºæœ¬çµ¦(${totals.hours.toFixed(1)}h)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.basePay).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">æ™‚é–“å¤–æ‰‹å½“(25%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.overtimePay).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ä¼‘æ—¥å‡ºå‹¤æ‰‹å½“(35%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.holidayPay).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">æ·±å¤œæ‰‹å½“(25%)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${Math.round(totals.lateNightPay).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">é€šå‹¤è²»(${totals.workDays}æ—¥)</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.transport.toLocaleString()}</td>
                                </tr>`;
        }
        // æ‰‹å½“
        if (totals.totalAllowances > 0) {
            if (totals.allowances.family > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">å®¶æ—æ‰‹å½“</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.family.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.family.toLocaleString() + '</td>' : ''}</tr>`;
            }
            if (totals.allowances.sales > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">å–¶æ¥­æ‰‹å½“</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.sales.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.sales.toLocaleString() + '</td>' : ''}</tr>`;
            }
            if (totals.allowances.position > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">å½¹è·æ‰‹å½“</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.position.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.position.toLocaleString() + '</td>' : ''}</tr>`;
            }
            if (totals.allowances.commuting > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">é€šå‹¤æ‰‹å½“</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.commuting.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.commuting.toLocaleString() + '</td>' : ''}</tr>`;
            }
            if (totals.allowances.expense > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">çµŒè²»</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.expense.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.expense.toLocaleString() + '</td>' : ''}</tr>`;
            }
            if (totals.allowances.housing > 0) {
                tableHTML += `<tr><td style="border: 2px solid #000; padding: 6px;">å®¶è³ƒè£œåŠ©</td><td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${totals.allowances.housing.toLocaleString()}</td>${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + totals.allowances.housing.toLocaleString() + '</td>' : ''}</tr>`;
            }
        }
        tableHTML += `
                                <tr style="background: #d4edda; font-weight: bold;">
                                    <td style="border: 2px solid #000; padding: 8px;">ç·æ”¯çµ¦é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-size: 15px;">Â¥${Math.round(totals.hourlyTotalGross).toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 8px; text-align: right; font-size: 15px;">Â¥' + Math.round(totals.fixedTotalGross).toLocaleString() + '</td>' : ''}
                                </tr>
                            </tbody>
                        </table>
                        
                        <!-- æ§é™¤ -->
                        <h3 style="font-size: 16px; margin: 20px 0 10px 0; padding: 5px 10px; background: #f44336; color: white; border-radius: 3px;">ã€æ§é™¤ã€‘</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                            <thead>
                                <tr style="background: #333; color: white;">
                                    <th style="border: 2px solid #000; padding: 8px; text-align: left;">é …ç›®</th>
                                    <th style="border: 2px solid #000; padding: 8px; text-align: right; width: 150px;">æ™‚é–“çµ¦ãƒ™ãƒ¼ã‚¹</th>
                                    ${isFixed ? '<th style="border: 2px solid #000; padding: 8px; text-align: right; width: 150px;">å›ºå®šçµ¦ãƒ™ãƒ¼ã‚¹</th>' : ''}
                                </tr>
                            </thead>
                            <tbody>`;
        const hourlyDed = totals.hourlyDeductions;
        const fixedDed = isFixed ? totals.fixedDeductions : {};
        tableHTML += `
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">å¥åº·ä¿é™º</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.healthInsurance.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.healthInsurance.toLocaleString() + '</td>' : ''}
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">åšç”Ÿå¹´é‡‘</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.pension.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.pension.toLocaleString() + '</td>' : ''}
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">é›‡ç”¨ä¿é™º</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.employmentInsurance.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.employmentInsurance.toLocaleString() + '</td>' : ''}
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">æ‰€å¾—ç¨</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.incomeTax.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.incomeTax.toLocaleString() + '</td>' : ''}
                                </tr>
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">ä½æ°‘ç¨</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.residentTax.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.residentTax.toLocaleString() + '</td>' : ''}
                                </tr>`;
        if (hourlyDed.rent > 0) {
            tableHTML += `
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">å®¶è³ƒ</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.rent.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.rent.toLocaleString() + '</td>' : ''}
                                </tr>`;
        }
        if (hourlyDed.utilities > 0) {
            tableHTML += `
                                <tr>
                                    <td style="border: 2px solid #000; padding: 6px;">å…‰ç†±è²»</td>
                                    <td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥${hourlyDed.utilities.toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 6px; text-align: right;">Â¥' + fixedDed.utilities.toLocaleString() + '</td>' : ''}
                                </tr>`;
        }
        tableHTML += `
                                <tr style="background: #f8d7da; font-weight: bold;">
                                    <td style="border: 2px solid #000; padding: 8px;">ç·æ§é™¤é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-size: 15px;">Â¥${Math.round(hourlyDed.totalDeductions).toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 8px; text-align: right; font-size: 15px;">Â¥' + Math.round(fixedDed.totalDeductions).toLocaleString() + '</td>' : ''}
                                </tr>
                            </tbody>
                        </table>
                        
                        <!-- æ§é™¤é¡ã®è¨ˆç®—èª¬æ˜ -->
                        <div style="background: #fff3cd; padding: 10px; margin-bottom: 20px; border: 1px solid #ffc107; border-radius: 3px;">
                            <div style="font-size: 12px; font-weight: bold; margin-bottom: 5px;">ã€æ§é™¤é¡ã®è¨ˆç®—æ–¹æ³•ã€‘</div>
                            <div style="font-size: 10px; line-height: 1.6;">
                                â€¢ <strong>å¥åº·ä¿é™º</strong>: æ¨™æº–å ±é…¬æœˆé¡ Ã— ä¿é™ºæ–™ç‡ Ã· 2ï¼ˆ40æ­³ä»¥ä¸Šã¯ä»‹è­·ä¿é™ºæ–™ã‚’å«ã‚€ï¼‰<br/>
                                â€¢ <strong>åšç”Ÿå¹´é‡‘</strong>: æ¨™æº–å ±é…¬æœˆé¡ Ã— 18.3% Ã· 2<br/>
                                â€¢ <strong>é›‡ç”¨ä¿é™º</strong>: ç·æ”¯çµ¦é¡ï¼ˆçµŒè²»é™¤ãï¼‰ Ã— 0.55%<br/>
                                â€¢ <strong>æ‰€å¾—ç¨</strong>: (ç·æ”¯çµ¦é¡ - ç¤¾ä¼šä¿é™ºæ–™ - çµ¦ä¸æ‰€å¾—æ§é™¤) ã«å¯¾ã™ã‚‹ç´¯é€²èª²ç¨<br/>
                                â€¢ <strong>ä½æ°‘ç¨</strong>: èª²ç¨æ‰€å¾— Ã— 10%ï¼ˆæ¦‚ç®—ï¼‰<br/>
                                â€»æ™‚é–“çµ¦ã®å ´åˆã€88,000å††æœªæº€ã¯å¥åº·ä¿é™ºãƒ»åšç”Ÿå¹´é‡‘ãŒå…é™¤ã•ã‚Œã¾ã™
                            </div>
                        </div>
                        
                        <!-- çµ¦ä¸æ‰€å¾—æ§é™¤ã®èª¬æ˜ -->
                        <div style="background: #e7f3ff; padding: 10px; margin-bottom: 20px; border: 1px solid #2196F3; border-radius: 3px;">
                            <div style="font-size: 12px; font-weight: bold; margin-bottom: 5px; color: #1976D2;">ğŸ“˜ çµ¦ä¸æ‰€å¾—æ§é™¤ã¨ã¯</div>
                            <div style="font-size: 10px; line-height: 1.6;">
                                çµ¦ä¸æ‰€å¾—è€…ã«èªã‚ã‚‰ã‚Œã‚‹ã€Œã¿ãªã—çµŒè²»ã€ã§ã™ã€‚çµ¦ä¸åå…¥ã«å¿œã˜ã¦è‡ªå‹•çš„ã«ä¸€å®šé¡ãŒæ§é™¤ã•ã‚Œã¾ã™ã€‚<br/>
                                <strong>ã€æ§é™¤é¡ã®ç›®å®‰ã€‘</strong><br/>
                                â€¢ å¹´å162.5ä¸‡å††ä»¥ä¸‹: 55ä¸‡å††ï¼ˆæœˆé¡ç´„46,000å††ï¼‰<br/>
                                â€¢ å¹´å180ä¸‡å††: 62ä¸‡å††ï¼ˆæœˆé¡ç´„52,000å††ï¼‰<br/>
                                â€¢ å¹´å360ä¸‡å††: 116ä¸‡å††ï¼ˆæœˆé¡ç´„97,000å††ï¼‰<br/>
                                â€¢ å¹´å660ä¸‡å††: 176ä¸‡å††ï¼ˆæœˆé¡ç´„147,000å††ï¼‰<br/>
                                â€¢ å¹´å850ä¸‡å††è¶…: 195ä¸‡å††ï¼ˆæœˆé¡ç´„163,000å††ãƒ»ä¸Šé™ï¼‰<br/>
                                â€»ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯æœˆé¡88,000å††ã‚’æ¨™æº–ã¨ã—ã¦è¨ˆç®—ã—ã¦ã„ã¾ã™
                            </div>
                        </div>
                        
                        <!-- æ”¯çµ¦é¡ -->
                        <h3 style="font-size: 16px; margin: 20px 0 10px 0; padding: 5px 10px; background: #2196F3; color: white; border-radius: 3px;">ã€æ”¯çµ¦é¡ã€‘</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                            <tbody>
                                <tr style="background: #cce5ff; font-weight: bold; font-size: 16px;">
                                    <td style="border: 2px solid #000; padding: 10px;">å·®å¼•æ”¯çµ¦é¡</td>
                                    <td style="border: 2px solid #000; padding: 10px; text-align: right; width: 150px; color: #0066cc;">Â¥${Math.round(totals.hourlyNetPay).toLocaleString()}</td>
                                    ${isFixed ? '<td style="border: 2px solid #000; padding: 10px; text-align: right; width: 150px; color: #0066cc;">Â¥' + Math.round(totals.fixedNetPay).toLocaleString() + '</td>' : ''}
                                </tr>
                            </tbody>
                        </table>`;
        // å›ºå®šçµ¦ã®å ´åˆã®å·®é¡è¡¨ç¤º
        if (isFixed) {
            tableHTML += `
                        <!-- å·®é¡ -->
                        <h3 style="font-size: 16px; margin: 20px 0 10px 0; padding: 5px 10px; background: #FF9800; color: white; border-radius: 3px;">ã€ä»Šæœˆã®å·®é¡ï¼ˆæœ€ä½è³ƒé‡‘æ›ç®—ï¼‰ã€‘</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;">
                            <tbody>
                                <tr style="background: #fff3cd;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">æ§é™¤å‰å·®é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; color: #ff6600;">
                                        Â¥${Math.round(totals.displayGrossDifference).toLocaleString()}
                                    </td>
                                </tr>
                                <tr style="background: #fff3cd;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">æ§é™¤å¾Œå·®é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; color: #ff6600;">
                                        Â¥${Math.round(totals.displayNetDifference).toLocaleString()}
                                    </td>
                                </tr>
                                <tr style="background: #e3f2fd;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">ç´ç¨é¡ï¼ˆå·®é¡åˆ†ï¼‰</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; color: #2196F3;">
                                        Â¥${Math.round(totals.displayGrossDifference - totals.displayNetDifference).toLocaleString()}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="font-size: 11px; color: #666; margin-bottom: 20px;">
                            â€»æœ€ä½è³ƒé‡‘ã§è¨ˆç®—ã—ãŸæ™‚é–“çµ¦ã¨å›ºå®šçµ¦ã®å·®é¡ã§ã™ã€‚ãƒ—ãƒ©ã‚¹ã®å ´åˆã€ä¼šç¤¾ã«è«‹æ±‚å¯èƒ½ãªé‡‘é¡ã§ã™ã€‚
                        </div>`;
            if (cumulativeData.months.length > 1) {
                tableHTML += `
                        <h3 style="font-size: 16px; margin: 20px 0 10px 0; padding: 5px 10px; background: #9C27B0; color: white; border-radius: 3px;">ã€ç´¯è¨ˆå·®é¡ï¼ˆå…¨${cumulativeData.months.length}ãƒ¶æœˆï¼‰ã€‘</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tbody>
                                <tr style="background: #f3e5f5;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">æ§é™¤å‰ç´¯è¨ˆå·®é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 16px; color: #ff3300;">
                                        Â¥${Math.round(cumulativeData.displayTotalGrossDifference).toLocaleString()}
                                    </td>
                                </tr>
                                <tr style="background: #f3e5f5;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">æ§é™¤å¾Œç´¯è¨ˆå·®é¡</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 16px; color: #ff3300;">
                                        Â¥${Math.round(cumulativeData.displayTotalNetDifference).toLocaleString()}
                                    </td>
                                </tr>
                                <tr style="background: #e3f2fd;">
                                    <td style="border: 2px solid #000; padding: 8px; font-weight: bold;">ç´¯è¨ˆç´ç¨é¡ï¼ˆå·®é¡åˆ†ï¼‰</td>
                                    <td style="border: 2px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 16px; color: #2196F3;">
                                        Â¥${Math.round(cumulativeData.displayTotalGrossDifference - cumulativeData.displayTotalNetDifference).toLocaleString()}
                                    </td>
                                </tr>
                            </tbody>
                        </table>`;
            }
        }
        tableHTML += `
                        <div style="text-align: center; margin-top: 25px; padding-top: 15px; border-top: 2px solid #333; font-size: 11px; color: #666;">
                            å‡ºå‹¤æ—¥æ•°: ${totals.workDays}æ—¥ | åˆè¨ˆåŠ´åƒæ™‚é–“: ${totals.hours.toFixed(1)}æ™‚é–“
                        </div>
                    </div>
                `;
        tempDiv.innerHTML = tableHTML;
        document.body.appendChild(tempDiv);
        try {
            const canvas = await html2canvas(tempDiv, {
                scale: 2.5, // A4ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦é«˜è§£åƒåº¦åŒ–
                backgroundColor: '#ffffff',
                logging: false,
                width: 740,
                windowWidth: 740
            });
            document.body.removeChild(tempDiv);
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `çµ¦ä¸æ˜ç´°_${employee.name}_${currentYear}å¹´${currentMonth + 1}æœˆ.png`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }
        catch (error) {
            console.error('PNGå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', error);
            if (document.body.contains(tempDiv)) {
                document.body.removeChild(tempDiv);
            }
            showCustomAlertFunc('PNGå‡ºåŠ›ã«å¤±æ•—ã—ã¾ã—ãŸ', 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // å‹¤æ€ è©³ç´°ã®PNGå‡ºåŠ›
    const exportAttendanceDetailToPNG = async (employeeId) => {
        var _a;
        const employee = employees.find(e => e.id === employeeId);
        if (!employee)
            return;
        try {
            const daysInMonth = getDaysInMonth(currentMonth, currentYear);
            const allDays = [];
            // æ›œæ—¥å–å¾—é–¢æ•°
            const getDayOfWeek = (year, month, day) => {
                const date = new Date(year, month, day);
                const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
                return days[date.getDay()];
            };
            // å…¨ã¦ã®æ—¥ã‚’å–å¾—ï¼ˆå‡ºå‹¤ã—ã¦ã„ãªã„æ—¥ã‚‚å«ã‚€ï¼‰
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const record = (_a = attendanceData[employeeId]) === null || _a === void 0 ? void 0 : _a[dateKey];
                const dayOfWeek = getDayOfWeek(currentYear, currentMonth, day);
                let workHours = 0;
                let dailyPay = { total: 0, base: 0, overtime: 0, holiday: 0, lateNight: 0, overtimeHours: 0, lateNightHours: 0 };
                if (record && record.clockIn) {
                    workHours = calculateWorkHours(record);
                    dailyPay = calculateDailyPay(employee, record);
                }
                allDays.push({ day, dayOfWeek, record, workHours, dailyPay });
            }
            // ä¸€æ™‚çš„ãªHTMLãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
            const tempDiv = document.createElement('div');
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            tempDiv.style.background = 'white';
            tempDiv.style.padding = '30px';
            tempDiv.style.width = '1200px';
            tempDiv.style.fontFamily = 'Arial, sans-serif';
            let tableHTML = `
                        <div style="text-align: center; margin-bottom: 20px;">
                            <h1 style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">å‹¤æ€ è©³ç´°</h1>
                            <div style="font-size: 14px; color: #666;">${employee.name} - ${currentYear}å¹´${currentMonth + 1}æœˆ</div>
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 11px;">
                            <thead style="background: #f3f4f6;">
                                <tr>
                                    <th style="border: 2px solid #000; padding: 8px;">æ—¥ä»˜</th>
                                    <th style="border: 2px solid #000; padding: 8px;">å‡ºå‹¤</th>
                                    <th style="border: 2px solid #000; padding: 8px;">ä¼‘æ†©å…¥1</th>
                                    <th style="border: 2px solid #000; padding: 8px;">ä¼‘æ†©å‡º1</th>
                                    <th style="border: 2px solid #000; padding: 8px;">ä¼‘æ†©å…¥2</th>
                                    <th style="border: 2px solid #000; padding: 8px;">ä¼‘æ†©å‡º2</th>
                                    <th style="border: 2px solid #000; padding: 8px;">é€€å‹¤</th>
                                    <th style="border: 2px solid #000; padding: 8px;">åŠ´åƒæ™‚é–“</th>
                                    <th style="border: 2px solid #000; padding: 8px;">æ—¥çµ¦</th>
                                    <th style="border: 2px solid #000; padding: 8px;">å‚™è€ƒ</th>
                                </tr>
                            </thead>
                            <tbody>`;
            allDays.forEach(({ day, dayOfWeek, record, workHours, dailyPay }) => {
                const memo = (record === null || record === void 0 ? void 0 : record.editHistory) && record.editHistory.length > 0
                    ? record.editHistory[record.editHistory.length - 1].memo || ''
                    : '';
                let remarkText = '';
                if (record === null || record === void 0 ? void 0 : record.isHoliday)
                    remarkText += 'ä¼‘æ—¥å‡ºå‹¤(35%)<br/>';
                if (dailyPay.overtimeHours > 0)
                    remarkText += `è¶…éåˆ†${dailyPay.overtimeHours.toFixed(2)}æ™‚é–“(25%)<br/>`;
                if (dailyPay.lateNightHours > 0)
                    remarkText += `æ·±å¤œè³ƒé‡‘${dailyPay.lateNightHours.toFixed(2)}æ™‚é–“(25%)<br/>`;
                if (memo)
                    remarkText += memo;
                // å‡ºå‹¤ã—ã¦ã„ãªã„æ—¥ã®èƒŒæ™¯è‰²
                const notWorkingBg = (!record || !record.clockIn) ? '#f5f5f5' : '';
                tableHTML += `
                            <tr>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: #f9fafb;">${day}æ—¥(${dayOfWeek})</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.clockIn) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.breakStart1) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.breakEnd1) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.breakStart2) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.breakEnd2) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: ${notWorkingBg};">${(record === null || record === void 0 ? void 0 : record.clockOut) || '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: center; background: #f9fafb;">${workHours > 0 ? workHours.toFixed(2) + 'h' : '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: right; background: #f9fafb;">${dailyPay.total > 0 ? 'Â¥' + Math.round(dailyPay.total).toLocaleString() : '-'}</td>
                                <td style="border: 2px solid #000; padding: 8px; text-align: left; font-size: 9px; background: #f9fafb; line-height: 1.4;">${remarkText || '-'}</td>
                            </tr>`;
            });
            tableHTML += `
                            </tbody>
                        </table>`;
            tempDiv.innerHTML = tableHTML;
            document.body.appendChild(tempDiv);
            const canvas = await html2canvas(tempDiv, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false
            });
            document.body.removeChild(tempDiv);
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `å‹¤æ€ è©³ç´°_${employee.name}_${currentYear}å¹´${currentMonth + 1}æœˆ.png`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }
        catch (error) {
            console.error('PNGå‡ºåŠ›ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('PNGå‡ºåŠ›ã«å¤±æ•—ã—ã¾ã—ãŸ', 'âŒ ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆUI
    const CustomAlert = () => showCustomAlert && (React.createElement("div", { style: {
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: 'rgba(0,0,0,0.7)',
            backdropFilter: 'blur(8px)',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            zIndex: 10000,
            animation: 'fadeIn 0.3s ease-out',
            overflowY: 'auto',
            padding: '20px'
        }, onClick: () => setShowCustomAlert(false) },
        React.createElement("style", null, `
                        @keyframes fadeIn {
                            from { opacity: 0; }
                            to { opacity: 1; }
                        }
                        @keyframes slideUp {
                            from { 
                                transform: translateY(30px) scale(0.95);
                                opacity: 0;
                            }
                            to { 
                                transform: translateY(0) scale(1);
                                opacity: 1;
                            }
                        }
                        @keyframes pulse {
                            0%, 100% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                        }
                        .alert-box {
                            animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                        }
                        .alert-icon {
                            animation: pulse 0.6s ease-in-out;
                        }
                        .alert-button:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
                        }
                        .alert-button:active {
                            transform: translateY(0);
                        }
                    `),
        React.createElement("div", { className: "alert-box", style: {
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                borderRadius: '24px',
                padding: '40px',
                maxWidth: '450px',
                width: '90%',
                maxHeight: '90vh',
                overflowY: 'auto',
                boxShadow: '0 20px 60px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.1) inset',
                border: '2px solid rgba(255,255,255,0.2)',
                margin: 'auto'
            }, onClick: e => e.stopPropagation() },
            React.createElement("div", { className: "alert-icon", style: {
                    fontSize: '64px',
                    textAlign: 'center',
                    marginBottom: '20px',
                    filter: 'drop-shadow(0 4px 8px rgba(0,0,0,0.2))'
                } }, alertIcon),
            React.createElement("h3", { style: {
                    color: 'white',
                    fontSize: '24px',
                    fontWeight: 'bold',
                    marginBottom: '16px',
                    textAlign: 'center',
                    textShadow: '0 2px 4px rgba(0,0,0,0.2)',
                    letterSpacing: '0.5px'
                } }, alertTitle),
            React.createElement("p", { style: {
                    color: 'rgba(255,255,255,0.95)',
                    fontSize: '16px',
                    marginBottom: '30px',
                    textAlign: 'center',
                    lineHeight: '1.7',
                    whiteSpace: 'pre-line'
                } }, alertMessage),
            React.createElement("button", { className: "alert-button", onClick: () => setShowCustomAlert(false), style: {
                    width: '100%',
                    padding: '14px',
                    background: 'white',
                    color: '#667eea',
                    border: 'none',
                    borderRadius: '12px',
                    fontSize: '17px',
                    fontWeight: 'bold',
                    cursor: 'pointer',
                    transition: 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)',
                    boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
                } }, "OK"))));
    const CustomConfirm = () => showCustomConfirm && (React.createElement("div", { style: {
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: 'rgba(0,0,0,0.7)',
            backdropFilter: 'blur(8px)',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            zIndex: 10000,
            animation: 'fadeIn 0.3s ease-out'
        }, onClick: () => { setShowCustomConfirm(false); confirmResolve && confirmResolve(false); } },
        React.createElement("style", null, `
                        @keyframes fadeIn {
                            from { opacity: 0; }
                            to { opacity: 1; }
                        }
                        @keyframes slideUp {
                            from { 
                                transform: translateY(30px) scale(0.95);
                                opacity: 0;
                            }
                            to { 
                                transform: translateY(0) scale(1);
                                opacity: 1;
                            }
                        }
                        @keyframes pulse {
                            0%, 100% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                        }
                        .confirm-box {
                            animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                        }
                        .confirm-icon {
                            animation: pulse 0.6s ease-in-out;
                        }
                        .confirm-button-cancel:hover {
                            background: rgba(255,255,255,0.4);
                            transform: translateY(-2px);
                        }
                        .confirm-button-ok:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
                        }
                        .confirm-button-cancel:active,
                        .confirm-button-ok:active {
                            transform: translateY(0);
                        }
                    `),
        React.createElement("div", { className: "confirm-box", style: {
                background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                borderRadius: '24px',
                padding: '40px',
                maxWidth: '450px',
                width: '90%',
                maxHeight: '90vh',
                overflowY: 'auto',
                boxShadow: '0 20px 60px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.1) inset',
                border: '2px solid rgba(255,255,255,0.2)'
            }, onClick: e => e.stopPropagation() },
            React.createElement("div", { className: "confirm-icon", style: {
                    fontSize: '64px',
                    textAlign: 'center',
                    marginBottom: '20px',
                    filter: 'drop-shadow(0 4px 8px rgba(0,0,0,0.2))'
                } }, confirmIcon),
            React.createElement("h3", { style: {
                    color: 'white',
                    fontSize: '24px',
                    fontWeight: 'bold',
                    marginBottom: '16px',
                    textAlign: 'center',
                    textShadow: '0 2px 4px rgba(0,0,0,0.2)',
                    letterSpacing: '0.5px'
                } }, confirmTitle),
            React.createElement("p", { style: {
                    color: 'rgba(255,255,255,0.95)',
                    fontSize: '16px',
                    marginBottom: '30px',
                    textAlign: 'center',
                    lineHeight: '1.7',
                    whiteSpace: 'pre-line',
                    maxHeight: '400px',
                    overflowY: 'auto',
                    paddingRight: '8px'
                } }, confirmMessage),
            React.createElement("div", { style: { display: 'flex', gap: '12px' } },
                React.createElement("button", { className: "confirm-button-cancel", onClick: () => { setShowCustomConfirm(false); confirmResolve && confirmResolve(false); }, style: {
                        flex: 1,
                        padding: '14px',
                        background: 'rgba(255,255,255,0.3)',
                        color: 'white',
                        border: '2px solid white',
                        borderRadius: '12px',
                        fontSize: '17px',
                        fontWeight: 'bold',
                        cursor: 'pointer',
                        transition: 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)',
                        boxShadow: '0 4px 12px rgba(0,0,0,0.1)'
                    } }, confirmCancelText),
                React.createElement("button", { className: "confirm-button-ok", onClick: () => { setShowCustomConfirm(false); confirmResolve && confirmResolve(true); }, style: {
                        flex: 1,
                        padding: '14px',
                        background: 'white',
                        color: '#f5576c',
                        border: 'none',
                        borderRadius: '12px',
                        fontSize: '17px',
                        fontWeight: 'bold',
                        cursor: 'pointer',
                        transition: 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)',
                        boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
                    } }, confirmOkText)))));
    // ğŸ†• ç”»åƒè¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«
    const ImageSettingsModal = () => showImageSettings && currentStoreData && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 overflow-y-auto pt-4 pb-20" },
        React.createElement("div", { className: "bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl" },
            React.createElement("h2", { className: "text-2xl font-bold text-gray-800 mb-6" }, "\u30AA\u30FC\u30D7\u30CB\u30F3\u30B0\u30DA\u30FC\u30B8\u753B\u50CF\u8A2D\u5B9A"),
            React.createElement("div", { className: "space-y-6" },
                React.createElement("div", { className: "border-2 border-gray-200 rounded-lg p-4" },
                    React.createElement("h3", { className: "font-bold text-gray-700 mb-2" }, "\u770B\u677F\u753B\u50CF"),
                    React.createElement("p", { className: "text-sm text-gray-500 mb-3" }, "\u63A8\u5968\u30B5\u30A4\u30BA: 600\u00D7300px\uFF08index.html\u4E0A\u90E8\uFF09"),
                    currentStoreData.mainImageUrl && (React.createElement("img", { src: currentStoreData.mainImageUrl, alt: "\u770B\u677F\u753B\u50CF\u30D7\u30EC\u30D3\u30E5\u30FC", className: "w-full max-w-md mb-3 rounded-lg border" })),
                    React.createElement("input", { type: "file", accept: "image/*", onChange: (e) => {
                            const file = e.target.files[0];
                            if (file)
                                handleImageUpload('main', file);
                        }, className: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100", disabled: imageUploading.main }),
                    imageUploading.main && (React.createElement("p", { className: "text-blue-600 mt-2" }, "\u23F3 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D..."))),
                React.createElement("div", { className: "border-2 border-gray-200 rounded-lg p-4" },
                    React.createElement("h3", { className: "font-bold text-gray-700 mb-2" }, "\u30D8\u30C3\u30C0\u4E0B\u753B\u50CF"),
                    React.createElement("p", { className: "text-sm text-gray-500 mb-3" }, "\u63A8\u5968\u30B5\u30A4\u30BA: 600\u00D7204px\uFF08index.html\uFF09"),
                    currentStoreData.welcomeImageUrl && (React.createElement("img", { src: currentStoreData.welcomeImageUrl, alt: "\u30D8\u30C3\u30C0\u4E0B\u753B\u50CF\u30D7\u30EC\u30D3\u30E5\u30FC", className: "w-full max-w-md mb-3 rounded-lg border" })),
                    React.createElement("input", { type: "file", accept: "image/*", onChange: (e) => {
                            const file = e.target.files[0];
                            if (file)
                                handleImageUpload('welcome', file);
                        }, className: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100", disabled: imageUploading.welcome }),
                    imageUploading.welcome && (React.createElement("p", { className: "text-green-600 mt-2" }, "\u23F3 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D..."))),
                React.createElement("div", { className: "border-2 border-gray-200 rounded-lg p-4" },
                    React.createElement("h3", { className: "font-bold text-gray-700 mb-2" }, "\u6CE8\u6587\u958B\u59CB\u30DC\u30BF\u30F3\u753B\u50CF"),
                    React.createElement("p", { className: "text-sm text-gray-500 mb-3" }, "\u63A8\u5968\u30B5\u30A4\u30BA: 250\u00D780px\uFF08index.html\uFF09"),
                    currentStoreData.buttonImageUrl && (React.createElement("img", { src: currentStoreData.buttonImageUrl, alt: "\u30DC\u30BF\u30F3\u753B\u50CF\u30D7\u30EC\u30D3\u30E5\u30FC", className: "mb-3 rounded-lg border", style: { maxWidth: '250px' } })),
                    React.createElement("input", { type: "file", accept: "image/*", onChange: (e) => {
                            const file = e.target.files[0];
                            if (file)
                                handleImageUpload('button', file);
                        }, className: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100", disabled: imageUploading.button }),
                    imageUploading.button && (React.createElement("p", { className: "text-purple-600 mt-2" }, "\u23F3 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D..."))),
                React.createElement("div", { className: "border-2 border-orange-200 rounded-lg p-4 bg-orange-50" },
                    React.createElement("h3", { className: "font-bold text-orange-700 mb-2" }, "\u30E1\u30CB\u30E5\u30FC\u753B\u9762\u30D8\u30C3\u30C0\u753B\u50CF"),
                    React.createElement("p", { className: "text-sm text-orange-600 mb-3" }, "\u63A8\u5968\u30B5\u30A4\u30BA: \u6A2A\u5E45100%\u5BFE\u5FDC\uFF08menu.html\u4E0A\u90E8\uFF09"),
                    currentStoreData.headerImageUrl && (React.createElement("img", { src: currentStoreData.headerImageUrl, alt: "\u30D8\u30C3\u30C0\u753B\u50CF\u30D7\u30EC\u30D3\u30E5\u30FC", className: "w-full mb-3 rounded-lg border border-orange-300" })),
                    React.createElement("input", { type: "file", accept: "image/*", onChange: (e) => {
                            const file = e.target.files[0];
                            if (file)
                                handleImageUpload('header', file);
                        }, className: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100", disabled: imageUploading.header }),
                    imageUploading.header && (React.createElement("p", { className: "text-orange-600 mt-2" }, "\u23F3 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D..."))),
                React.createElement("div", { className: "border-2 border-pink-200 rounded-lg p-4 bg-pink-50" },
                    React.createElement("h3", { className: "font-bold text-pink-700 mb-2" }, "\u30E1\u30CB\u30E5\u30FC\u753B\u9762\u80CC\u666F\u753B\u50CF"),
                    React.createElement("p", { className: "text-sm text-pink-600 mb-3" }, "\u63A8\u5968\u30B5\u30A4\u30BA: 1920\u00D71080px\u4EE5\u4E0A\uFF08menu.html\u5168\u4F53\u80CC\u666F\uFF09"),
                    currentStoreData.backgroundImageUrl && (React.createElement("img", { src: currentStoreData.backgroundImageUrl, alt: "\u80CC\u666F\u753B\u50CF\u30D7\u30EC\u30D3\u30E5\u30FC", className: "w-full mb-3 rounded-lg border border-pink-300" })),
                    React.createElement("input", { type: "file", accept: "image/*", onChange: (e) => {
                            const file = e.target.files[0];
                            if (file)
                                handleImageUpload('background', file);
                        }, className: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100", disabled: imageUploading.background }),
                    imageUploading.background && (React.createElement("p", { className: "text-pink-600 mt-2" }, "\u23F3 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D...")))),
            React.createElement("div", { className: "mt-6 flex justify-end" },
                React.createElement("button", { onClick: () => {
                        setShowImageSettings(false);
                        setCurrentStoreData(null);
                    }, className: "bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-bold hover:bg-gray-400 transition-all" }, "\u9589\u3058\u308B")))));
    // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
    if (!isAdminAuthenticated) {
        return (React.createElement("div", { className: "min-h-screen bg-gray-100 flex items-center justify-center p-4" },
            React.createElement("div", { className: "w-full max-w-md" },
                React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-8" },
                    React.createElement("div", { className: "text-center mb-6" },
                        React.createElement(Lock, { className: "w-16 h-16 mx-auto mb-4 text-gray-400" }),
                        React.createElement("h2", { className: "text-2xl font-bold" }, "\u7BA1\u7406\u753B\u9762\u30ED\u30B0\u30A4\u30F3")),
                    error && (React.createElement("div", { className: "mb-4 p-3 bg-red-100 border border-red-400 rounded text-red-700 text-sm" }, error)),
                    React.createElement("form", { onSubmit: handleLogin },
                        React.createElement("input", { type: "text", placeholder: "\u5E97\u8217\u540D", value: storeNameInput, onChange: (e) => setStoreNameInput(e.target.value), className: "w-full p-3 border rounded-lg mb-4", autoFocus: true, disabled: isLoading, required: true }),
                        React.createElement("input", { type: "password", placeholder: "\u30D1\u30B9\u30EF\u30FC\u30C9", value: passwordInput, onChange: (e) => setPasswordInput(e.target.value), className: "w-full p-3 border rounded-lg mb-4", disabled: isLoading, required: true }),
                        React.createElement("button", { type: "submit", disabled: isLoading, className: "w-full p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium disabled:bg-gray-400" }, isLoading ? 'ãƒ­ã‚°ã‚¤ãƒ³ä¸­...' : 'ãƒ­ã‚°ã‚¤ãƒ³'))))));
    }
    // ãƒ¡ã‚¤ãƒ³ç”»é¢(ç¶šã...)
    return (React.createElement("div", { className: "min-h-screen bg-gray-100 p-4" },
        isLoading && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" },
            React.createElement("div", { className: "bg-white rounded-lg p-8 text-center" },
                React.createElement("div", { className: "animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mx-auto mb-4" }),
                React.createElement("p", { className: "text-gray-700 font-semibold text-lg" }, "\u8AAD\u307F\u8FBC\u307F\u4E2D..."),
                React.createElement("p", { className: "text-gray-500 text-sm mt-2" }, "\u5F93\u696D\u54E1\u30C7\u30FC\u30BF\u3092\u53D6\u5F97\u3057\u3066\u3044\u307E\u3059")))),
        React.createElement("div", { className: "max-w-7xl mx-auto" },
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center" },
                    React.createElement("div", null,
                        React.createElement("h1", { className: "text-3xl font-bold text-gray-800" }, "\u7BA1\u7406\u753B\u9762")),
                    React.createElement("button", { onClick: () => setIsAdminAuthenticated(false), className: "px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u30ED\u30B0\u30A2\u30A6\u30C8"))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex items-center gap-4" },
                    React.createElement("label", { className: "font-medium text-gray-700" }, "\u5BFE\u8C61\u6708:"),
                    React.createElement("select", { value: currentYear, onChange: (e) => setCurrentYear(parseInt(e.target.value)), className: "p-2 border rounded-lg" }, [2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030].map(year => (React.createElement("option", { key: year, value: year },
                        year,
                        "\u5E74")))),
                    React.createElement("select", { value: currentMonth, onChange: (e) => setCurrentMonth(parseInt(e.target.value)), className: "p-2 border rounded-lg" }, [...Array(12)].map((_, i) => (React.createElement("option", { key: i, value: i },
                        i + 1,
                        "\u6708")))))),
            React.createElement("div", { className: "bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg shadow-lg p-6 mb-6 text-white" },
                React.createElement("div", { className: "flex justify-between items-center" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold mb-2" }, "\u5E74\u672B\u8ABF\u6574"),
                        React.createElement("p", { className: "text-sm opacity-90" }, "\u5F93\u696D\u54E1\u306E\u5E74\u672B\u8ABF\u6574\u8A08\u7B97\u30FB\u6E90\u6CC9\u5FB4\u53CE\u7968\u306E\u4F5C\u6210")),
                    React.createElement("a", { href: "nenmatsu.html", target: "_blank", className: "px-6 py-3 bg-white text-purple-600 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105" }, "\u5E74\u672B\u8ABF\u6574\u3092\u958B\u304F \u2192"))),
            React.createElement("div", { className: "bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg shadow-lg p-6 mb-6 text-white" },
                React.createElement("div", { className: "flex justify-between items-center" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold mb-2" }, "\u78BA\u5B9A\u7533\u544A"),
                        React.createElement("p", { className: "text-sm opacity-90" }, "\u500B\u4EBA\u4E8B\u696D\u4E3B\u5411\u3051\u9752\u8272\u7533\u544A\u66F8\u985E\u306E\u81EA\u52D5\u4F5C\u6210")),
                    React.createElement("a", { href: "kakutei.html", target: "_blank", className: "px-6 py-3 bg-white text-blue-600 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105" }, "\u78BA\u5B9A\u7533\u544A\u3092\u958B\u304F \u2192"))),
            window.currentStoreId && (React.createElement("div", { className: "bg-gradient-to-r from-pink-500 to-rose-500 rounded-lg shadow-lg p-6 mb-6 text-white" },
                React.createElement("div", { className: "flex justify-between items-center" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold mb-2" }, "\u30AA\u30FC\u30D7\u30CB\u30F3\u30B0\u30DA\u30FC\u30B8\u753B\u50CF\u8A2D\u5B9A")),
                    React.createElement("button", { onClick: openImageSettings, className: "px-6 py-3 bg-white text-pink-600 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105" }, "\u753B\u50CF\u8A2D\u5B9A\u3092\u958B\u304F \u2192")))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u30C6\u30FC\u30D6\u30EB\u8A2D\u5B9A"),
                    React.createElement("button", { onClick: () => {
                            setShowTableSettings(!showTableSettings);
                            if (!showTableSettings) {
                                loadTables(); // ğŸ†• ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’èª­ã¿è¾¼ã‚€
                                loadTableSettings();
                                loadMenuItems();
                            }
                        }, className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showTableSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showTableSettings && (React.createElement("div", null,
                    React.createElement("div", { className: "mb-6" },
                        React.createElement("button", { onClick: () => setShowAddTable(true), className: "w-full px-6 py-4 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold text-lg flex items-center justify-center gap-2" }, "\u2795 \u65B0\u3057\u3044\u30C6\u30FC\u30D6\u30EB\u3092\u4F5C\u6210")),
                    React.createElement("div", { className: "mb-6" },
                        React.createElement("button", { onClick: () => {
                                setShowTableManagement(!showTableManagement);
                                if (!showTableManagement) {
                                    loadTablesList();
                                }
                            }, className: "w-full px-6 py-4 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 font-bold text-lg flex items-center justify-center gap-2" }, "\uD83C\uDFE0 \u30C6\u30FC\u30D6\u30EB\u7BA1\u7406\uFF08QR\u30FB\u7DE8\u96C6\u30FB\u524A\u9664\u30FB\u9806\u5E8F\u5909\u66F4\uFF09")),
                    React.createElement("div", { className: "mb-6" },
                        React.createElement("label", { className: "block text-lg font-medium mb-3" }, "\u8A2D\u5B9A\u3059\u308B\u30C6\u30FC\u30D6\u30EB\u3092\u9078\u629E"),
                        React.createElement("select", { value: selectedTable, onChange: (e) => {
                                setSelectedTable(e.target.value);
                                setSelectedCategory('all'); // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
                                if (!tableSettings[e.target.value]) {
                                    setTableSettings(prev => (Object.assign(Object.assign({}, prev), { [e.target.value]: getDefaultTableSettings() })));
                                }
                            }, className: "w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" },
                            React.createElement("option", { value: "" }, "-- \u30C6\u30FC\u30D6\u30EB\u3092\u9078\u629E --"),
                            availableTables.map(table => (React.createElement("option", { key: table.id, value: table.name }, table.name))))),
                    selectedTable && (React.createElement(React.Fragment, null,
                        React.createElement("div", { className: "border-l-4 border-blue-500 pl-4 mb-6" },
                            React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u5165\u529B\u6B04\u306E\u8868\u793A\u8A2D\u5B9A"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-4" }, "\u3053\u306E\u30C6\u30FC\u30D6\u30EB\u3067\u8868\u793A\u3059\u308B\u5165\u529B\u6B04\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044"),
                            [
                                { key: 'name', label: 'ãŠåå‰', description: 'ãŠå®¢æ§˜ã®åå‰ã‚’å…¥åŠ›' },
                                { key: 'phone', label: 'é›»è©±ç•ªå·', description: 'ãŠå®¢æ§˜ã®é›»è©±ç•ªå·ã‚’å…¥åŠ›' },
                                { key: 'pickupTime', label: 'å¼•å–æ™‚é–“', description: 'å•†å“ã®å¼•å–æ™‚é–“ã‚’é¸æŠï¼ˆ30åˆ†å¾Œã€1æ™‚é–“å¾Œãªã©ï¼‰' },
                                { key: 'postalCode', label: 'éƒµä¾¿ç•ªå·', description: 'é…é€å…ˆã®éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›' },
                                { key: 'address', label: 'ä½æ‰€', description: 'é…é€å…ˆã®ä½æ‰€ã‚’å…¥åŠ›' },
                                { key: 'email', label: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹', description: 'ãŠå®¢æ§˜ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›' }
                            ].map(field => {
                                var _a, _b;
                                const currentSettings = ((_b = (_a = tableSettings[selectedTable]) === null || _a === void 0 ? void 0 : _a.inputFields) === null || _b === void 0 ? void 0 : _b[field.key]) || { visible: false, required: false };
                                return (React.createElement("div", { key: field.key, className: "flex items-center justify-between p-4 bg-gray-50 rounded-lg mb-3" },
                                    React.createElement("div", { className: "flex-1" },
                                        React.createElement("label", { className: "block text-md font-medium mb-1" }, field.label),
                                        React.createElement("p", { className: "text-sm text-gray-600" }, field.description),
                                        currentSettings.visible && (React.createElement("div", { className: "mt-2" },
                                            React.createElement("label", { className: "inline-flex items-center text-sm" },
                                                React.createElement("input", { type: "checkbox", checked: currentSettings.required, onChange: (e) => updateTableInputField(selectedTable, field.key, 'required', e.target.checked), className: "mr-2" }),
                                                React.createElement("span", { className: "text-red-600 font-medium" }, "\u5FC5\u9808\u9805\u76EE\u306B\u3059\u308B"))))),
                                    React.createElement("label", { className: "relative inline-flex items-center cursor-pointer ml-4" },
                                        React.createElement("input", { type: "checkbox", checked: currentSettings.visible, onChange: (e) => {
                                                updateTableInputField(selectedTable, field.key, 'visible', e.target.checked);
                                                if (!e.target.checked) {
                                                    updateTableInputField(selectedTable, field.key, 'required', false);
                                                }
                                            }, className: "sr-only peer" }),
                                        React.createElement("div", { className: "w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600" }))));
                            }),
                            React.createElement("div", { className: "flex items-center justify-between p-4 bg-blue-50 rounded-lg border-2 border-blue-300" },
                                React.createElement("div", { className: "flex-1" },
                                    React.createElement("label", { className: "block text-md font-medium mb-1" }, "\u5099\u8003\u30FB\u30E1\u30E2\u6B04"),
                                    React.createElement("p", { className: "text-sm text-gray-600" }, "\u5168\u30C6\u30FC\u30D6\u30EB\u5171\u901A\u3067\u8868\u793A\u3055\u308C\u307E\u3059\uFF08\u4EFB\u610F\u9805\u76EE\uFF09")),
                                React.createElement("div", { className: "px-4 py-2 bg-blue-600 text-white rounded-lg font-medium" }, "\u5E38\u306B\u8868\u793A"))),
                        React.createElement("div", { className: "border-l-4 border-green-500 pl-4 mb-6" },
                            React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u30E1\u30CB\u30E5\u30FC\u8A2D\u5B9A"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-4" }, "\u3053\u306E\u30C6\u30FC\u30D6\u30EB\u3067\u8868\u793A\u3059\u308B\u30E1\u30CB\u30E5\u30FC\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044"),
                            React.createElement("div", { className: "space-y-3 mb-4" },
                                React.createElement("label", { className: "flex items-center p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100" },
                                    React.createElement("input", { type: "radio", name: `menuType-${selectedTable}`, value: "default", checked: ((_a = tableSettings[selectedTable]) === null || _a === void 0 ? void 0 : _a.menuType) === 'default', onChange: () => updateTableMenuType(selectedTable, 'default'), className: "mr-3 w-5 h-5" }),
                                    React.createElement("div", null,
                                        React.createElement("div", { className: "font-medium" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\uFF08\u5168\u30E1\u30CB\u30E5\u30FC\u8868\u793A\uFF09"),
                                        React.createElement("div", { className: "text-sm text-gray-600" }, "\u3059\u3079\u3066\u306E\u30E1\u30CB\u30E5\u30FC\u3092\u8868\u793A\u3057\u307E\u3059"))),
                                React.createElement("label", { className: "flex items-center p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100" },
                                    React.createElement("input", { type: "radio", name: `menuType-${selectedTable}`, value: "custom", checked: ((_b = tableSettings[selectedTable]) === null || _b === void 0 ? void 0 : _b.menuType) === 'custom', onChange: () => updateTableMenuType(selectedTable, 'custom'), className: "mr-3 w-5 h-5" }),
                                    React.createElement("div", null,
                                        React.createElement("div", { className: "font-medium" }, "\u30AB\u30B9\u30BF\u30E0\u30E1\u30CB\u30E5\u30FC"),
                                        React.createElement("div", { className: "text-sm text-gray-600" }, "\u8868\u793A\u3059\u308B\u30E1\u30CB\u30E5\u30FC\u3092\u500B\u5225\u306B\u9078\u629E\u3057\u307E\u3059")))),
                            ((_c = tableSettings[selectedTable]) === null || _c === void 0 ? void 0 : _c.menuType) === 'custom' && (React.createElement("div", { className: "border-2 border-green-300 rounded-lg p-4 bg-green-50" },
                                React.createElement("h4", { className: "font-medium mb-3" }, "\u8868\u793A\u3059\u308B\u30E1\u30CB\u30E5\u30FC\u3092\u9078\u629E"),
                                React.createElement("div", { className: "mb-4" },
                                    React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u30AB\u30C6\u30B4\u30EA\u3067\u7D5E\u308A\u8FBC\u307F"),
                                    React.createElement("select", { value: selectedCategory, onChange: (e) => setSelectedCategory(e.target.value), className: "w-full p-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" },
                                        React.createElement("option", { value: "all" }, "\u3059\u3079\u3066\u306E\u30AB\u30C6\u30B4\u30EA"),
                                        Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(cat => (React.createElement("option", { key: cat, value: cat }, cat))))),
                                ((_e = (_d = tableSettings[selectedTable]) === null || _d === void 0 ? void 0 : _d.customMenuItems) === null || _e === void 0 ? void 0 : _e.length) > 0 && (React.createElement("div", { className: "mb-4 p-3 bg-blue-50 border-2 border-blue-300 rounded-lg" },
                                    React.createElement("h5", { className: "font-medium mb-2 text-blue-900" },
                                        "\u2713 \u9078\u629E\u4E2D\u306E\u30E1\u30CB\u30E5\u30FC\uFF08", (_g = (_f = tableSettings[selectedTable]) === null || _f === void 0 ? void 0 : _f.customMenuItems) === null || _g === void 0 ? void 0 :
                                        _g.length,
                                        "\u4EF6\uFF09"),
                                    React.createElement("div", { className: "text-xs text-blue-700 mb-2" }, "\u2191\u2193\u30DC\u30BF\u30F3\u3067\u8868\u793A\u9806\u3092\u5909\u66F4\u3067\u304D\u307E\u3059"),
                                    React.createElement("div", { className: "space-y-2 max-h-60 overflow-y-auto" }, tableSettings[selectedTable].customMenuItems.map((itemId, index) => {
                                        const item = availableMenuItems.find(m => m.id === itemId);
                                        if (!item)
                                            return null;
                                        return (React.createElement("div", { key: itemId, className: "flex items-center gap-2 bg-white p-2 rounded border" },
                                            React.createElement("div", { className: "flex flex-col gap-1" },
                                                React.createElement("button", { onClick: () => moveCustomMenuItem(selectedTable, index, index - 1), disabled: index === 0, className: `p-1 rounded ${index === 0 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0A\u306B\u79FB\u52D5" },
                                                    React.createElement("svg", { width: "12", height: "12", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "3" },
                                                        React.createElement("polyline", { points: "18 15 12 9 6 15" }))),
                                                React.createElement("button", { onClick: () => moveCustomMenuItem(selectedTable, index, index + 1), disabled: index === tableSettings[selectedTable].customMenuItems.length - 1, className: `p-1 rounded ${index === tableSettings[selectedTable].customMenuItems.length - 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0B\u306B\u79FB\u52D5" },
                                                    React.createElement("svg", { width: "12", height: "12", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "3" },
                                                        React.createElement("polyline", { points: "6 9 12 15 18 9" })))),
                                            React.createElement("div", { className: "flex-1" },
                                                React.createElement("div", { className: "font-medium text-sm" },
                                                    index + 1,
                                                    ". ",
                                                    item.name),
                                                React.createElement("div", { className: "text-xs text-gray-600" }, item.category)),
                                            React.createElement("button", { onClick: () => toggleCustomMenuItem(selectedTable, itemId), className: "px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-xs" }, "\u524A\u9664")));
                                    })))),
                                React.createElement("div", null,
                                    React.createElement("h5", { className: "font-medium mb-2" }, "\u30E1\u30CB\u30E5\u30FC\u304B\u3089\u8FFD\u52A0"),
                                    React.createElement("div", { className: "grid grid-cols-2 gap-2 max-h-96 overflow-y-auto" },
                                        availableMenuItems
                                            .filter(item => {
                                            var _a, _b;
                                            // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                                            if (selectedCategory !== 'all' && item.category !== selectedCategory) {
                                                return false;
                                            }
                                            // æœªé¸æŠã®ã‚‚ã®ã®ã¿è¡¨ç¤º
                                            return !((_b = (_a = tableSettings[selectedTable]) === null || _a === void 0 ? void 0 : _a.customMenuItems) === null || _b === void 0 ? void 0 : _b.includes(item.id));
                                        })
                                            .map(item => (React.createElement("label", { key: item.id, className: "flex items-center p-3 rounded-lg cursor-pointer bg-white border-2 border-gray-300 hover:border-green-400 hover:bg-green-50", onClick: () => toggleCustomMenuItem(selectedTable, item.id) },
                                            React.createElement("div", { className: "flex-1" },
                                                React.createElement("div", { className: "font-medium" }, item.name),
                                                React.createElement("div", { className: "text-xs text-gray-600" }, item.category)),
                                            React.createElement("button", { className: "ml-2 px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600" }, "\u8FFD\u52A0")))),
                                        availableMenuItems.filter(item => {
                                            var _a, _b;
                                            if (selectedCategory !== 'all' && item.category !== selectedCategory)
                                                return false;
                                            return !((_b = (_a = tableSettings[selectedTable]) === null || _a === void 0 ? void 0 : _a.customMenuItems) === null || _b === void 0 ? void 0 : _b.includes(item.id));
                                        }).length === 0 && (React.createElement("div", { className: "col-span-2 text-center text-gray-500 py-4" }, selectedCategory === 'all' ? 'ã™ã¹ã¦ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™' : 'ã“ã®ã‚«ãƒ†ã‚´ãƒªã«è¿½åŠ å¯èƒ½ãªãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“'))))))),
                        React.createElement("div", { className: "border-l-4 border-purple-500 pl-4 mb-6" },
                            React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u30AB\u30C6\u30B4\u30EA\u8868\u793A\u8A2D\u5B9A"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-4" }, "\u3053\u306E\u30C6\u30FC\u30D6\u30EB\u3067\u8868\u793A\u3059\u308B\u30AB\u30C6\u30B4\u30EA\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\uFF08\u7A7A = \u5168\u30AB\u30C6\u30B4\u30EA\u8868\u793A\uFF09"),
                            React.createElement("div", { className: "bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4" },
                                React.createElement("div", { className: "flex items-center gap-2 mb-2" },
                                    React.createElement("span", { className: "text-2xl" }, "\uD83D\uDCA1"),
                                    React.createElement("span", { className: "font-bold text-yellow-900" }, "\u4F7F\u3044\u65B9")),
                                React.createElement("ul", { className: "text-sm text-yellow-900 space-y-1 ml-8" },
                                    React.createElement("li", null, "\u2022 \u4F55\u3082\u9078\u629E\u3057\u306A\u3044\uFF08\u5168\u3066\u672A\u30C1\u30A7\u30C3\u30AF\uFF09= \u5168\u30AB\u30C6\u30B4\u30EA\u3092\u8868\u793A"),
                                    React.createElement("li", null, "\u2022 \u30AB\u30C6\u30B4\u30EA\u3092\u9078\u629E = \u9078\u629E\u3057\u305F\u30AB\u30C6\u30B4\u30EA\u306E\u307F\u8868\u793A"),
                                    React.createElement("li", null, "\u2022 \u4F8B: \u30E2\u30D0\u30A4\u30EB\u30AA\u30FC\u30C0\u30FC\u7528\u30C6\u30FC\u30D6\u30EB\u3067\u300C\u5E97\u5185\u306E\u307F\u300D\u3092\u975E\u8868\u793A\u306B\u3059\u308B"))),
                            React.createElement("div", { className: "grid grid-cols-2 gap-3" }, Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(category => {
                                var _a, _b;
                                const isSelected = (_b = (_a = tableSettings[selectedTable]) === null || _a === void 0 ? void 0 : _a.visibleCategories) === null || _b === void 0 ? void 0 : _b.includes(category);
                                const itemCount = availableMenuItems.filter(item => item.category === category).length;
                                return (React.createElement("label", { key: category, className: `flex items-center justify-between p-3 rounded-lg cursor-pointer border-2 transition-all ${isSelected
                                        ? 'bg-purple-100 border-purple-500'
                                        : 'bg-white border-gray-300 hover:border-purple-300'}` },
                                    React.createElement("div", { className: "flex items-center gap-2" },
                                        React.createElement("input", { type: "checkbox", checked: isSelected, onChange: () => toggleTableCategory(selectedTable, category), className: "w-5 h-5" }),
                                        React.createElement("div", null,
                                            React.createElement("div", { className: "font-medium text-sm" }, category),
                                            React.createElement("div", { className: "text-xs text-gray-600" },
                                                itemCount,
                                                "\u4EF6")))));
                            })),
                            React.createElement("div", { className: "mt-3 p-3 bg-gray-100 rounded-lg" },
                                React.createElement("div", { className: "text-sm font-medium mb-1" }, "\u73FE\u5728\u306E\u8A2D\u5B9A:"),
                                React.createElement("div", { className: "text-sm text-gray-700" }, (!((_h = tableSettings[selectedTable]) === null || _h === void 0 ? void 0 : _h.visibleCategories) || tableSettings[selectedTable].visibleCategories.length === 0) ? (React.createElement("span", { className: "text-green-600 font-medium" }, "\u2713 \u5168\u30AB\u30C6\u30B4\u30EA\u3092\u8868\u793A")) : (React.createElement("span", null,
                                    "\u8868\u793A\u30AB\u30C6\u30B4\u30EA:",
                                    React.createElement("span", { className: "font-medium text-purple-600 ml-2" }, tableSettings[selectedTable].visibleCategories.join(', '))))))),
                        React.createElement("div", { className: "border-l-4 border-purple-500 pl-4 mb-6" },
                            React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u55B6\u696D\u6642\u9593\u8A2D\u5B9A\uFF08\u3053\u306E\u30C6\u30FC\u30D6\u30EB\u5C02\u7528\uFF09"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-4" }, "\u3053\u306E\u30C6\u30FC\u30D6\u30EB\u5C02\u7528\u306E\u55B6\u696D\u6642\u9593\u3092\u8A2D\u5B9A\u3067\u304D\u307E\u3059\u3002\u4E88\u7D04\u7528\u30C6\u30FC\u30D6\u30EB\u309224\u6642\u9593\u5229\u7528\u53EF\u80FD\u306B\u3059\u308B\u3001\u307E\u305F\u306F\u7279\u5B9A\u306E\u55B6\u696D\u6642\u9593\u3092\u8A2D\u5B9A\u3059\u308B\u5834\u5408\u306B\u4F7F\u7528\u3057\u307E\u3059\u3002"),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("div", { className: "flex items-center gap-3 p-4 bg-green-50 border-2 border-green-300 rounded-lg" },
                                    React.createElement("input", { type: "checkbox", id: `timeOverride-${selectedTable}`, checked: ((_k = (_j = tableSettings[selectedTable]) === null || _j === void 0 ? void 0 : _j.timeOverride) === null || _k === void 0 ? void 0 : _k.enabled) || false, onChange: (e) => {
                                            setTableSettings(prev => {
                                                var _a;
                                                return (Object.assign(Object.assign({}, prev), { [selectedTable]: Object.assign(Object.assign({}, (prev[selectedTable] || getDefaultTableSettings())), { timeOverride: {
                                                            enabled: e.target.checked
                                                        }, 
                                                        // æ™‚é–“å¤–è§£é™¤ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ã€ã‚«ã‚¹ã‚¿ãƒ å–¶æ¥­æ™‚é–“ã¯ç„¡åŠ¹åŒ–
                                                        businessHours: e.target.checked ? { enabled: false } : (((_a = prev[selectedTable]) === null || _a === void 0 ? void 0 : _a.businessHours) || {}) }) }));
                                            });
                                        }, className: "w-5 h-5" }),
                                    React.createElement("div", { className: "flex-1" },
                                        React.createElement("label", { htmlFor: `timeOverride-${selectedTable}`, className: "font-bold cursor-pointer text-green-700" }, "\u2705 \u6642\u9593\u5916\u89E3\u9664\uFF0824\u6642\u9593\u3044\u3064\u3067\u3082\u6CE8\u6587\u53EF\u80FD\uFF09"),
                                        React.createElement("p", { className: "text-xs text-green-600 mt-1" }, "\u55B6\u696D\u6642\u9593\u30C1\u30A7\u30C3\u30AF\u3092\u5B8C\u5168\u306B\u7121\u52B9\u5316\u3057\u307E\u3059\uFF08\u63A8\u5968: \u4E88\u7D04\u5C02\u7528\u30C6\u30FC\u30D6\u30EB\uFF09")))),
                            !((_m = (_l = tableSettings[selectedTable]) === null || _l === void 0 ? void 0 : _l.timeOverride) === null || _m === void 0 ? void 0 : _m.enabled) && (React.createElement("div", null,
                                React.createElement("div", { className: "flex items-center gap-3 p-4 bg-purple-50 rounded-lg mb-4" },
                                    React.createElement("input", { type: "checkbox", id: `businessHours-${selectedTable}`, checked: ((_p = (_o = tableSettings[selectedTable]) === null || _o === void 0 ? void 0 : _o.businessHours) === null || _p === void 0 ? void 0 : _p.enabled) || false, onChange: (e) => {
                                            setTableSettings(prev => {
                                                var _a;
                                                return (Object.assign(Object.assign({}, prev), { [selectedTable]: Object.assign(Object.assign({}, (prev[selectedTable] || getDefaultTableSettings())), { businessHours: Object.assign(Object.assign({}, (((_a = prev[selectedTable]) === null || _a === void 0 ? void 0 : _a.businessHours) || {})), { enabled: e.target.checked }) }) }));
                                            });
                                        }, className: "w-5 h-5" }),
                                    React.createElement("div", { className: "flex-1" },
                                        React.createElement("label", { htmlFor: `businessHours-${selectedTable}`, className: "font-medium cursor-pointer" }, "\u30AB\u30B9\u30BF\u30E0\u55B6\u696D\u6642\u9593\u3092\u8A2D\u5B9A\u3059\u308B"),
                                        React.createElement("p", { className: "text-xs text-gray-600 mt-1" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u3068\u7570\u306A\u308B\u55B6\u696D\u6642\u9593\u3092\u8A2D\u5B9A\u3059\u308B\u5834\u5408\uFF08\u4F8B: 11:00-20:00\uFF09"))),
                                ((_r = (_q = tableSettings[selectedTable]) === null || _q === void 0 ? void 0 : _q.businessHours) === null || _r === void 0 ? void 0 : _r.enabled) && (React.createElement("div", { className: "grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg" },
                                    React.createElement("div", null,
                                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u958B\u5E97\u6642\u9593"),
                                        React.createElement("input", { type: "time", value: ((_t = (_s = tableSettings[selectedTable]) === null || _s === void 0 ? void 0 : _s.businessHours) === null || _t === void 0 ? void 0 : _t.openTime) || '11:00', onChange: (e) => {
                                                setTableSettings(prev => {
                                                    var _a;
                                                    return (Object.assign(Object.assign({}, prev), { [selectedTable]: Object.assign(Object.assign({}, (prev[selectedTable] || getDefaultTableSettings())), { businessHours: Object.assign(Object.assign({}, (((_a = prev[selectedTable]) === null || _a === void 0 ? void 0 : _a.businessHours) || {})), { openTime: e.target.value }) }) }));
                                                });
                                            }, className: "w-full p-2 border rounded-lg" })),
                                    React.createElement("div", null,
                                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u9589\u5E97\u6642\u9593"),
                                        React.createElement("input", { type: "time", value: ((_v = (_u = tableSettings[selectedTable]) === null || _u === void 0 ? void 0 : _u.businessHours) === null || _v === void 0 ? void 0 : _v.closeTime) || '22:00', onChange: (e) => {
                                                setTableSettings(prev => {
                                                    var _a;
                                                    return (Object.assign(Object.assign({}, prev), { [selectedTable]: Object.assign(Object.assign({}, (prev[selectedTable] || getDefaultTableSettings())), { businessHours: Object.assign(Object.assign({}, (((_a = prev[selectedTable]) === null || _a === void 0 ? void 0 : _a.businessHours) || {})), { closeTime: e.target.value }) }) }));
                                                });
                                            }, className: "w-full p-2 border rounded-lg" })),
                                    React.createElement("div", { className: "col-span-2 text-xs text-gray-600 bg-blue-50 p-3 rounded border border-blue-200" },
                                        "\uD83D\uDCA1 \u73FE\u5728\u306E\u8A2D\u5B9A: ",
                                        ((_x = (_w = tableSettings[selectedTable]) === null || _w === void 0 ? void 0 : _w.businessHours) === null || _x === void 0 ? void 0 : _x.openTime) || '11:00',
                                        " \uFF5E ",
                                        ((_z = (_y = tableSettings[selectedTable]) === null || _y === void 0 ? void 0 : _y.businessHours) === null || _z === void 0 ? void 0 : _z.closeTime) || '22:00'))),
                                !((_1 = (_0 = tableSettings[selectedTable]) === null || _0 === void 0 ? void 0 : _0.businessHours) === null || _1 === void 0 ? void 0 : _1.enabled) && (React.createElement("div", { className: "p-3 bg-gray-100 rounded-lg text-sm text-gray-600" }, "\u2139\uFE0F \u30C7\u30D5\u30A9\u30EB\u30C8\u55B6\u696D\u6642\u9593\u304C\u9069\u7528\u3055\u308C\u307E\u3059\uFF08\u30C6\u30FC\u30D6\u30EB\u6709: 11:00-22:00\u3001\u30C6\u30FC\u30D6\u30EB\u7121: 11:00-22:30\uFF09"))))),
                        React.createElement("div", { className: "border border-gray-300 rounded-lg p-4" },
                            React.createElement("h4", { className: "font-bold text-lg mb-3" }, "\uD83D\uDCB4 \u6D88\u8CBB\u7A0E\u30EB\u30FC\u30EB"),
                            React.createElement("div", { className: "space-y-3" },
                                React.createElement("select", { value: ((_2 = tableSettings[selectedTable]) === null || _2 === void 0 ? void 0 : _2.taxRule) || 'none', onChange: (e) => {
                                        setTableSettings(prev => (Object.assign(Object.assign({}, prev), { [selectedTable]: Object.assign(Object.assign({}, (prev[selectedTable] || getDefaultTableSettings())), { taxRule: e.target.value }) })));
                                    }, className: "w-full p-3 border-2 rounded-lg text-base" },
                                    React.createElement("option", { value: "none" }, "\u306A\u3057\uFF08\u5546\u54C1\u306E\u30C7\u30D5\u30A9\u30EB\u30C8\u7A0E\u7387\uFF09"),
                                    React.createElement("option", { value: "takeout" }, "\u30C6\u30A4\u30AF\u30A2\u30A6\u30C8\u30C7\u30D5\u30A9\u30EB\u30C8\uFF08\u98DF\u67508%\u3001\u98DF\u6750\u4EE5\u591610%\uFF09"),
                                    React.createElement("option", { value: "dine-in" }, "\u5E97\u5185\u98F2\u98DF\u53CA\u3073\u98DF\u6750\u4EE5\u5916\uFF08\u5168\u90E810%\uFF09")),
                                React.createElement("div", { className: "text-sm text-gray-600 bg-blue-50 p-3 rounded border border-blue-200" },
                                    "\uD83D\uDCA1 \u3053\u306E\u30C6\u30FC\u30D6\u30EB\u3067\u6CE8\u6587\u6642\u306B\u9069\u7528\u3055\u308C\u308B\u6D88\u8CBB\u7A0E\u30EB\u30FC\u30EB\u3067\u3059\u3002",
                                    React.createElement("br", null),
                                    "\u2022 \u30C6\u30A4\u30AF\u30A2\u30A6\u30C8: \u98DF\u6750\u306F8%\u3001\u98DF\u6750\u4EE5\u5916\uFF08\u5305\u6750\u306A\u3069\uFF09\u306F10%",
                                    React.createElement("br", null),
                                    "\u2022 \u5E97\u5185\u98F2\u98DF\u53CA\u3073\u98DF\u6750\u4EE5\u5916: \u5168\u5546\u54C110%",
                                    React.createElement("br", null),
                                    "\u2022 \u306A\u3057: \u5404\u5546\u54C1\u306B\u8A2D\u5B9A\u3055\u308C\u305F\u7A0E\u7387\u3092\u4F7F\u7528"))),
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { onClick: () => saveTableSettings(selectedTable), className: "flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-lg" }, "\u4FDD\u5B58"),
                            React.createElement("button", { onClick: () => {
                                    setTableSettings(prev => (Object.assign(Object.assign({}, prev), { [selectedTable]: getDefaultTableSettings() })));
                                }, className: "px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-medium" }, "\u30EA\u30BB\u30C3\u30C8")))),
                    showTableManagement && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-5xl w-full max-h-[90vh] overflow-y-auto" },
                            React.createElement("div", { className: "flex justify-between items-center mb-4" },
                                React.createElement("h3", { className: "text-2xl font-bold" }, "\uD83C\uDFE0 \u30C6\u30FC\u30D6\u30EB\u7BA1\u7406"),
                                React.createElement("button", { onClick: () => setShowTableManagement(false), className: "px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u9589\u3058\u308B")),
                            React.createElement("div", { className: "bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mb-4" },
                                React.createElement("div", { className: "font-bold mb-2" }, "\uD83D\uDCCC \u30C6\u30FC\u30D6\u30EB\u306B\u3064\u3044\u3066"),
                                React.createElement("div", { className: "text-sm text-gray-700" },
                                    "\u2022 \u30C6\u30FC\u30D6\u30EB\u3054\u3068\u306BQR\u30B3\u30FC\u30C9\u3092\u767A\u884C\u3067\u304D\u307E\u3059",
                                    React.createElement("br", null),
                                    "\u2022 \u304A\u5BA2\u69D8\u304CQR\u30B3\u30FC\u30C9\u304B\u3089\u6CE8\u6587\u3059\u308B\u3068\u3001\u305D\u306E\u30C6\u30FC\u30D6\u30EB\u306B\u6CE8\u6587\u304C\u5C4A\u304D\u307E\u3059",
                                    React.createElement("br", null),
                                    "\u2022 \u30C6\u30FC\u30D6\u30EB\u540D\u306F\u65E5\u672C\u8A9E\u30FB\u82F1\u6570\u5B57\u304C\u4F7F\u7528\u53EF\u80FD\u3067\u3059\uFF08\u4F8B: table1, A01, \u30C6\u30FC\u30D6\u30EB1\uFF09")),
                            React.createElement("div", { className: "space-y-2" },
                                React.createElement("h4", { className: "font-bold text-lg" },
                                    "\u767B\u9332\u6E08\u307F\u30C6\u30FC\u30D6\u30EB (",
                                    tables.length,
                                    "\u4EF6)"),
                                tables.map((table, index) => (React.createElement("div", { key: table.id, className: "flex items-center justify-between p-4 border-2 border-cyan-400 rounded-lg bg-white hover:bg-gray-50" },
                                    React.createElement("div", { className: "flex items-center gap-3" },
                                        React.createElement("div", { className: "flex flex-col gap-1" },
                                            React.createElement("button", { onClick: () => moveTable(index, index - 1), disabled: index === 0, className: `p-1 rounded ${index === 0 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0A\u306B\u79FB\u52D5" },
                                                React.createElement("svg", { width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
                                                    React.createElement("polyline", { points: "18 15 12 9 6 15" }))),
                                            React.createElement("button", { onClick: () => moveTable(index, index + 1), disabled: index === tables.length - 1, className: `p-1 rounded ${index === tables.length - 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0B\u306B\u79FB\u52D5" },
                                                React.createElement("svg", { width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
                                                    React.createElement("polyline", { points: "6 9 12 15 18 9" })))),
                                        React.createElement("div", null,
                                            React.createElement("div", { className: "font-bold text-lg" }, table.name),
                                            React.createElement("div", { className: "text-sm text-gray-600" },
                                                React.createElement("span", { className: `px-2 py-1 rounded ${table.memoEnabled ? 'bg-green-100' : 'bg-red-100'}` }, table.memoEnabled ? 'âœ“ ãƒ¡ãƒ¢æ©Ÿèƒ½: ON' : 'âœ— ãƒ¡ãƒ¢æ©Ÿèƒ½: OFF')))),
                                    React.createElement("div", { className: "flex gap-2" },
                                        React.createElement("button", { onClick: () => showQrCodeModal(table.name), className: "px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 font-bold" }, "QR"),
                                        React.createElement("button", { onClick: () => {
                                                setEditTableForm({
                                                    id: table.id,
                                                    name: table.name,
                                                    staffMemo: table.staffMemo || '',
                                                    memoEnabled: table.memoEnabled || false
                                                });
                                                setShowEditTable(true);
                                            }, className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold" }, "\u7DE8\u96C6"),
                                        React.createElement("button", { onClick: () => deleteTable(table.id, table.name), className: "px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-bold" }, "\u524A\u9664"))))),
                                tables.length === 0 && (React.createElement("div", { className: "text-center text-gray-500 py-8" }, "\u30C6\u30FC\u30D6\u30EB\u304C\u767B\u9332\u3055\u308C\u3066\u3044\u307E\u305B\u3093")))))),
                    showAddTable && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-2xl w-full" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "\u30C6\u30FC\u30D6\u30EB\u8FFD\u52A0"),
                            React.createElement("div", { className: "space-y-4" },
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30C6\u30FC\u30D6\u30EB\u540D *"),
                                    React.createElement("input", { type: "text", value: newTableForm.name, onChange: (e) => setNewTableForm(Object.assign(Object.assign({}, newTableForm), { name: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: table1, A01, \u30C6\u30FC\u30D6\u30EB1, \u4E88\u7D041" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u65E5\u672C\u8A9E\u30FB\u82F1\u6570\u5B57\u304C\u4F7F\u7528\u53EF\u80FD\u3067\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30B9\u30BF\u30C3\u30D5\u30E1\u30E2"),
                                    React.createElement("textarea", { value: newTableForm.staffMemo, onChange: (e) => setNewTableForm(Object.assign(Object.assign({}, newTableForm), { staffMemo: e.target.value })), rows: "3", className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4E88\u7D04\u306E\u8A73\u7D30\u3001\u304A\u5BA2\u69D8\u60C5\u5831\u306A\u3069\uFF08\u30B9\u30BF\u30C3\u30D5\u5C02\u7528\uFF09" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u3053\u306E\u30E1\u30E2\u306F\u30B9\u30BF\u30C3\u30D5\u306E\u307F\u78BA\u8A8D\u3067\u304D\u307E\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u304A\u5BA2\u69D8\u30E1\u30E2\u6A5F\u80FD"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                                            React.createElement("input", { type: "radio", checked: newTableForm.memoEnabled === true, onChange: () => setNewTableForm(Object.assign(Object.assign({}, newTableForm), { memoEnabled: true })), className: "w-5 h-5" }),
                                            React.createElement("span", null, "\u5FC5\u8981")),
                                        React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                                            React.createElement("input", { type: "radio", checked: newTableForm.memoEnabled === false, onChange: () => setNewTableForm(Object.assign(Object.assign({}, newTableForm), { memoEnabled: false })), className: "w-5 h-5" }),
                                            React.createElement("span", null, "\u4E0D\u8981"))),
                                    React.createElement("small", { className: "text-gray-600" }, "\u304A\u5BA2\u69D8\u304C\u6CE8\u6587\u6642\u306B\u30E1\u30E2\u3092\u5165\u529B\u3067\u304D\u308B\u3088\u3046\u306B\u3057\u307E\u3059"))),
                            React.createElement("div", { className: "flex gap-3 mt-6" },
                                React.createElement("button", { onClick: addTable, className: "flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u8FFD\u52A0"),
                                React.createElement("button", { onClick: () => {
                                        setShowAddTable(false);
                                        setNewTableForm({ name: '', staffMemo: '', memoEnabled: false });
                                    }, className: "flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u30AD\u30E3\u30F3\u30BB\u30EB"))))),
                    showEditTable && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-2xl w-full" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "\u30C6\u30FC\u30D6\u30EB\u7DE8\u96C6"),
                            React.createElement("div", { className: "space-y-4" },
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30C6\u30FC\u30D6\u30EB\u540D *"),
                                    React.createElement("input", { type: "text", value: editTableForm.name, onChange: (e) => setEditTableForm(Object.assign(Object.assign({}, editTableForm), { name: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: table1, A01, \u30C6\u30FC\u30D6\u30EB1, \u4E88\u7D041" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u65E5\u672C\u8A9E\u30FB\u82F1\u6570\u5B57\u304C\u4F7F\u7528\u53EF\u80FD\u3067\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30B9\u30BF\u30C3\u30D5\u30E1\u30E2"),
                                    React.createElement("textarea", { value: editTableForm.staffMemo, onChange: (e) => setEditTableForm(Object.assign(Object.assign({}, editTableForm), { staffMemo: e.target.value })), rows: "3", className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4E88\u7D04\u306E\u8A73\u7D30\u3001\u304A\u5BA2\u69D8\u60C5\u5831\u306A\u3069\uFF08\u30B9\u30BF\u30C3\u30D5\u5C02\u7528\uFF09" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u3053\u306E\u30E1\u30E2\u306F\u30B9\u30BF\u30C3\u30D5\u306E\u307F\u78BA\u8A8D\u3067\u304D\u307E\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u304A\u5BA2\u69D8\u30E1\u30E2\u6A5F\u80FD"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                                            React.createElement("input", { type: "radio", checked: editTableForm.memoEnabled === true, onChange: () => setEditTableForm(Object.assign(Object.assign({}, editTableForm), { memoEnabled: true })), className: "w-5 h-5" }),
                                            React.createElement("span", null, "\u5FC5\u8981")),
                                        React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                                            React.createElement("input", { type: "radio", checked: editTableForm.memoEnabled === false, onChange: () => setEditTableForm(Object.assign(Object.assign({}, editTableForm), { memoEnabled: false })), className: "w-5 h-5" }),
                                            React.createElement("span", null, "\u4E0D\u8981"))))),
                            React.createElement("div", { className: "flex gap-3 mt-6" },
                                React.createElement("button", { onClick: updateTable, className: "flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u4FDD\u5B58"),
                                React.createElement("button", { onClick: () => setShowEditTable(false), className: "flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u30AD\u30E3\u30F3\u30BB\u30EB"))))),
                    showQrCode && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-lg w-full text-center" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" },
                                qrCodeData.name,
                                " - QR\u30B3\u30FC\u30C9"),
                            React.createElement("div", { className: "my-6 p-4 bg-gray-100 rounded-lg" },
                                React.createElement("div", { className: "font-bold mb-2" }, "\u6CE8\u6587URL:"),
                                React.createElement("div", { className: "text-sm text-gray-700 break-all" }, qrCodeData.url)),
                            React.createElement("div", { className: "bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4" },
                                React.createElement("div", { className: "font-bold mb-2" }, "\uD83D\uDCCC QR\u30B3\u30FC\u30C9\u751F\u6210\u65B9\u6CD5"),
                                React.createElement("div", { className: "text-sm text-left text-gray-700" },
                                    "\u4E0A\u8A18\u306EURL\u3092\u4EE5\u4E0B\u306E\u30B5\u30A4\u30C8\u306B\u5165\u529B\u3057\u3066QR\u30B3\u30FC\u30C9\u3092\u751F\u6210\u3057\u3066\u304F\u3060\u3055\u3044:",
                                    React.createElement("br", null),
                                    "\u2022 ",
                                    React.createElement("a", { href: "https://www.qr-code-generator.com/", target: "_blank", className: "text-blue-500 underline" }, "qr-code-generator.com"),
                                    React.createElement("br", null),
                                    "\u2022 ",
                                    React.createElement("a", { href: "https://www.the-qrcode-generator.com/", target: "_blank", className: "text-blue-500 underline" }, "the-qrcode-generator.com"))),
                            React.createElement("button", { onClick: () => setShowQrCode(false), className: "w-full px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u9589\u3058\u308B"))))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u5546\u54C1\u7BA1\u7406"),
                    React.createElement("button", { onClick: () => {
                            setShowProductManagement(!showProductManagement);
                            if (!showProductManagement) {
                                loadMenuItems();
                            }
                        }, className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showProductManagement ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showProductManagement && (React.createElement("div", { className: "space-y-4 border-t pt-4" },
                    React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                        React.createElement("button", { onClick: () => {
                                setShowProductRegistration(true);
                                setProductForm({
                                    name: '',
                                    price: '',
                                    category: '',
                                    customCategory: '',
                                    note: '',
                                    image: '',
                                    taxRate: 10
                                });
                                setProductToppingSets([]);
                            }, className: "px-6 py-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold text-lg" }, "\uD83D\uDCDD \u5546\u54C1\u767B\u9332"),
                        React.createElement("button", { onClick: () => {
                                setShowProductEdit(true);
                                setEditingProductId(null);
                                loadProductsForEdit();
                            }, className: "px-6 py-4 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold text-lg" }, "\u270F\uFE0F \u5546\u54C1\u7DE8\u96C6"),
                        React.createElement("button", { onClick: () => {
                                setShowProductDelete(true);
                                loadProductsForDelete();
                            }, className: "px-6 py-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-bold text-lg" }, "\uD83D\uDC41\uFE0F \u5546\u54C1\u975E\u8868\u793A\u30FB\u5FA9\u5143")),
                    showProductRegistration && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "\u5546\u54C1\u767B\u9332"),
                            React.createElement("div", { className: "space-y-4" },
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u540D"),
                                    React.createElement("input", { type: "text", value: productForm.name, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { name: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: \u305F\u3053\u713C\u304D 6\u500B\u5165\u308A" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u4FA1\u683C"),
                                    React.createElement("input", { type: "number", value: productForm.price, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { price: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: 500" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30AB\u30C6\u30B4\u30EA"),
                                    React.createElement("select", { value: productForm.category, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { category: e.target.value })), className: "w-full p-3 border-2 rounded-lg" },
                                        React.createElement("option", { value: "" }, "\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044"),
                                        Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(cat => (React.createElement("option", { key: cat, value: cat }, cat))))),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30AB\u30B9\u30BF\u30E0\u30AB\u30C6\u30B4\u30EA\uFF08\u30D7\u30EB\u30C0\u30A6\u30F3\u306B\u306A\u3044\u5834\u5408\uFF09"),
                                    React.createElement("input", { type: "text", value: productForm.customCategory, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { customCategory: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u65B0\u3057\u3044\u30AB\u30C6\u30B4\u30EA\u540D" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "note"),
                                    React.createElement("input", { type: "text", value: productForm.note, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { note: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u5546\u54C1\u540D\u306E\u4E0B\u306B\u8868\u793A\u3059\u308B\u6587\u5B57" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u533A\u5206"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1 bg-green-50" },
                                            React.createElement("input", { type: "radio", checked: productForm.foodType === 'food' || !productForm.foodType, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { foodType: 'food' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u98DF\u6750")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.foodType === 'non-food', onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { foodType: 'non-food', taxRate: 10 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u98DF\u6750\u4EE5\u5916")))),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u6D88\u8CBB\u7A0E\u7387"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxRate === 8, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxRate: 8 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "8%")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxRate === 10, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxRate: 10 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "10%"))),
                                    React.createElement("small", { className: "text-gray-600 mt-2 block" }, "\u30C6\u30FC\u30D6\u30EB\u306B\u6D88\u8CBB\u7A0E\u30EB\u30FC\u30EB\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u306A\u3044\u5834\u5408\u306B\u4F7F\u7528\u3055\u308C\u307E\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u7A0E\u8FBC/\u7A0E\u629C"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1 bg-blue-50" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxType === 'inclusive' || !productForm.taxType, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxType: 'inclusive' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u5185\u7A0E\uFF08\u7A0E\u8FBC\u4FA1\u683C\uFF09")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxType === 'exclusive', onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxType: 'exclusive' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u5916\u7A0E\uFF08\u7A0E\u629C\u4FA1\u683C\uFF09"))),
                                    React.createElement("small", { className: "text-gray-600 mt-2 block" }, (productForm.taxType === 'inclusive' || !productForm.taxType)
                                        ? 'å…¥åŠ›ã—ãŸä¾¡æ ¼ãŒç¨è¾¼ä¾¡æ ¼ã«ãªã‚Šã¾ã™ï¼ˆä¾‹: 500å†† â†’ ãŠå®¢æ§˜æ”¯æ‰•ã„ 500å††ï¼‰'
                                        : 'å…¥åŠ›ã—ãŸä¾¡æ ¼ã«æ¶ˆè²»ç¨ãŒåŠ ç®—ã•ã‚Œã¾ã™ï¼ˆä¾‹: 500å†† â†’ ãŠå®¢æ§˜æ”¯æ‰•ã„ 550å††ï¼‰')),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u753B\u50CF\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9"),
                                    React.createElement("input", { type: "file", id: "productImageFile", accept: "image/*", className: "w-full p-3 border-2 rounded-lg mb-2" }),
                                    React.createElement("button", { type: "button", onClick: () => uploadProductImage('productImageFile', 'upload-progress', 'image-preview', 'productImage'), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold" }, "\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9"),
                                    React.createElement("div", { id: "upload-progress", className: "mt-2 font-bold" }),
                                    React.createElement("div", { id: "image-preview", className: "mt-2" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u307E\u305F\u306F\u753B\u50CFURL\u3092\u76F4\u63A5\u5165\u529B"),
                                    React.createElement("input", { type: "text", value: productForm.image, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { image: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: https://... \u307E\u305F\u306F takoyaki1.jpg" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3057\u305F\u753B\u50CF\u306EURL\u304C\u81EA\u52D5\u7684\u306B\u5165\u529B\u3055\u308C\u307E\u3059")),
                                React.createElement("div", { className: "bg-gray-50 p-4 rounded-lg" },
                                    React.createElement("h4", { className: "font-bold mb-3" }, "\u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8"),
                                    React.createElement("div", { className: "space-y-3" }, productToppingSets.map((set, setIndex) => (React.createElement("div", { key: setIndex, className: "bg-white p-4 rounded border-2" },
                                        React.createElement("div", { className: "flex justify-between items-center mb-3" },
                                            React.createElement("h5", { className: "font-bold" },
                                                "\u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8 ",
                                                setIndex + 1),
                                            React.createElement("button", { onClick: () => removeToppingSet(setIndex), className: "px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600" }, "\u524A\u9664")),
                                        React.createElement("div", { className: "space-y-2" },
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u30BB\u30C3\u30C8\u540D"),
                                                React.createElement("input", { type: "text", value: set.name, onChange: (e) => updateToppingSetName(setIndex, e.target.value), className: "w-full p-2 border rounded", placeholder: "\u4F8B: \u305F\u3053\u713C\u304D\u306E\u5473" })),
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u9078\u629E\u30BF\u30A4\u30D7"),
                                                React.createElement("select", { value: set.type, onChange: (e) => updateToppingSetType(setIndex, e.target.value), className: "w-full p-2 border rounded" },
                                                    React.createElement("option", { value: "single" }, "\u5358\u4E00\u9078\u629E\uFF08\u30D7\u30EB\u30C0\u30A6\u30F3\uFF09"),
                                                    React.createElement("option", { value: "multiple" }, "\u8907\u6570\u9078\u629E\uFF08\u30C1\u30A7\u30C3\u30AF\u30DC\u30C3\u30AF\u30B9\uFF09"))),
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u30C8\u30C3\u30D4\u30F3\u30B0\u9805\u76EE"),
                                                React.createElement("div", { className: "space-y-2" }, set.options.map((option, optionIndex) => (React.createElement("div", { key: optionIndex, className: "flex gap-2" },
                                                    React.createElement("input", { type: "text", value: option.name, onChange: (e) => updateToppingOption(setIndex, optionIndex, 'name', e.target.value), className: "flex-1 p-2 border rounded", placeholder: "\u4F8B: \u30BD\u30FC\u30B9" }),
                                                    React.createElement("input", { type: "number", value: option.price, onChange: (e) => updateToppingOption(setIndex, optionIndex, 'price', parseInt(e.target.value) || 0), className: "w-24 p-2 border rounded", placeholder: "\u4FA1\u683C" }),
                                                    React.createElement("button", { onClick: () => removeToppingOption(setIndex, optionIndex), className: "px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600" }, "\u00D7"))))),
                                                React.createElement("button", { onClick: () => addToppingOption(setIndex), className: "mt-2 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm" }, "+ \u9805\u76EE\u3092\u8FFD\u52A0"))))))),
                                    React.createElement("button", { onClick: addToppingSet, className: "mt-3 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600" }, "+ \u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8\u3092\u8FFD\u52A0"))),
                            React.createElement("div", { className: "flex gap-3 mt-6" },
                                React.createElement("button", { onClick: registerProduct, className: "flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u767B\u9332"),
                                React.createElement("button", { onClick: () => setShowProductRegistration(false), className: "flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u30AD\u30E3\u30F3\u30BB\u30EB"))))),
                    showProductDelete && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-2" }, "\u5546\u54C1\u7BA1\u7406\uFF08\u975E\u8868\u793A\u30FB\u5FA9\u5143\uFF09"),
                            React.createElement("p", { className: "text-sm text-gray-500 mb-4" }, "\u5546\u54C1\u3092\u300C\u975E\u8868\u793A\u300D\u306B\u3059\u308B\u3068\u3001\u30E1\u30CB\u30E5\u30FC\u304B\u3089\u898B\u3048\u306A\u304F\u306A\u308A\u307E\u3059\u304C\u3001\u5F8C\u304B\u3089\u300C\u5FA9\u5143\u300D\u3067\u304D\u307E\u3059\u3002"),
                            React.createElement("div", { className: "flex gap-2 mb-4" },
                                React.createElement("button", { onClick: () => setDeleteTab('active'), className: `flex-1 py-2 px-4 rounded-lg font-bold text-sm ${deleteTab === 'active' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}` },
                                    "\u8868\u793A\u4E2D\u306E\u5546\u54C1\uFF08",
                                    productsForDelete.filter(p => !p.hidden).length,
                                    "\u4EF6\uFF09"),
                                React.createElement("button", { onClick: () => setDeleteTab('hidden'), className: `flex-1 py-2 px-4 rounded-lg font-bold text-sm ${deleteTab === 'hidden' ? 'bg-orange-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}` },
                                    "\u975E\u8868\u793A\u4E2D\u306E\u5546\u54C1\uFF08",
                                    productsForDelete.filter(p => p.hidden).length,
                                    "\u4EF6\uFF09")),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("input", { type: "text", value: productSearchQuery, onChange: (e) => setProductSearchQuery(e.target.value), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u5546\u54C1\u540D\u3067\u691C\u7D22..." })),
                            React.createElement("div", { className: "space-y-2 max-h-[500px] overflow-y-auto" }, productsForDelete
                                .filter(p => deleteTab === 'active' ? !p.hidden : p.hidden)
                                .filter(product => productSearchQuery === '' ||
                                product.name.toLowerCase().includes(productSearchQuery.toLowerCase()))
                                .map(product => {
                                var _a;
                                return (React.createElement("div", { key: product.docId, className: `flex justify-between items-center p-4 border-2 rounded-lg ${product.hidden ? 'bg-orange-50 border-orange-200' : 'hover:bg-gray-50'}` },
                                    React.createElement("div", null,
                                        React.createElement("div", { className: "flex items-center gap-2" },
                                            React.createElement("div", { className: "font-bold text-lg" }, product.name),
                                            product.hidden && React.createElement("span", { className: "text-xs bg-orange-200 text-orange-700 px-2 py-0.5 rounded font-bold" }, "\u975E\u8868\u793A\u4E2D")),
                                        React.createElement("div", { className: "text-sm text-gray-600" },
                                            React.createElement("span", { className: "bg-blue-100 px-2 py-1 rounded mr-2" }, product.category),
                                            React.createElement("span", { className: "text-green-600 font-bold" },
                                                "\u00A5", (_a = product.price) === null || _a === void 0 ? void 0 :
                                                _a.toLocaleString()))),
                                    product.hidden ? (React.createElement("button", { onClick: () => restoreProduct(product.docId, product.name), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold" }, "\uD83D\uDD04 \u5FA9\u5143")) : (React.createElement("button", { onClick: () => deleteProduct(product.docId, product.name), className: "px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-bold" }, "\uD83D\uDC41\uFE0F \u975E\u8868\u793A"))));
                            })),
                            React.createElement("button", { onClick: () => setShowProductDelete(false), className: "w-full mt-4 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u9589\u3058\u308B")))),
                    showProductEdit && !editingProductId && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "\u5546\u54C1\u7DE8\u96C6 - \u5546\u54C1\u3092\u9078\u629E"),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("input", { type: "text", value: editSearchQuery, onChange: (e) => setEditSearchQuery(e.target.value), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u5546\u54C1\u540D\u3067\u691C\u7D22..." })),
                            React.createElement("div", { className: "space-y-2 max-h-[500px] overflow-y-auto" }, productsForEdit
                                .filter(product => editSearchQuery === '' ||
                                product.name.toLowerCase().includes(editSearchQuery.toLowerCase()))
                                .map(product => {
                                var _a;
                                return (React.createElement("div", { key: product.docId, className: "flex justify-between items-center p-4 border-2 rounded-lg hover:bg-gray-50" },
                                    React.createElement("div", null,
                                        React.createElement("div", { className: "font-bold text-lg" }, product.name),
                                        React.createElement("div", { className: "text-sm text-gray-600" },
                                            React.createElement("span", { className: "bg-blue-100 px-2 py-1 rounded mr-2" }, product.category),
                                            React.createElement("span", { className: "text-green-600 font-bold" },
                                                "\u00A5", (_a = product.price) === null || _a === void 0 ? void 0 :
                                                _a.toLocaleString()))),
                                    React.createElement("button", { onClick: () => openEditProduct(product), className: "px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u270F\uFE0F \u7DE8\u96C6")));
                            })),
                            React.createElement("button", { onClick: () => {
                                    setShowProductEdit(false);
                                    setEditSearchQuery('');
                                }, className: "w-full mt-4 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u9589\u3058\u308B")))),
                    showProductEdit && editingProductId && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                        React.createElement("div", { className: "bg-white rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" },
                            React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "\u5546\u54C1\u7DE8\u96C6"),
                            React.createElement("div", { className: "space-y-4" },
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u540D"),
                                    React.createElement("input", { type: "text", value: productForm.name, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { name: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: \u305F\u3053\u713C\u304D 6\u500B\u5165\u308A" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u4FA1\u683C"),
                                    React.createElement("input", { type: "number", value: productForm.price, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { price: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: 500" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30AB\u30C6\u30B4\u30EA"),
                                    React.createElement("select", { value: productForm.category, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { category: e.target.value })), className: "w-full p-3 border-2 rounded-lg" },
                                        React.createElement("option", { value: "" }, "\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044"),
                                        Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(cat => (React.createElement("option", { key: cat, value: cat }, cat))))),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30AB\u30B9\u30BF\u30E0\u30AB\u30C6\u30B4\u30EA\uFF08\u30D7\u30EB\u30C0\u30A6\u30F3\u306B\u306A\u3044\u5834\u5408\uFF09"),
                                    React.createElement("input", { type: "text", value: productForm.customCategory, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { customCategory: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u65B0\u3057\u3044\u30AB\u30C6\u30B4\u30EA\u540D" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "note"),
                                    React.createElement("input", { type: "text", value: productForm.note, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { note: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u5546\u54C1\u540D\u306E\u4E0B\u306B\u8868\u793A\u3059\u308B\u6587\u5B57" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u533A\u5206"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1 bg-green-50" },
                                            React.createElement("input", { type: "radio", checked: productForm.foodType === 'food' || !productForm.foodType, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { foodType: 'food' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u98DF\u6750")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.foodType === 'non-food', onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { foodType: 'non-food', taxRate: 10 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u98DF\u6750\u4EE5\u5916")))),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u6D88\u8CBB\u7A0E\u7387"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxRate === 8, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxRate: 8 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "8%")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxRate === 10, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxRate: 10 })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "10%"))),
                                    React.createElement("small", { className: "text-gray-600 mt-2 block" }, "\u30C6\u30FC\u30D6\u30EB\u306B\u6D88\u8CBB\u7A0E\u30EB\u30FC\u30EB\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u306A\u3044\u5834\u5408\u306B\u4F7F\u7528\u3055\u308C\u307E\u3059")),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u7A0E\u8FBC/\u7A0E\u629C"),
                                    React.createElement("div", { className: "flex gap-4" },
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1 bg-blue-50" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxType === 'inclusive' || !productForm.taxType, onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxType: 'inclusive' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u5185\u7A0E\uFF08\u7A0E\u8FBC\u4FA1\u683C\uFF09")),
                                        React.createElement("label", { className: "flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer flex-1" },
                                            React.createElement("input", { type: "radio", checked: productForm.taxType === 'exclusive', onChange: () => setProductForm(Object.assign(Object.assign({}, productForm), { taxType: 'exclusive' })), className: "w-5 h-5" }),
                                            React.createElement("span", { className: "font-bold" }, "\u5916\u7A0E\uFF08\u7A0E\u629C\u4FA1\u683C\uFF09"))),
                                    React.createElement("small", { className: "text-gray-600 mt-2 block" }, (productForm.taxType === 'inclusive' || !productForm.taxType)
                                        ? 'å…¥åŠ›ã—ãŸä¾¡æ ¼ãŒç¨è¾¼ä¾¡æ ¼ã«ãªã‚Šã¾ã™ï¼ˆä¾‹: 500å†† â†’ ãŠå®¢æ§˜æ”¯æ‰•ã„ 500å††ï¼‰'
                                        : 'å…¥åŠ›ã—ãŸä¾¡æ ¼ã«æ¶ˆè²»ç¨ãŒåŠ ç®—ã•ã‚Œã¾ã™ï¼ˆä¾‹: 500å†† â†’ ãŠå®¢æ§˜æ”¯æ‰•ã„ 550å††ï¼‰')),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u5546\u54C1\u753B\u50CF\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9"),
                                    React.createElement("input", { type: "file", id: "editProductImageFile", accept: "image/*", className: "w-full p-3 border-2 rounded-lg mb-2" }),
                                    React.createElement("button", { type: "button", onClick: () => uploadProductImage('editProductImageFile', 'edit-upload-progress', 'edit-image-preview', 'editProductImage'), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold" }, "\uD83D\uDCE4 \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9"),
                                    React.createElement("div", { id: "edit-upload-progress", className: "mt-2 font-bold" }),
                                    React.createElement("div", { id: "edit-image-preview", className: "mt-2" })),
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block font-bold mb-2" }, "\u307E\u305F\u306F\u753B\u50CFURL\u3092\u76F4\u63A5\u5165\u529B"),
                                    React.createElement("input", { type: "text", value: productForm.image, onChange: (e) => setProductForm(Object.assign(Object.assign({}, productForm), { image: e.target.value })), className: "w-full p-3 border-2 rounded-lg", placeholder: "\u4F8B: https://... \u307E\u305F\u306F takoyaki1.jpg" }),
                                    React.createElement("small", { className: "text-gray-600" }, "\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3057\u305F\u753B\u50CF\u306EURL\u304C\u81EA\u52D5\u7684\u306B\u5165\u529B\u3055\u308C\u307E\u3059")),
                                React.createElement("div", { className: "bg-gray-50 p-4 rounded-lg" },
                                    React.createElement("h4", { className: "font-bold mb-3" }, "\u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8"),
                                    React.createElement("div", { className: "space-y-3" }, productToppingSets.map((set, setIndex) => (React.createElement("div", { key: setIndex, className: "bg-white p-4 rounded border-2" },
                                        React.createElement("div", { className: "flex justify-between items-center mb-3" },
                                            React.createElement("h5", { className: "font-bold" },
                                                "\u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8 ",
                                                setIndex + 1),
                                            React.createElement("button", { onClick: () => removeToppingSet(setIndex), className: "px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600" }, "\u524A\u9664")),
                                        React.createElement("div", { className: "space-y-2" },
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u30BB\u30C3\u30C8\u540D"),
                                                React.createElement("input", { type: "text", value: set.name, onChange: (e) => updateToppingSetName(setIndex, e.target.value), className: "w-full p-2 border rounded", placeholder: "\u4F8B: \u305F\u3053\u713C\u304D\u306E\u5473" })),
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u9078\u629E\u30BF\u30A4\u30D7"),
                                                React.createElement("select", { value: set.type, onChange: (e) => updateToppingSetType(setIndex, e.target.value), className: "w-full p-2 border rounded" },
                                                    React.createElement("option", { value: "single" }, "\u5358\u4E00\u9078\u629E\uFF08\u30D7\u30EB\u30C0\u30A6\u30F3\uFF09"),
                                                    React.createElement("option", { value: "multiple" }, "\u8907\u6570\u9078\u629E\uFF08\u30C1\u30A7\u30C3\u30AF\u30DC\u30C3\u30AF\u30B9\uFF09"))),
                                            React.createElement("div", null,
                                                React.createElement("label", { className: "block text-sm font-bold mb-1" }, "\u30C8\u30C3\u30D4\u30F3\u30B0\u9805\u76EE"),
                                                React.createElement("div", { className: "space-y-2" }, set.options.map((option, optionIndex) => (React.createElement("div", { key: optionIndex, className: "flex gap-2" },
                                                    React.createElement("input", { type: "text", value: option.name, onChange: (e) => updateToppingOption(setIndex, optionIndex, 'name', e.target.value), className: "flex-1 p-2 border rounded", placeholder: "\u4F8B: \u30BD\u30FC\u30B9" }),
                                                    React.createElement("input", { type: "number", value: option.price, onChange: (e) => updateToppingOption(setIndex, optionIndex, 'price', parseInt(e.target.value) || 0), className: "w-24 p-2 border rounded", placeholder: "\u4FA1\u683C" }),
                                                    React.createElement("button", { onClick: () => removeToppingOption(setIndex, optionIndex), className: "px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600" }, "\u00D7"))))),
                                                React.createElement("button", { onClick: () => addToppingOption(setIndex), className: "mt-2 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm" }, "+ \u9805\u76EE\u3092\u8FFD\u52A0"))))))),
                                    React.createElement("button", { onClick: addToppingSet, className: "mt-3 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600" }, "+ \u30C8\u30C3\u30D4\u30F3\u30B0\u30BB\u30C3\u30C8\u3092\u8FFD\u52A0"))),
                            React.createElement("div", { className: "flex gap-3 mt-6" },
                                React.createElement("button", { onClick: updateProduct, className: "flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u66F4\u65B0"),
                                React.createElement("button", { onClick: () => {
                                        setEditingProductId(null);
                                        setProductForm({
                                            name: '',
                                            price: '',
                                            category: '',
                                            customCategory: '',
                                            note: '',
                                            image: '',
                                            taxRate: 10
                                        });
                                        setProductToppingSets([]);
                                    }, className: "px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u623B\u308B"),
                                React.createElement("button", { onClick: () => {
                                        setShowProductEdit(false);
                                        setEditingProductId(null);
                                        setEditSearchQuery('');
                                    }, className: "px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u9589\u3058\u308B")))))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u30E1\u30CB\u30E5\u30FC\u8868\u793A\u9806\u8A2D\u5B9A"),
                    React.createElement("button", { onClick: () => setShowMenuManagement(!showMenuManagement), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showMenuManagement ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showMenuManagement && (React.createElement("div", { className: "space-y-6 border-t pt-4" },
                    React.createElement("div", { className: "border-l-4 border-orange-500 pl-4" },
                        React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u30E1\u30CB\u30E5\u30FC\u306E\u8868\u793A\u9806\u8A2D\u5B9A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mb-4" }, "menu.html\u3067\u306E\u30E1\u30CB\u30E5\u30FC\u8868\u793A\u9806\u3092\u8A2D\u5B9A\u3057\u307E\u3059\uFF08\u30AB\u30C6\u30B4\u30EA\u3054\u3068\u306B\u8A2D\u5B9A\u53EF\u80FD\uFF09"),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u30AB\u30C6\u30B4\u30EA\u3092\u9078\u629E"),
                            React.createElement("select", { value: menuManagementCategory, onChange: (e) => setMenuManagementCategory(e.target.value), className: "w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" },
                                React.createElement("option", { value: "all" }, "\u3059\u3079\u3066\u306E\u30AB\u30C6\u30B4\u30EA"),
                                Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(cat => (React.createElement("option", { key: cat, value: cat }, cat))))),
                        React.createElement("button", { onClick: initializeMenuOrder, className: "mb-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600" }, "\u3053\u306E\u30AB\u30C6\u30B4\u30EA\u306E\u9806\u5E8F\u3092\u8AAD\u307F\u8FBC\u3080"),
                        globalMenuSettings.menuOrder.length > 0 && (React.createElement("div", { className: "bg-blue-50 border-2 border-blue-300 rounded-lg p-4" },
                            React.createElement("h5", { className: "font-medium mb-2 text-blue-900" },
                                "\u8868\u793A\u9806\uFF08",
                                globalMenuSettings.menuOrder.length,
                                "\u4EF6\uFF09"),
                            React.createElement("div", { className: "text-xs text-blue-700 mb-2" }, "\u2191\u2193\u30DC\u30BF\u30F3\u3067\u9806\u5E8F\u3092\u5909\u66F4\u3067\u304D\u307E\u3059"),
                            React.createElement("div", { className: "space-y-2 max-h-96 overflow-y-auto" }, globalMenuSettings.menuOrder.map((itemId, index) => {
                                var _a;
                                const item = availableMenuItems.find(m => m.id === itemId);
                                if (!item)
                                    return null;
                                return (React.createElement("div", { key: itemId, className: "flex items-center gap-2 bg-white p-3 rounded border" },
                                    React.createElement("div", { className: "flex flex-col gap-1" },
                                        React.createElement("button", { onClick: () => moveGlobalMenuItem(index, index - 1), disabled: index === 0, className: `p-1 rounded ${index === 0 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0A\u306B\u79FB\u52D5" },
                                            React.createElement("svg", { width: "12", height: "12", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "3" },
                                                React.createElement("polyline", { points: "18 15 12 9 6 15" }))),
                                        React.createElement("button", { onClick: () => moveGlobalMenuItem(index, index + 1), disabled: index === globalMenuSettings.menuOrder.length - 1, className: `p-1 rounded ${index === globalMenuSettings.menuOrder.length - 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0B\u306B\u79FB\u52D5" },
                                            React.createElement("svg", { width: "12", height: "12", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "3" },
                                                React.createElement("polyline", { points: "6 9 12 15 18 9" })))),
                                    React.createElement("div", { className: "flex-1" },
                                        React.createElement("div", { className: "font-medium text-sm" },
                                            index + 1,
                                            ". ",
                                            item.name),
                                        React.createElement("div", { className: "text-xs text-gray-600" },
                                            item.category,
                                            " - \u00A5",
                                            ((_a = availableMenuItems.find(m => m.id === itemId)) === null || _a === void 0 ? void 0 : _a.price) || '???'))));
                            })))),
                        globalMenuSettings.menuOrder.length === 0 && (React.createElement("div", { className: "text-center text-gray-500 py-8 bg-gray-50 rounded-lg" }, "\u30AB\u30C6\u30B4\u30EA\u3092\u9078\u629E\u3057\u3066\u300C\u3053\u306E\u30AB\u30C6\u30B4\u30EA\u306E\u9806\u5E8F\u3092\u8AAD\u307F\u8FBC\u3080\u300D\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u304F\u3060\u3055\u3044"))),
                    React.createElement("div", { className: "flex gap-3 justify-end sticky bottom-0 bg-white pt-3 border-t" },
                        React.createElement("button", { onClick: saveGlobalMenuSettings, className: "px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium text-lg" }, "\u4FDD\u5B58"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u6CE8\u6587\u756A\u53F7\u8868\u793A\u753B\u9762\u306E\u8868\u793A\u30E1\u30C3\u30BB\u30FC\u30B8\u8A2D\u5B9A"),
                    React.createElement("button", { onClick: () => setShowMenuSettings(!showMenuSettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showMenuSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showMenuSettings && (React.createElement("div", { className: "space-y-4 border-t pt-4" },
                    React.createElement("div", { className: "border-l-4 border-green-500 pl-4 mt-6" },
                        React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\u8868\u793A\u30E1\u30C3\u30BB\u30FC\u30B8\u306E\u30AB\u30B9\u30BF\u30DE\u30A4\u30BA"),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "block text-md font-medium mb-2" }, "\u6CE8\u6587\u756A\u53F7\u753B\u9762\u306E\u6848\u5185\u6587"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-2" }, "\u6CE8\u6587\u756A\u53F7\u306E\u4E0B\u306B\u8868\u793A\u3055\u308C\u308B\u6848\u5185\u6587\uFF08\u7A7A\u6B04\u3067\u975E\u8868\u793A\uFF09"),
                            React.createElement("textarea", { value: menuSettings.statusMessage || '', onChange: (e) => setMenuSettings(Object.assign(Object.assign({}, menuSettings), { statusMessage: e.target.value })), rows: "3", className: "w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none", placeholder: "\u4F8B: \u3053\u306E\u756A\u53F7\u3067\u304A\u547C\u3073\u3057\u307E\u3059\u306E\u3067\\n\u5546\u54C1\u3092\u53D7\u3051\u53D6\u308B\u307E\u3067\\n\u3053\u306E\u753B\u9762\u3092\u9589\u3058\u306A\u3044\u3067\u304F\u3060\u3055\u3044" })),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "block text-md font-medium mb-2" }, "\u91CD\u8981\u306A\u304A\u77E5\u3089\u305B\uFF08\u8B66\u544A\u6587\uFF09"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-2" }, "\u6CE8\u6587\u756A\u53F7\u753B\u9762\u306E\u4E0B\u90E8\u306B\u8868\u793A\u3055\u308C\u308B\u8B66\u544A\u6587\uFF08\u7A7A\u6B04\u3067\u975E\u8868\u793A\uFF09"),
                            React.createElement("textarea", { value: menuSettings.warningMessage || '', onChange: (e) => setMenuSettings(Object.assign(Object.assign({}, menuSettings), { warningMessage: e.target.value })), rows: "5", className: "w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none", placeholder: "\u4F8B: \u91CD\u8981\u306A\u304A\u77E5\u3089\u305B\\n\\n\u2022 \u5E2D\u3092\u5916\u3059\u969B\u306B\u306F\u5148\u306B\\n\u304A\u4F1A\u8A08\u3092\u6E08\u307E\u305B\u3066\u304F\u3060\u3055\u3044" }))),
                    React.createElement("div", { className: "border-l-4 border-blue-500 pl-4 mt-6" },
                        React.createElement("h3", { className: "text-lg font-bold mb-3" }, "\uD83D\uDECD\uFE0F \u30EC\u30B8\u888B\u8A2D\u5B9A"),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "flex items-center gap-3 p-3 bg-blue-50 rounded-lg cursor-pointer hover:bg-blue-100" },
                                React.createElement("input", { type: "checkbox", checked: (_3 = menuSettings.showBagOption) !== null && _3 !== void 0 ? _3 : true, onChange: (e) => setMenuSettings(Object.assign(Object.assign({}, menuSettings), { showBagOption: e.target.checked })), className: "w-5 h-5" }),
                                React.createElement("span", { className: "text-md font-medium" }, "\u30EC\u30B8\u888B\u30AA\u30D7\u30B7\u30E7\u30F3\u3092\u8868\u793A\u3059\u308B")),
                            React.createElement("p", { className: "text-sm text-gray-600 mt-2 ml-8" }, "\u30C1\u30A7\u30C3\u30AF\u3092\u5916\u3059\u3068\u3001\u6CE8\u6587\u753B\u9762\u3067\u30EC\u30B8\u888B\u9078\u629E\u304C\u975E\u8868\u793A\u306B\u306A\u308A\u307E\u3059")),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "block text-md font-medium mb-2" }, "\u30EC\u30B8\u888B\u306E\u4FA1\u683C\uFF081\u679A\uFF09"),
                            React.createElement("div", { className: "flex items-center gap-2" },
                                React.createElement("input", { type: "number", value: (_4 = menuSettings.bagPrice) !== null && _4 !== void 0 ? _4 : 3, onChange: (e) => setMenuSettings(Object.assign(Object.assign({}, menuSettings), { bagPrice: parseInt(e.target.value) || 0 })), className: "w-32 p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none", min: "0" }),
                                React.createElement("span", { className: "text-lg font-medium" }, "\u5186"))),
                        React.createElement("div", { className: "mb-4" },
                            React.createElement("label", { className: "block text-md font-medium mb-2" }, "\u8AAC\u660E\u30E1\u30C3\u30BB\u30FC\u30B8"),
                            React.createElement("p", { className: "text-sm text-gray-600 mb-2" }, "\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u8AAC\u660E\u6587\u3067\u3059"),
                            React.createElement("input", { type: "text", value: (_5 = menuSettings.bagMessage) !== null && _5 !== void 0 ? _5 : 'â€» 1æš3å•†å“ç¨‹åº¦å…¥ã‚Šã¾ã™', onChange: (e) => setMenuSettings(Object.assign(Object.assign({}, menuSettings), { bagMessage: e.target.value })), className: "w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none", placeholder: "\u4F8B: \u203B 1\u679A3\u5546\u54C1\u7A0B\u5EA6\u5165\u308A\u307E\u3059 / \u30EC\u30B8\u888B\u306E\u8CFC\u5165\u306F\u304A\u5FD8\u308C\u3067\u306F\u306A\u3044\u3067\u3059\u304B?" })),
                        menuSettings.showBagOption && (React.createElement("div", { className: "mt-4 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300" },
                            React.createElement("p", { className: "text-sm font-bold text-gray-700 mb-2" }, "\u30D7\u30EC\u30D3\u30E5\u30FC\uFF08\u304A\u5BA2\u69D8\u753B\u9762\uFF09:"),
                            React.createElement("div", { className: "bg-white rounded-lg p-4 shadow" },
                                React.createElement("div", { className: "font-bold text-gray-700 mb-2" }, "\uD83D\uDECD\uFE0F \u30EC\u30B8\u888B"),
                                React.createElement("div", { className: "text-sm text-gray-500 mb-2" }, menuSettings.bagMessage || 'â€» 1æš3å•†å“ç¨‹åº¦å…¥ã‚Šã¾ã™'),
                                React.createElement("div", { className: "text-sm text-gray-700" },
                                    "1\u679A \u00A5", (_6 = menuSettings.bagPrice) !== null && _6 !== void 0 ? _6 : 3))))),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveMenuSettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600" }, "\u4FDD\u5B58"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u30B9\u30C6\u30FC\u30BF\u30B9\u8868\u793A\u8A2D\u5B9A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mt-1" }, "\u6CE8\u6587\u753B\u9762\u306B\u8868\u793A\u3055\u308C\u308B\u30B9\u30C6\u30FC\u30BF\u30B9\u30C6\u30AD\u30B9\u30C8\u306E\u30AB\u30B9\u30BF\u30DE\u30A4\u30BA")),
                    React.createElement("button", { onClick: () => setShowStatusDisplaySettings(!showStatusDisplaySettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showStatusDisplaySettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showStatusDisplaySettings && (React.createElement("div", { className: "space-y-6 border-t pt-4" },
                    React.createElement("div", { className: "border-l-4 border-yellow-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-yellow-700" }, "\u6E96\u5099\u4E2D\u30B9\u30C6\u30FC\u30BF\u30B9"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u6CE8\u6587\u304C\u6E96\u5099\u4E2D\u306E\u3068\u304D\u306B\u8868\u793A\u3055\u308C\u308B\u30C6\u30AD\u30B9\u30C8\uFF08\u6539\u884C\u3059\u308B\u5834\u5408\u306F<br>\u30011\u884C\u7A7A\u3051\u308B\u5834\u5408\u306F<br><br>\u3092\u5165\u529B\uFF09"),
                        React.createElement("input", { type: "text", value: statusDisplaySettings.preparing, onChange: (e) => setStatusDisplaySettings(Object.assign(Object.assign({}, statusDisplaySettings), { preparing: e.target.value })), className: "w-full p-3 border rounded-lg", placeholder: "\u4F8B: \u305F\u3060\u4ECA\u6E96\u5099\u3057\u3066\u3044\u307E\u3059" })),
                    React.createElement("div", { className: "border-l-4 border-blue-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-blue-700" }, "\u4F1A\u8A08\u5B8C\u4E86\u30B9\u30C6\u30FC\u30BF\u30B9"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u4F1A\u8A08\u304C\u5B8C\u4E86\u3057\u305F\u3068\u304D\u306B\u8868\u793A\u3055\u308C\u308B\u30C6\u30AD\u30B9\u30C8\uFF08\u6539\u884C\u3059\u308B\u5834\u5408\u306F<br>\u30011\u884C\u7A7A\u3051\u308B\u5834\u5408\u306F<br><br>\u3092\u5165\u529B\uFF09"),
                        React.createElement("input", { type: "text", value: statusDisplaySettings.completed, onChange: (e) => setStatusDisplaySettings(Object.assign(Object.assign({}, statusDisplaySettings), { completed: e.target.value })), className: "w-full p-3 border rounded-lg", placeholder: "\u4F8B: \u4F1A\u8A08\u5B8C\u4E86\u3057\u307E\u3057\u305F" })),
                    React.createElement("div", { className: "border-l-4 border-green-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-green-700" }, "\u5546\u54C1\u5B8C\u6210\u30B9\u30C6\u30FC\u30BF\u30B9"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u5546\u54C1\u304C\u5B8C\u6210\u3057\u305F\u3068\u304D\u306B\u8868\u793A\u3055\u308C\u308B\u30C6\u30AD\u30B9\u30C8\uFF08\u6539\u884C\u3059\u308B\u5834\u5408\u306F<br>\u30011\u884C\u7A7A\u3051\u308B\u5834\u5408\u306F<br><br>\u3092\u5165\u529B\uFF09"),
                        React.createElement("input", { type: "text", value: statusDisplaySettings.ready, onChange: (e) => setStatusDisplaySettings(Object.assign(Object.assign({}, statusDisplaySettings), { ready: e.target.value })), className: "w-full p-3 border rounded-lg", placeholder: "\u4F8B: \u5546\u54C1\u304C\u3067\u304D\u307E\u3057\u305F" })),
                    React.createElement("div", { className: "border-l-4 border-red-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-red-700" }, "\u30AD\u30E3\u30F3\u30BB\u30EB\u30B9\u30C6\u30FC\u30BF\u30B9"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u6CE8\u6587\u304C\u30AD\u30E3\u30F3\u30BB\u30EB\u3055\u308C\u305F\u3068\u304D\u306B\u8868\u793A\u3055\u308C\u308B\u30C6\u30AD\u30B9\u30C8\uFF08\u6539\u884C\u3059\u308B\u5834\u5408\u306F<br>\u30011\u884C\u7A7A\u3051\u308B\u5834\u5408\u306F<br><br>\u3092\u5165\u529B\uFF09"),
                        React.createElement("input", { type: "text", value: statusDisplaySettings.cancelled, onChange: (e) => setStatusDisplaySettings(Object.assign(Object.assign({}, statusDisplaySettings), { cancelled: e.target.value })), className: "w-full p-3 border rounded-lg", placeholder: "\u4F8B: \u6CE8\u6587\u3092\u30AD\u30E3\u30F3\u30BB\u30EB\u3057\u307E\u3057\u305F" })),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveStatusDisplaySettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u4FDD\u5B58"),
                        React.createElement("button", { onClick: resetStatusDisplaySettings, className: "px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u306B\u623B\u3059"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u6CE8\u6587\u5B8C\u4E86\u30A2\u30E9\u30FC\u30C8\u8A2D\u5B9A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mt-1" }, "\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u30A2\u30E9\u30FC\u30C8\u30E1\u30C3\u30BB\u30FC\u30B8\u306E\u30AB\u30B9\u30BF\u30DE\u30A4\u30BA")),
                    React.createElement("button", { onClick: () => setShowAlertSettings(!showAlertSettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showAlertSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showAlertSettings && (React.createElement("div", { className: "space-y-6 border-t pt-4" },
                    React.createElement("div", { className: "border-l-4 border-green-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-green-700" }, "\u2705 \u5546\u54C1\u5B8C\u6210\u30A2\u30E9\u30FC\u30C8"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u5546\u54C1\u304C\u5B8C\u6210\u3057\u305F\u3068\u304D\u306B\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u30E1\u30C3\u30BB\u30FC\u30B8"),
                        React.createElement("textarea", { value: alertSettings.completeMessage, onChange: (e) => setAlertSettings(Object.assign(Object.assign({}, alertSettings), { completeMessage: e.target.value })), className: "w-full p-3 border rounded-lg font-mono text-sm", rows: "4", placeholder: "\u4F8B: \u5546\u54C1\u304C\u51FA\u6765\u4E0A\u304C\u308A\u307E\u3057\u305F\uFF01\\n\\n\u6CE8\u6587\u756A\u53F7 #{orderNumber}\\n\\n\u753B\u9762\u306E\u6CE8\u6587\u756A\u53F7\u3092\u5E97\u54E1\u306B\u304A\u898B\u305B\u304F\u3060\u3055\u3044" }),
                        React.createElement("p", { className: "text-xs text-blue-600 mt-1" },
                            "\uD83D\uDCA1 \u30D2\u30F3\u30C8: #",
                            '{',
                            "orderNumber",
                            '}',
                            " \u3068\u5165\u529B\u3059\u308B\u3068\u6CE8\u6587\u756A\u53F7\u306B\u7F6E\u304D\u63DB\u308F\u308A\u307E\u3059")),
                    React.createElement("div", { className: "border-l-4 border-red-500 pl-4" },
                        React.createElement("label", { className: "block text-md font-bold mb-2 text-red-700" }, "\u274C \u6CE8\u6587\u30AD\u30E3\u30F3\u30BB\u30EB\u30A2\u30E9\u30FC\u30C8"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u6CE8\u6587\u304C\u30AD\u30E3\u30F3\u30BB\u30EB\u3055\u308C\u305F\u3068\u304D\u306B\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u30E1\u30C3\u30BB\u30FC\u30B8"),
                        React.createElement("textarea", { value: alertSettings.cancelMessage, onChange: (e) => setAlertSettings(Object.assign(Object.assign({}, alertSettings), { cancelMessage: e.target.value })), className: "w-full p-3 border rounded-lg font-mono text-sm", rows: "4", placeholder: "\u4F8B: \u6CE8\u6587\u304C\u30AD\u30E3\u30F3\u30BB\u30EB\u3055\u308C\u307E\u3057\u305F" }),
                        React.createElement("p", { className: "text-xs text-blue-600 mt-1" },
                            "\uD83D\uDCA1 \u30D2\u30F3\u30C8: #",
                            '{',
                            "orderNumber",
                            '}',
                            " \u3068\u5165\u529B\u3059\u308B\u3068\u6CE8\u6587\u756A\u53F7\u306B\u7F6E\u304D\u63DB\u308F\u308A\u307E\u3059")),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveAlertSettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u4FDD\u5B58"),
                        React.createElement("button", { onClick: resetAlertSettings, className: "px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u306B\u623B\u3059"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u55B6\u696D\u6642\u9593\u5916\u8A2D\u5B9A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mt-1" }, "\u55B6\u696D\u6642\u9593\u5916\u306B\u30E1\u30CB\u30E5\u30FC\u753B\u9762\u3092\u975E\u8868\u793A\u306B\u3059\u308B\u8A2D\u5B9A")),
                    React.createElement("button", { onClick: () => setShowBusinessHoursSettings(!showBusinessHoursSettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showBusinessHoursSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showBusinessHoursSettings && (React.createElement("div", { className: "space-y-6 border-t pt-4" },
                    React.createElement("div", { className: "flex items-center gap-3 p-4 bg-blue-50 rounded-lg" },
                        React.createElement("input", { type: "checkbox", id: "businessHoursEnabled", checked: businessHoursSettings.enabled, onChange: (e) => setBusinessHoursSettings(Object.assign(Object.assign({}, businessHoursSettings), { enabled: e.target.checked })), className: "w-5 h-5" }),
                        React.createElement("label", { htmlFor: "businessHoursEnabled", className: "text-sm font-medium cursor-pointer" }, "\u55B6\u696D\u6642\u9593\u5916\u8A2D\u5B9A\u3092\u6709\u52B9\u306B\u3059\u308B")),
                    businessHoursSettings.enabled && (React.createElement(React.Fragment, null,
                        React.createElement("div", { className: "grid grid-cols-2 gap-4" },
                            React.createElement("div", null,
                                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u958B\u5E97\u6642\u9593"),
                                React.createElement("input", { type: "time", value: businessHoursSettings.openTime, onChange: (e) => setBusinessHoursSettings(Object.assign(Object.assign({}, businessHoursSettings), { openTime: e.target.value })), className: "w-full p-3 border rounded-lg" })),
                            React.createElement("div", null,
                                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u9589\u5E97\u6642\u9593"),
                                React.createElement("input", { type: "time", value: businessHoursSettings.closeTime, onChange: (e) => setBusinessHoursSettings(Object.assign(Object.assign({}, businessHoursSettings), { closeTime: e.target.value })), className: "w-full p-3 border rounded-lg" }))),
                        React.createElement("div", null,
                            React.createElement("label", { className: "block text-md font-bold mb-2" }, "\u55B6\u696D\u6642\u9593\u5916\u30E1\u30C3\u30BB\u30FC\u30B8"),
                            React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u55B6\u696D\u6642\u9593\u5916\u306B\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u30E1\u30C3\u30BB\u30FC\u30B8"),
                            React.createElement("textarea", { value: businessHoursSettings.closedMessage, onChange: (e) => setBusinessHoursSettings(Object.assign(Object.assign({}, businessHoursSettings), { closedMessage: e.target.value })), className: "w-full p-3 border rounded-lg font-mono text-sm", rows: "5", placeholder: "\u4F8B: \u55B6\u696D\u6642\u9593\u5916\u3067\u3059\\n\\n\u55B6\u696D\u6642\u9593: {openTime} - {closeTime}\\n\\n\u55B6\u696D\u6642\u9593\u5185\u306B\u3054\u5229\u7528\u304F\u3060\u3055\u3044" }),
                            React.createElement("p", { className: "text-xs text-blue-600 mt-1" },
                                "\uD83D\uDCA1 \u30D2\u30F3\u30C8: ",
                                '{',
                                "openTime",
                                '}',
                                " \u3068 ",
                                '{',
                                "closeTime",
                                '}',
                                " \u306F\u81EA\u52D5\u7684\u306B\u8A2D\u5B9A\u3057\u305F\u6642\u9593\u306B\u7F6E\u304D\u63DB\u308F\u308A\u307E\u3059")),
                        React.createElement("div", { className: "p-4 bg-yellow-50 border border-yellow-200 rounded-lg" },
                            React.createElement("p", { className: "text-sm text-yellow-800" },
                                React.createElement("strong", null, "\u26A0\uFE0F \u6CE8\u610F:"),
                                " \u3053\u306E\u8A2D\u5B9A\u3092\u6709\u52B9\u306B\u3059\u308B\u3068\u3001\u8A2D\u5B9A\u3057\u305F\u55B6\u696D\u6642\u9593\u5916\u306F\u304A\u5BA2\u69D8\u304C\u30E1\u30CB\u30E5\u30FC\u753B\u9762\u306B\u30A2\u30AF\u30BB\u30B9\u3067\u304D\u306A\u304F\u306A\u308A\u307E\u3059\u3002")))),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveBusinessHoursSettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u4FDD\u5B58"),
                        React.createElement("button", { onClick: resetBusinessHoursSettings, className: "px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u306B\u623B\u3059"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u4F11\u696D\u65E5\u8A2D\u5B9A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mt-1" }, "\u5B9A\u4F11\u65E5\u3084\u6307\u5B9A\u65E5\u3092\u4F11\u696D\u65E5\u3068\u3057\u3066\u8A2D\u5B9A")),
                    React.createElement("button", { onClick: () => setShowClosedDaysSettings(!showClosedDaysSettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showClosedDaysSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showClosedDaysSettings && (React.createElement("div", { className: "space-y-6 border-t pt-4" },
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-md font-bold mb-3" }, "\u5B9A\u4F11\u65E5"),
                        React.createElement("div", { className: "flex gap-2 flex-wrap" }, ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'].map((day, index) => (React.createElement("button", { key: index, onClick: () => toggleWeeklyClosedDay(index), className: `px-4 py-2 rounded-lg font-bold transition-all ${closedDaysSettings.weeklyClosedDays.includes(index)
                                ? 'bg-red-500 text-white'
                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}` }, day))))),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-md font-bold mb-2" }, "\u6307\u5B9A\u4F11\u696D\u65E5"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u30AB\u30EC\u30F3\u30C0\u30FC\u304B\u3089\u4F11\u696D\u65E5\u306B\u3059\u308B\u65E5\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044"),
                        React.createElement("div", { className: "flex gap-2 mb-3" },
                            React.createElement("input", { type: "date", onChange: (e) => {
                                    if (e.target.value) {
                                        addSpecificClosedDate(e.target.value);
                                        e.target.value = '';
                                    }
                                }, className: "flex-1 p-3 border rounded-lg" })),
                        closedDaysSettings.specificClosedDates.length > 0 && (React.createElement("div", { className: "bg-gray-50 p-3 rounded-lg" },
                            React.createElement("div", { className: "text-sm font-medium mb-2" }, "\u8A2D\u5B9A\u6E08\u307F\u306E\u4F11\u696D\u65E5:"),
                            React.createElement("div", { className: "flex flex-wrap gap-2" }, closedDaysSettings.specificClosedDates.map(date => (React.createElement("div", { key: date, className: "flex items-center gap-2 bg-red-100 text-red-700 px-3 py-1 rounded-full" },
                                React.createElement("span", null, date),
                                React.createElement("button", { onClick: () => removeSpecificClosedDate(date), className: "text-red-900 hover:text-red-600 font-bold" }, "\u00D7")))))))),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-md font-bold mb-2" }, "\u4F11\u696D\u65E5\u30E1\u30C3\u30BB\u30FC\u30B8"),
                        React.createElement("p", { className: "text-xs text-gray-500 mb-2" }, "\u4F11\u696D\u65E5\u306B\u304A\u5BA2\u69D8\u306B\u8868\u793A\u3055\u308C\u308B\u30E1\u30C3\u30BB\u30FC\u30B8"),
                        React.createElement("textarea", { value: closedDaysSettings.closedMessage, onChange: (e) => setClosedDaysSettings(Object.assign(Object.assign({}, closedDaysSettings), { closedMessage: e.target.value })), className: "w-full p-3 border rounded-lg font-mono text-sm", rows: "3", placeholder: "\u4F8B: \u672C\u65E5\u306F\u4F11\u696D\u65E5\u3067\u3059" })),
                    React.createElement("div", { className: "p-4 bg-yellow-50 border border-yellow-200 rounded-lg" },
                        React.createElement("p", { className: "text-sm text-yellow-800" },
                            React.createElement("strong", null, "\u6CE8\u610F:"),
                            " \u4F11\u696D\u65E5\u306B\u8A2D\u5B9A\u3055\u308C\u305F\u65E5\u306F\u3001\u304A\u5BA2\u69D8\u304C\u30E1\u30CB\u30E5\u30FC\u753B\u9762\u306B\u30A2\u30AF\u30BB\u30B9\u3059\u308B\u3068\u4F11\u696D\u65E5\u30E1\u30C3\u30BB\u30FC\u30B8\u304C\u8868\u793A\u3055\u308C\u307E\u3059\u3002")),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveClosedDaysSettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u4FDD\u5B58"),
                        React.createElement("button", { onClick: resetClosedDaysSettings, className: "px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u306B\u623B\u3059"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u30EC\u30B7\u30FC\u30C8/\u9818\u53CE\u66F8\u8A2D\u5B9A"),
                    React.createElement("button", { onClick: () => setShowReceiptSettings(!showReceiptSettings), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showReceiptSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showReceiptSettings && (React.createElement("div", { className: "space-y-4 border-t pt-4" },
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u5E97\u8217\u540D"),
                        React.createElement("input", { type: "text", value: receiptSettings.storeName, onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { storeName: e.target.value })), className: "w-full p-2 border rounded", placeholder: "\u4F8B: \u7C89\u3082\u3093\u5C4B \u516B" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u652F\u5E97\u540D"),
                        React.createElement("input", { type: "text", value: receiptSettings.branchName, onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { branchName: e.target.value })), className: "w-full p-2 border rounded", placeholder: "\u4F8B: \u4E0B\u8D64\u585A\u5E97" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u90F5\u4FBF\u756A\u53F7"),
                        React.createElement("input", { type: "text", value: receiptSettings.postalCode || '', onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { postalCode: e.target.value })), className: "w-full p-2 border rounded", placeholder: "\u4F8B: 175-0092" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u4F4F\u6240"),
                        React.createElement("input", { type: "text", value: receiptSettings.address, onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { address: e.target.value })), className: "w-full p-2 border rounded", placeholder: "\u4F8B: \u6771\u4EAC\u90FD\u677F\u6A4B\u533A\u8D64\u585A2-2-4" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u96FB\u8A71\u756A\u53F7"),
                        React.createElement("input", { type: "text", value: receiptSettings.phone, onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { phone: e.target.value })), className: "w-full p-2 border rounded", placeholder: "\u4F8B: 03-6904-2888" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u30EC\u30B7\u30FC\u30C8\u4E0B\u90E8\u30E1\u30C3\u30BB\u30FC\u30B8"),
                        React.createElement("textarea", { value: receiptSettings.message, onChange: (e) => setReceiptSettings(Object.assign(Object.assign({}, receiptSettings), { message: e.target.value })), className: "w-full p-2 border rounded", rows: "4", placeholder: "\u4F8B: \u3054\u6765\u5E97\u3042\u308A\u304C\u3068\u3046\u3054\u3056\u3044\u307E\u3057\u305F\n\u30A2\u30EB\u30D0\u30A4\u30C8\u52DF\u96C6\n\u6642\u7D661200\u5186\u301C\n\u8A73\u3057\u304F\u306F\u30B9\u30BF\u30C3\u30D5\u307E\u3067" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u96FB\u5B50\u5370\u9451\uFF08\u9818\u53CE\u66F8\u7528\uFF09"),
                        React.createElement("input", { type: "file", accept: "image/*", onChange: handleStampUpload, className: "w-full p-2 border rounded" }),
                        receiptSettings.stampImage && (React.createElement("div", { className: "mt-2" },
                            React.createElement("img", { src: receiptSettings.stampImage, alt: "\u5370\u9451\u30D7\u30EC\u30D3\u30E5\u30FC", className: "w-20 h-20 object-contain border" }))),
                        React.createElement("p", { className: "text-xs text-gray-500 mt-1" }, "\u203BPNG\u5F62\u5F0F\u63A8\u5968\u3002\u900F\u904E\u80CC\u666F\u304C\u4F7F\u7528\u3067\u304D\u307E\u3059\u3002")),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: saveReceiptSettings, className: "px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600" }, "\u4FDD\u5B58"),
                        React.createElement("button", { onClick: resetReceiptSettings, className: "px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600" }, "\u30C7\u30D5\u30A9\u30EB\u30C8\u306B\u623B\u3059"))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u5728\u5EAB\u7BA1\u7406"),
                    React.createElement("button", { onClick: () => setShowInventoryManagement(!showInventoryManagement), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showInventoryManagement ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showInventoryManagement && (React.createElement("div", { className: "space-y-4 border-t pt-4" },
                    React.createElement("div", { className: "bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4" },
                        React.createElement("div", { className: "text-sm text-blue-800" },
                            React.createElement("p", { className: "font-bold mb-2" }, "\uD83D\uDCCB \u5728\u5EAB\u7BA1\u7406\u306E\u4F7F\u3044\u65B9"),
                            React.createElement("ul", { className: "list-disc list-inside space-y-1" },
                                React.createElement("li", null, "\u5404\u5546\u54C1\u306E\u5728\u5EAB\u6570\u3068\u30A2\u30E9\u30FC\u30C8\u8A2D\u5B9A\u304C\u53EF\u80FD\u3067\u3059"),
                                React.createElement("li", null, "\u30A2\u30E9\u30FC\u30C8\u8A2D\u5B9A\u3092\u300C\u672A\u8A2D\u5B9A\u300D\u306B\u3059\u308B\u3068\u7121\u9650\u5728\u5EAB\u306B\u306A\u308A\u307E\u3059"),
                                React.createElement("li", null, "\u5728\u5EAB\u30920\u306B\u8A2D\u5B9A\u3059\u308B\u3068\u81EA\u52D5\u7684\u306B\u54C1\u5207\u308C\u306B\u306A\u308A\u307E\u3059"),
                                React.createElement("li", null, "\u6CE8\u6587\u5B8C\u4E86\u6642\u306B\u81EA\u52D5\u3067\u5728\u5EAB\u304C\u6E1B\u308A\u307E\u3059"),
                                React.createElement("li", null, "\u30A2\u30E9\u30FC\u30C8\u5728\u5EAB\u6570\u306B\u306A\u308B\u3068POS\u306B\u8B66\u544A\u304C\u8868\u793A\u3055\u308C\u307E\u3059")))),
                    React.createElement("div", { className: "bg-gray-50 rounded-lg p-4 mb-4" },
                        React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                            React.createElement("div", null,
                                React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "\uD83D\uDCC2 \u30AB\u30C6\u30B4\u30EA\u3067\u7D5E\u308A\u8FBC\u307F"),
                                React.createElement("select", { value: selectedInventoryCategory, onChange: (e) => {
                                        setSelectedInventoryCategory(e.target.value);
                                        setInventoryCurrentPage(1);
                                    }, className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" },
                                    React.createElement("option", { value: "\u5168\u3066" }, "\u5168\u3066\u306E\u30AB\u30C6\u30B4\u30EA"),
                                    Array.from(new Set(availableMenuItems.map(item => item.category))).sort().map(cat => (React.createElement("option", { key: cat, value: cat }, cat))))),
                            React.createElement("div", null,
                                React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "\uD83D\uDD0D \u5546\u54C1\u540D\u3067\u691C\u7D22"),
                                React.createElement("input", { type: "text", value: inventorySearchQuery, onChange: (e) => {
                                        setInventorySearchQuery(e.target.value);
                                        setInventoryCurrentPage(1);
                                    }, placeholder: "\u5546\u54C1\u540D\u3092\u5165\u529B...", className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" }))),
                        React.createElement("div", { className: "mt-4" },
                            React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "\uD83D\uDCCA \u5728\u5EAB\u72B6\u614B\u3067\u7D5E\u308A\u8FBC\u307F"),
                            React.createElement("div", { className: "flex flex-wrap gap-2" },
                                React.createElement("button", { onClick: () => {
                                        setInventorySearchQuery('');
                                        setSelectedInventoryCategory('å…¨ã¦');
                                        setInventoryCurrentPage(1);
                                    }, className: "px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded-full text-sm font-medium" }, "\u5168\u3066\u8868\u793A"),
                                React.createElement("button", { onClick: () => {
                                        setInventorySearchQuery('å“åˆ‡ã‚Œ');
                                        setInventoryCurrentPage(1);
                                    }, className: "px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded-full text-sm font-medium" }, "\uD83D\uDD34 \u54C1\u5207\u308C\u306E\u307F"),
                                React.createElement("button", { onClick: () => {
                                        setInventorySearchQuery('åœ¨åº«å°‘');
                                        setInventoryCurrentPage(1);
                                    }, className: "px-3 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-full text-sm font-medium" }, "\uD83D\uDFE1 \u5728\u5EAB\u5C11\u306E\u307F")))),
                    availableMenuItems.length === 0 ? (React.createElement("div", { className: "text-center py-8 text-gray-500" }, "\u30E1\u30CB\u30E5\u30FC\u5546\u54C1\u304C\u767B\u9332\u3055\u308C\u3066\u3044\u307E\u305B\u3093")) : (React.createElement(React.Fragment, null,
                        React.createElement("div", { className: "space-y-3" }, (() => {
                            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†
                            let filteredItems = availableMenuItems;
                            // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                            if (selectedInventoryCategory !== 'å…¨ã¦') {
                                filteredItems = filteredItems.filter(item => item.category === selectedInventoryCategory);
                            }
                            // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                            if (inventorySearchQuery) {
                                const query = inventorySearchQuery.toLowerCase();
                                filteredItems = filteredItems.filter(item => {
                                    const inventory = inventorySettings[item.id] || {};
                                    const stock = inventory.stock !== undefined ? inventory.stock : null;
                                    const alertThreshold = inventory.alertThreshold !== undefined ? inventory.alertThreshold : null;
                                    const isOutOfStock = stock !== null && stock === 0;
                                    const isLowStock = stock !== null && alertThreshold !== null && stock <= alertThreshold;
                                    // å•†å“åæ¤œç´¢
                                    if (item.name.toLowerCase().includes(query))
                                        return true;
                                    // çŠ¶æ…‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                                    if (query === 'å“åˆ‡ã‚Œ' && isOutOfStock)
                                        return true;
                                    if (query === 'åœ¨åº«å°‘' && isLowStock && !isOutOfStock)
                                        return true;
                                    return false;
                                });
                            }
                            // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
                            const totalPages = Math.ceil(filteredItems.length / inventoryItemsPerPage);
                            const paginatedItems = filteredItems.slice((inventoryCurrentPage - 1) * inventoryItemsPerPage, inventoryCurrentPage * inventoryItemsPerPage);
                            // çµæœãŒ0ä»¶ã®å ´åˆ
                            if (filteredItems.length === 0) {
                                return (React.createElement("div", { className: "text-center py-8 text-gray-500" }, "\u6761\u4EF6\u306B\u4E00\u81F4\u3059\u308B\u5546\u54C1\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F"));
                            }
                            return (React.createElement(React.Fragment, null,
                                React.createElement("div", { className: "text-sm text-gray-600 mb-3" },
                                    filteredItems.length,
                                    "\u4EF6\u306E\u5546\u54C1\u304C\u898B\u3064\u304B\u308A\u307E\u3057\u305F"),
                                paginatedItems.map((item) => {
                                    const inventory = inventorySettings[item.id] || {};
                                    const stock = inventory.stock !== undefined ? inventory.stock : null;
                                    const alertThreshold = inventory.alertThreshold !== undefined ? inventory.alertThreshold : null;
                                    const isUnlimited = stock === null;
                                    const isLowStock = stock !== null && alertThreshold !== null && stock <= alertThreshold;
                                    const isOutOfStock = stock !== null && stock === 0;
                                    return (React.createElement("div", { key: item.id, className: `border rounded-lg p-4 ${isOutOfStock ? 'bg-red-50 border-red-300' :
                                            isLowStock ? 'bg-yellow-50 border-yellow-300' :
                                                'hover:bg-gray-50'}` },
                                        React.createElement("div", { className: "flex items-start justify-between gap-4" },
                                            React.createElement("div", { className: "flex-1" },
                                                React.createElement("div", { className: "font-bold text-lg mb-2" },
                                                    item.name,
                                                    isOutOfStock && React.createElement("span", { className: "ml-2 px-2 py-1 bg-red-500 text-white text-xs rounded" }, "\u54C1\u5207\u308C"),
                                                    isLowStock && !isOutOfStock && React.createElement("span", { className: "ml-2 px-2 py-1 bg-yellow-500 text-white text-xs rounded" }, "\u5728\u5EAB\u5C11"),
                                                    isUnlimited && React.createElement("span", { className: "ml-2 px-2 py-1 bg-green-500 text-white text-xs rounded" }, "\u7121\u9650")),
                                                React.createElement("div", { className: "text-sm text-gray-600 mb-3" },
                                                    "\u30AB\u30C6\u30B4\u30EA: ",
                                                    item.category,
                                                    " | \u4FA1\u683C: \u00A5",
                                                    item.price),
                                                React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                                                    React.createElement("div", null,
                                                        React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-1" }, "\u73FE\u5728\u306E\u5728\u5EAB\u6570"),
                                                        React.createElement("div", { className: "flex gap-2" },
                                                            React.createElement("input", { type: "number", min: "0", value: stock === null ? '' : stock, onChange: (e) => {
                                                                    const val = e.target.value;
                                                                    updateInventorySetting(item.id, 'stock', val === '' ? null : parseInt(val));
                                                                }, placeholder: "\u672A\u8A2D\u5B9A\uFF08\u7121\u9650\uFF09", className: "flex-1 px-3 py-2 border border-gray-300 rounded-md" }),
                                                            React.createElement("button", { onClick: () => updateInventorySetting(item.id, 'stock', null), className: "px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm" }, "\u7121\u9650"))),
                                                    React.createElement("div", null,
                                                        React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-1" }, "\u30A2\u30E9\u30FC\u30C8\u5728\u5EAB\u6570\uFF08\u3053\u306E\u6570\u306B\u306A\u3063\u305F\u3089\u8B66\u544A\uFF09"),
                                                        React.createElement("div", { className: "flex gap-2" },
                                                            React.createElement("input", { type: "number", min: "0", value: alertThreshold === null ? '' : alertThreshold, onChange: (e) => {
                                                                    const val = e.target.value;
                                                                    updateInventorySetting(item.id, 'alertThreshold', val === '' ? null : parseInt(val));
                                                                }, placeholder: "\u672A\u8A2D\u5B9A", className: "flex-1 px-3 py-2 border border-gray-300 rounded-md", disabled: stock === null }),
                                                            React.createElement("button", { onClick: () => updateInventorySetting(item.id, 'alertThreshold', null), className: "px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm", disabled: stock === null }, "\u672A\u8A2D\u5B9A"))))))));
                                }),
                                filteredItems.length > inventoryItemsPerPage && (React.createElement("div", { className: "flex justify-center items-center gap-4 mt-6 pt-4 border-t" },
                                    React.createElement("button", { onClick: () => setInventoryCurrentPage(Math.max(1, inventoryCurrentPage - 1)), disabled: inventoryCurrentPage === 1, className: `px-4 py-2 rounded-lg font-bold ${inventoryCurrentPage === 1
                                            ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            : 'bg-blue-500 text-white hover:bg-blue-600'}` }, "\u2190 \u524D\u3078"),
                                    React.createElement("div", { className: "text-sm font-medium" },
                                        "\u30DA\u30FC\u30B8 ",
                                        inventoryCurrentPage,
                                        " / ",
                                        totalPages,
                                        React.createElement("span", { className: "text-gray-500 ml-2" },
                                            "(\u5168",
                                            filteredItems.length,
                                            "\u4EF6)")),
                                    React.createElement("button", { onClick: () => setInventoryCurrentPage(Math.min(totalPages, inventoryCurrentPage + 1)), disabled: inventoryCurrentPage >= totalPages, className: `px-4 py-2 rounded-lg font-bold ${inventoryCurrentPage >= totalPages
                                            ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            : 'bg-blue-500 text-white hover:bg-blue-600'}` }, "\u6B21\u3078 \u2192")))));
                        })()))),
                    React.createElement("div", { className: "flex justify-between gap-2 pt-4 border-t" },
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { type: "button", onClick: setAllProductsToZero, className: "px-4 py-3 bg-red-700 text-white rounded-lg hover:bg-red-800 font-bold text-sm" }, "\u5168\u5546\u54C1\u54C1\u5207"),
                            React.createElement("button", { type: "button", onClick: clearAllProductsZero, className: "px-4 py-3 bg-orange-700 text-white rounded-lg hover:bg-orange-800 font-bold text-sm" }, "\u5168\u5546\u54C1\u5FA9\u6D3B")),
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { type: "button", onClick: resetInventorySettings, className: "px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold" }, "\u5168\u3066\u672A\u8A2D\u5B9A\uFF08\u6E80\u30BF\u30F3\uFF09\u306B\u3059\u308B"),
                            React.createElement("button", { type: "button", onClick: saveInventorySettings, className: "px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-bold" }, "\u5728\u5EAB\u8A2D\u5B9A\u3092\u4FDD\u5B58")))))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800 flex items-center gap-2" }, "\u5F93\u696D\u54E1\u7BA1\u7406"),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("button", { onClick: () => setShowEmployeeManagement(!showEmployeeManagement), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showEmployeeManagement ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã'),
                        showEmployeeManagement && (React.createElement("button", { onClick: () => setShowAddEmployee(true), className: "px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center gap-2" },
                            React.createElement(Plus, { className: "w-4 h-4" }),
                            "\u5F93\u696D\u54E1\u3092\u8FFD\u52A0")))),
                showEmployeeManagement && (React.createElement("div", { className: "space-y-3 border-t pt-4" }, employees.map((emp, index) => {
                    var _a, _b, _c;
                    return (React.createElement("div", { key: emp.id, className: "border rounded-lg p-4 flex justify-between items-center hover:bg-gray-50" }, editingEmployee === emp.id ? (React.createElement(EditEmployeeForm, { employee: emp, onSave: updateEmployee, onCancel: () => setEditingEmployee(null) })) : (React.createElement(React.Fragment, null,
                        React.createElement("div", { className: "flex items-center gap-3" },
                            React.createElement("div", { className: "flex flex-col gap-1" },
                                React.createElement("button", { onClick: () => moveEmployee(index, 'up'), disabled: index === 0, className: `p-1 rounded ${index === 0 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0A\u306B\u79FB\u52D5" },
                                    React.createElement("svg", { width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
                                        React.createElement("polyline", { points: "18 15 12 9 6 15" }))),
                                React.createElement("button", { onClick: () => moveEmployee(index, 'down'), disabled: index === employees.length - 1, className: `p-1 rounded ${index === employees.length - 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-blue-500 text-white hover:bg-blue-600'}`, title: "\u4E0B\u306B\u79FB\u52D5" },
                                    React.createElement("svg", { width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
                                        React.createElement("polyline", { points: "6 9 12 15 18 9" })))),
                            React.createElement("div", { className: "flex-1" },
                                React.createElement("div", { className: "font-bold text-lg" }, emp.name),
                                React.createElement("div", { className: "text-sm text-gray-600" },
                                    emp.salaryType === 'å›ºå®šçµ¦' && emp.monthlySalary > 0 ? (React.createElement(React.Fragment, null,
                                        React.createElement("span", { className: "bg-green-100 text-green-800 px-2 py-0.5 rounded font-semibold" }, "\u56FA\u5B9A\u7D66"),
                                        ' ',
                                        "\u00A5",
                                        ((_a = emp.monthlySalary) === null || _a === void 0 ? void 0 : _a.toLocaleString()) || 0,
                                        "/\u6708 |")) : (React.createElement(React.Fragment, null,
                                        React.createElement("span", { className: "bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-semibold" }, "\u6642\u9593\u7D66"),
                                        ' ')),
                                    "\u6642\u7D66: \u00A5",
                                    ((_b = emp.hourlyRate) === null || _b === void 0 ? void 0 : _b.toLocaleString()) || 0,
                                    " | \u4EA4\u901A\u8CBB: \u00A5",
                                    ((_c = emp.transportAllowance) === null || _c === void 0 ? void 0 : _c.toLocaleString()) || 0,
                                    "/\u65E5"))),
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { onClick: () => setEditingEmployee(emp.id), className: "px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm" },
                                React.createElement(Edit2, { className: "w-4 h-4" })),
                            React.createElement("button", { onClick: () => setSelectedPayslipEmployee(emp.id), className: "px-3 py-1 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm" }, "\u7D66\u4E0E\u660E\u7D30"),
                            React.createElement("button", { onClick: () => deleteEmployee(emp.id), className: "px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm" }, "\u524A\u9664"))))));
                })))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800" }, "\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u7BA1\u7406"),
                    React.createElement("button", { onClick: () => setShowBackupManagement(!showBackupManagement), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" }, showBackupManagement ? 'é–‰ã˜ã‚‹' : 'ç®¡ç†ç”»é¢ã‚’é–‹ã')),
                showBackupManagement && React.createElement(BackupManagement, { currentStoreId: window.currentStoreId, showCustomConfirm: showCustomConfirmFunc, showCustomAlert: showCustomAlertFunc })),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("h2", { className: "text-2xl font-bold text-gray-800" }, "\u524A\u9664\u8A2D\u5B9A"),
                    React.createElement("button", { onClick: () => setShowDeleteSettings(!showDeleteSettings), className: "px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600" }, showDeleteSettings ? 'é–‰ã˜ã‚‹' : 'è¨­å®šã‚’é–‹ã')),
                showDeleteSettings && React.createElement(DeleteSettings, { currentStoreId: window.currentStoreId, showCustomConfirm: showCustomConfirmFunc, showCustomAlert: showCustomAlertFunc })),
            selectedPayslipEmployee && (() => {
                var _a, _b, _c;
                const employee = employees.find(e => e.id === selectedPayslipEmployee);
                if (!employee)
                    return null;
                const totals = calculateMonthlyTotals(selectedPayslipEmployee);
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);
                const workDays = [];
                // æ›œæ—¥å–å¾—é–¢æ•°
                const getDayOfWeek = (year, month, day) => {
                    const date = new Date(year, month, day);
                    const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
                    return days[date.getDay()];
                };
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    const record = (_a = attendanceData[selectedPayslipEmployee]) === null || _a === void 0 ? void 0 : _a[dateKey];
                    const dayOfWeek = getDayOfWeek(currentYear, currentMonth, day);
                    // ãƒ‡ãƒ¼ã‚¿ãŒãªãã¦ã‚‚æ—¥ä»˜ã‚’è¡¨ç¤ºï¼ˆå…¥åŠ›å¯èƒ½ã«ã™ã‚‹ï¼‰
                    const workHours = record ? calculateWorkHours(record) : 0;
                    const dailyPay = record ? calculateDailyPay(employee, record) : { base: 0, overtime: 0, holiday: 0, total: 0 };
                    workDays.push({ day, dayOfWeek, record, workHours, dailyPay });
                }
                return (React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6 mb-6 print-content" },
                    React.createElement("div", { className: "flex justify-between items-center mb-6 no-print" },
                        React.createElement("button", { onClick: () => setSelectedPayslipEmployee(null), className: "px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2" },
                            React.createElement(ArrowLeft, { className: "w-4 h-4" }),
                            "\u623B\u308B"),
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { onClick: () => exportToPNG(selectedPayslipEmployee), className: "px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center gap-2" },
                                React.createElement(Download, { className: "w-4 h-4" }),
                                "PNG\u51FA\u529B"),
                            React.createElement("button", { onClick: () => window.print(), className: "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center gap-2" },
                                React.createElement(Printer, { className: "w-4 h-4" }),
                                "\u5370\u5237"))),
                    React.createElement("div", { className: "text-center mb-6" },
                        React.createElement("h2", { className: "text-3xl font-bold mb-2" }, "\u7D66\u4E0E\u660E\u7D30\u66F8"),
                        React.createElement("p", { className: "text-xl text-gray-600" },
                            currentYear,
                            "\u5E74",
                            currentMonth + 1,
                            "\u6708\u5206")),
                    React.createElement("div", { className: "mb-6 p-4 bg-gray-50 rounded-lg" },
                        React.createElement("div", { className: "grid grid-cols-2 gap-4" },
                            React.createElement("div", null,
                                React.createElement("div", { className: "text-sm text-gray-600" }, "\u6C0F\u540D"),
                                React.createElement("div", { className: "text-xl font-bold" }, employee.name)),
                            React.createElement("div", null,
                                React.createElement("div", { className: "text-sm text-gray-600" }, "\u6642\u7D66"),
                                React.createElement("div", { className: "text-xl font-bold" },
                                    "\u00A5",
                                    ((_b = employee.hourlyRate) === null || _b === void 0 ? void 0 : _b.toLocaleString()) || 0)),
                            React.createElement("div", null,
                                React.createElement("div", { className: "text-sm text-gray-600" }, "\u4EA4\u901A\u8CBB"),
                                React.createElement("div", { className: "text-xl font-bold" },
                                    "\u00A5",
                                    ((_c = employee.transportAllowance) === null || _c === void 0 ? void 0 : _c.toLocaleString()) || 0,
                                    "/\u65E5")),
                            React.createElement("div", null,
                                React.createElement("div", { className: "text-sm text-gray-600" }, "\u51FA\u52E4\u65E5\u6570"),
                                React.createElement("div", { className: "text-xl font-bold" },
                                    totals.workDays,
                                    "\u65E5")))),
                    React.createElement("div", { className: "mb-6" },
                        React.createElement("h3", { className: "text-xl font-bold mb-4" }, "\u7D66\u4E0E\u5185\u8A33"),
                        totals.salaryType === 'å›ºå®šçµ¦' && totals.fixedSalary > 0 ? (React.createElement(React.Fragment, null,
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("h4", { className: "bg-green-500 text-white p-2 font-bold" }, "\u3010\u652F\u7D66\u3011"),
                                React.createElement("table", { className: "w-full border-collapse border" },
                                    React.createElement("thead", { className: "bg-gray-800 text-white" },
                                        React.createElement("tr", null,
                                            React.createElement("th", { className: "border p-2 text-left" }, "\u9805\u76EE"),
                                            React.createElement("th", { className: "border p-2 text-right w-32" }, "\u6642\u9593\u7D66\u30D9\u30FC\u30B9"),
                                            React.createElement("th", { className: "border p-2 text-right w-32" }, "\u56FA\u5B9A\u7D66\u30D9\u30FC\u30B9"))),
                                    React.createElement("tbody", null,
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u57FA\u672C\u7D66"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                Math.round(totals.basePay + totals.overtimePay + totals.holidayPay).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedSalary.toLocaleString())),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2 pl-6 text-sm" },
                                                "\u2514 \u901A\u5E38(",
                                                totals.hours.toFixed(1),
                                                "h)"),
                                            React.createElement("td", { className: "border p-2 text-right text-sm" },
                                                "\u00A5",
                                                Math.round(totals.basePay).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right bg-gray-100" }, "-")),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2 pl-6 text-sm" }, "\u2514 \u6642\u9593\u5916(25%)"),
                                            React.createElement("td", { className: "border p-2 text-right text-sm" },
                                                "\u00A5",
                                                Math.round(totals.overtimePay).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right bg-gray-100" }, "-")),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2 pl-6 text-sm" }, "\u2514 \u4F11\u65E5(35%)"),
                                            React.createElement("td", { className: "border p-2 text-right text-sm" },
                                                "\u00A5",
                                                Math.round(totals.holidayPay).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right bg-gray-100" }, "-")),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2 pl-6 text-sm" }, "\u2514 \u6DF1\u591C(25%)"),
                                            React.createElement("td", { className: "border p-2 text-right text-sm" },
                                                "\u00A5",
                                                Math.round(totals.lateNightPay).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right bg-gray-100" }, "-")),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" },
                                                "\u901A\u52E4\u8CBB(",
                                                totals.workDays,
                                                "\u65E5)"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.transport.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right bg-gray-100" }, "-")),
                                        totals.totalAllowances > 0 && (React.createElement(React.Fragment, null,
                                            totals.allowances.family > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u5BB6\u65CF\u624B\u5F53"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.family.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.family.toLocaleString())),
                                            totals.allowances.sales > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u55B6\u696D\u624B\u5F53"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.sales.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.sales.toLocaleString())),
                                            totals.allowances.position > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u5F79\u8077\u624B\u5F53"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.position.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.position.toLocaleString())),
                                            totals.allowances.commuting > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u901A\u52E4\u624B\u5F53"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.commuting.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.commuting.toLocaleString())),
                                            totals.allowances.expense > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u7D4C\u8CBB"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.expense.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.expense.toLocaleString())),
                                            totals.allowances.housing > 0 && React.createElement("tr", null,
                                                React.createElement("td", { className: "border p-2" }, "\u5BB6\u8CC3\u88DC\u52A9"),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.housing.toLocaleString()),
                                                React.createElement("td", { className: "border p-2 text-right" },
                                                    "\u00A5",
                                                    totals.allowances.housing.toLocaleString())))),
                                        React.createElement("tr", { className: "bg-green-100 font-bold" },
                                            React.createElement("td", { className: "border p-2" }, "\u7DCF\u652F\u7D66\u984D"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                Math.round(totals.hourlyTotalGross).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                Math.round(totals.fixedTotalGross).toLocaleString()))))),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("h4", { className: "bg-red-500 text-white p-2 font-bold" }, "\u3010\u63A7\u9664\u3011"),
                                React.createElement("table", { className: "w-full border-collapse border" },
                                    React.createElement("thead", { className: "bg-gray-800 text-white" },
                                        React.createElement("tr", null,
                                            React.createElement("th", { className: "border p-2 text-left" }, "\u9805\u76EE"),
                                            React.createElement("th", { className: "border p-2 text-right w-32" }, "\u6642\u9593\u7D66\u30D9\u30FC\u30B9"),
                                            React.createElement("th", { className: "border p-2 text-right w-32" }, "\u56FA\u5B9A\u7D66\u30D9\u30FC\u30B9"))),
                                    React.createElement("tbody", null,
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u5065\u5EB7\u4FDD\u967A"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.healthInsurance.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.healthInsurance.toLocaleString())),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u539A\u751F\u5E74\u91D1"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.pension.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.pension.toLocaleString())),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u96C7\u7528\u4FDD\u967A"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.employmentInsurance.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.employmentInsurance.toLocaleString())),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u6240\u5F97\u7A0E"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.incomeTax.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.incomeTax.toLocaleString())),
                                        React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u4F4F\u6C11\u7A0E"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.residentTax.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.residentTax.toLocaleString())),
                                        totals.hourlyDeductions.rent > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u5BB6\u8CC3"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.rent.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.rent.toLocaleString())),
                                        totals.hourlyDeductions.utilities > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-2" }, "\u5149\u71B1\u8CBB"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.hourlyDeductions.utilities.toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                totals.fixedDeductions.utilities.toLocaleString())),
                                        React.createElement("tr", { className: "bg-red-100 font-bold" },
                                            React.createElement("td", { className: "border p-2" }, "\u7DCF\u63A7\u9664\u984D"),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                Math.round(totals.hourlyDeductions.totalDeductions).toLocaleString()),
                                            React.createElement("td", { className: "border p-2 text-right" },
                                                "\u00A5",
                                                Math.round(totals.fixedDeductions.totalDeductions).toLocaleString())))),
                                React.createElement("div", { className: "bg-yellow-50 border border-yellow-300 p-3 mt-2 rounded text-xs" },
                                    React.createElement("div", { className: "font-bold mb-1" }, "\u3010\u63A7\u9664\u984D\u306E\u8A08\u7B97\u65B9\u6CD5\u3011"),
                                    React.createElement("div", { className: "space-y-1 text-gray-700" },
                                        React.createElement("div", null,
                                            "\u2022 ",
                                            React.createElement("strong", null, "\u5065\u5EB7\u4FDD\u967A"),
                                            ": \u6A19\u6E96\u5831\u916C\u6708\u984D \u00D7 \u4FDD\u967A\u6599\u7387 \u00F7 2\uFF0840\u6B73\u4EE5\u4E0A\u306F\u4ECB\u8B77\u4FDD\u967A\u6599\u3092\u542B\u3080\uFF09"),
                                        React.createElement("div", null,
                                            "\u2022 ",
                                            React.createElement("strong", null, "\u539A\u751F\u5E74\u91D1"),
                                            ": \u6A19\u6E96\u5831\u916C\u6708\u984D \u00D7 18.3% \u00F7 2"),
                                        React.createElement("div", null,
                                            "\u2022 ",
                                            React.createElement("strong", null, "\u96C7\u7528\u4FDD\u967A"),
                                            ": \u7DCF\u652F\u7D66\u984D\uFF08\u7D4C\u8CBB\u9664\u304F\uFF09 \u00D7 0.55%"),
                                        React.createElement("div", null,
                                            "\u2022 ",
                                            React.createElement("strong", null, "\u6240\u5F97\u7A0E"),
                                            ": (\u7DCF\u652F\u7D66\u984D - \u793E\u4F1A\u4FDD\u967A\u6599 - \u7D66\u4E0E\u6240\u5F97\u63A7\u9664) \u306B\u5BFE\u3059\u308B\u7D2F\u9032\u8AB2\u7A0E"),
                                        React.createElement("div", null,
                                            "\u2022 ",
                                            React.createElement("strong", null, "\u4F4F\u6C11\u7A0E"),
                                            ": \u8AB2\u7A0E\u6240\u5F97 \u00D7 10%\uFF08\u6982\u7B97\uFF09"),
                                        React.createElement("div", { className: "text-red-600 font-bold mt-1" }, "\u203B\u6642\u9593\u7D66\u306E\u5834\u5408\u300188,000\u5186\u672A\u6E80\u306F\u5065\u5EB7\u4FDD\u967A\u30FB\u539A\u751F\u5E74\u91D1\u304C\u514D\u9664\u3055\u308C\u307E\u3059")))),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("h4", { className: "bg-blue-500 text-white p-2 font-bold" }, "\u3010\u652F\u7D66\u984D\u3011"),
                                React.createElement("table", { className: "w-full border-collapse border" },
                                    React.createElement("tbody", null,
                                        React.createElement("tr", { className: "bg-blue-100 font-bold text-lg" },
                                            React.createElement("td", { className: "border p-3" }, "\u5DEE\u5F15\u652F\u7D66\u984D"),
                                            React.createElement("td", { className: "border p-3 text-right w-32" },
                                                "\u00A5",
                                                Math.round(totals.hourlyNetPay).toLocaleString()),
                                            React.createElement("td", { className: "border p-3 text-right w-32 text-blue-600" },
                                                "\u00A5",
                                                Math.round(totals.fixedNetPay).toLocaleString()))))),
                            React.createElement("div", { className: "mb-4" },
                                React.createElement("h4", { className: "bg-orange-500 text-white p-2 font-bold" }, "\u3010\u4ECA\u6708\u306E\u5DEE\u984D\uFF08\u6700\u4F4E\u8CC3\u91D1\u63DB\u7B97\uFF09\u3011"),
                                React.createElement("table", { className: "w-full border-collapse border" },
                                    React.createElement("tbody", null,
                                        React.createElement("tr", { className: "bg-yellow-50" },
                                            React.createElement("td", { className: "border p-2 font-bold" }, "\u63A7\u9664\u524D\u5DEE\u984D"),
                                            React.createElement("td", { className: "border p-2 text-right font-bold text-orange-600" },
                                                "\u00A5",
                                                Math.round(totals.displayGrossDifference).toLocaleString())),
                                        React.createElement("tr", { className: "bg-yellow-50" },
                                            React.createElement("td", { className: "border p-2 font-bold" }, "\u63A7\u9664\u5F8C\u5DEE\u984D"),
                                            React.createElement("td", { className: "border p-2 text-right font-bold text-orange-600" },
                                                "\u00A5",
                                                Math.round(totals.displayNetDifference).toLocaleString())),
                                        React.createElement("tr", { className: "bg-blue-50" },
                                            React.createElement("td", { className: "border p-2 font-bold" }, "\u7D0D\u7A0E\u984D\uFF08\u5DEE\u984D\u5206\uFF09"),
                                            React.createElement("td", { className: "border p-2 text-right font-bold text-blue-600" },
                                                "\u00A5",
                                                Math.round(totals.displayGrossDifference - totals.displayNetDifference).toLocaleString())))),
                                React.createElement("div", { className: "text-xs text-gray-600 mt-1" },
                                    "\u203B\u6700\u4F4E\u8CC3\u91D1\u3067\u8A08\u7B97\u3057\u305F\u6642\u9593\u7D66\u3068\u56FA\u5B9A\u7D66\u306E\u5DEE\u984D\u3067\u3059\u3002",
                                    React.createElement("br", null),
                                    "\u30D7\u30E9\u30B9\u306E\u5834\u5408\u3001\u4F1A\u793E\u306B\u8ACB\u6C42\u53EF\u80FD\u306A\u91D1\u984D\u3067\u3059\u3002")),
                            React.createElement(CumulativeDifferenceDisplay, { employeeId: selectedPayslipEmployee }),
                            (!calculatedResidentTaxes[`${selectedPayslipEmployee}_hourly`] || !calculatedResidentTaxes[`${selectedPayslipEmployee}_fixed`]) && (React.createElement("div", { className: "mt-4 bg-red-50 border-2 border-red-500 rounded-lg p-4" },
                                React.createElement("div", { className: "flex items-center gap-2 mb-2" },
                                    React.createElement("h4", { className: "font-bold text-red-800 text-lg" }, "\u4F4F\u6C11\u7A0E\u304C\u8A08\u7B97\u3055\u308C\u3066\u3044\u307E\u305B\u3093")),
                                React.createElement("p", { className: "text-sm text-red-700 mb-2" },
                                    "\u73FE\u5728\u306E\u4F4F\u6C11\u7A0E: ",
                                    React.createElement("strong", null, "\u00A50"),
                                    "\uFF08\u672A\u8A08\u7B97\uFF09"),
                                React.createElement("p", { className: "text-sm text-red-700" }, "\u4E0B\u306E\u300C\u4F4F\u6C11\u7A0E\u8A08\u7B97\u300D\u30DC\u30BF\u30F3\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u3001\u6B63\u78BA\u306A\u4F4F\u6C11\u7A0E\u3092\u8A08\u7B97\u3057\u3066\u304F\u3060\u3055\u3044\u3002"))),
                            React.createElement("div", { className: "mt-6 grid grid-cols-2 gap-4" },
                                React.createElement("div", null,
                                    React.createElement("button", { onClick: () => {
                                            const url = 'keisan-shousai-v6.html';
                                            const width = 800;
                                            const height = 900;
                                            const left = (screen.width - width) / 2;
                                            const top = (screen.height - height) / 2;
                                            const employee = employees.find(e => e.id === selectedPayslipEmployee);
                                            const params = new URLSearchParams({
                                                employeeId: selectedPayslipEmployee,
                                                employeeName: (employee === null || employee === void 0 ? void 0 : employee.name) || '',
                                                salaryType: 'hourly',
                                                year: currentYear.toString(),
                                                month: currentMonth.toString()
                                            });
                                            window.open(`${url}?${params.toString()}`, `residentTaxCalc_${selectedPayslipEmployee}_hourly`, `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`);
                                        }, className: "w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white px-4 py-3 rounded-lg font-bold hover:opacity-90 transition-all" }, "\uD83D\uDCB0 \u4F4F\u6C11\u7A0E\u8A08\u7B97\uFF08\u6642\u9593\u7D66\uFF09"),
                                    calculatedResidentTaxes[`${selectedPayslipEmployee}_hourly`] && (React.createElement("div", { className: "mt-2 p-3 bg-green-50 border-2 border-green-500 rounded-lg" },
                                        React.createElement("p", { className: "text-sm font-bold text-green-800 text-center" },
                                            "\u2705 \u6642\u9593\u7D66\u306E\u4F4F\u6C11\u7A0E: \u00A5",
                                            calculatedResidentTaxes[`${selectedPayslipEmployee}_hourly`].toLocaleString(),
                                            "/\u6708")))),
                                React.createElement("div", null,
                                    React.createElement("button", { onClick: () => {
                                            const url = 'keisan-shousai-v6.html';
                                            const width = 800;
                                            const height = 900;
                                            const left = (screen.width - width) / 2;
                                            const top = (screen.height - height) / 2;
                                            const employee = employees.find(e => e.id === selectedPayslipEmployee);
                                            const params = new URLSearchParams({
                                                employeeId: selectedPayslipEmployee,
                                                employeeName: (employee === null || employee === void 0 ? void 0 : employee.name) || '',
                                                salaryType: 'fixed',
                                                year: currentYear.toString(),
                                                month: currentMonth.toString()
                                            });
                                            window.open(`${url}?${params.toString()}`, `residentTaxCalc_${selectedPayslipEmployee}_fixed`, `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`);
                                        }, className: "w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-lg font-bold hover:opacity-90 transition-all" }, "\uD83D\uDCB0 \u4F4F\u6C11\u7A0E\u8A08\u7B97\uFF08\u56FA\u5B9A\u7D66\uFF09"),
                                    calculatedResidentTaxes[`${selectedPayslipEmployee}_fixed`] && (React.createElement("div", { className: "mt-2 p-3 bg-blue-50 border-2 border-blue-500 rounded-lg" },
                                        React.createElement("p", { className: "text-sm font-bold text-blue-800 text-center" },
                                            "\u2705 \u56FA\u5B9A\u7D66\u306E\u4F4F\u6C11\u7A0E: \u00A5",
                                            calculatedResidentTaxes[`${selectedPayslipEmployee}_fixed`].toLocaleString(),
                                            "/\u6708"))))))) : (React.createElement(React.Fragment, null,
                            React.createElement("table", { className: "w-full border-collapse border" },
                                React.createElement("thead", { className: "bg-gray-100" },
                                    React.createElement("tr", null,
                                        React.createElement("th", { className: "border p-3 text-left" }, "\u9805\u76EE"),
                                        React.createElement("th", { className: "border p-3 text-right" }, "\u91D1\u984D"))),
                                React.createElement("tbody", null,
                                    React.createElement("tr", null,
                                        React.createElement("td", { className: "border p-3" }, "\u57FA\u672C\u7D66"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold" },
                                            "\u00A5",
                                            Math.round(totals.basePay).toLocaleString())),
                                    React.createElement("tr", null,
                                        React.createElement("td", { className: "border p-3" }, "\u6642\u9593\u5916\u624B\u5F53(25%\u5272\u5897)"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold" },
                                            "\u00A5",
                                            Math.round(totals.overtimePay).toLocaleString())),
                                    React.createElement("tr", null,
                                        React.createElement("td", { className: "border p-3" }, "\u4F11\u65E5\u51FA\u52E4\u624B\u5F53(35%\u5272\u5897)"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold" },
                                            "\u00A5",
                                            Math.round(totals.holidayPay).toLocaleString())),
                                    React.createElement("tr", null,
                                        React.createElement("td", { className: "border p-3" }, "\u6DF1\u591C\u624B\u5F53(25%\u5272\u5897)"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold" },
                                            "\u00A5",
                                            Math.round(totals.lateNightPay).toLocaleString())),
                                    React.createElement("tr", null,
                                        React.createElement("td", { className: "border p-3" },
                                            "\u4EA4\u901A\u8CBB(",
                                            totals.workDays,
                                            "\u65E5\u5206)"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold" },
                                            "\u00A5",
                                            totals.transport.toLocaleString())),
                                    totals.totalAllowances > 0 && (React.createElement(React.Fragment, null,
                                        totals.allowances.family > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u5BB6\u65CF\u624B\u5F53"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.family.toLocaleString())),
                                        totals.allowances.sales > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u55B6\u696D\u624B\u5F53"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.sales.toLocaleString())),
                                        totals.allowances.position > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u5F79\u8077\u624B\u5F53"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.position.toLocaleString())),
                                        totals.allowances.commuting > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u901A\u52E4\u624B\u5F53"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.commuting.toLocaleString())),
                                        totals.allowances.expense > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u7D4C\u8CBB"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.expense.toLocaleString())),
                                        totals.allowances.housing > 0 && React.createElement("tr", null,
                                            React.createElement("td", { className: "border p-3" }, "\u5BB6\u8CC3\u88DC\u52A9"),
                                            React.createElement("td", { className: "border p-3 text-right" },
                                                "\u00A5",
                                                totals.allowances.housing.toLocaleString())))),
                                    React.createElement("tr", { className: "bg-blue-50" },
                                        React.createElement("td", { className: "border p-3 font-bold text-lg" }, "\u7DCF\u652F\u7D66\u984D"),
                                        React.createElement("td", { className: "border p-3 text-right font-bold text-lg text-blue-600" },
                                            "\u00A5",
                                            Math.round(totals.hourlyTotalGross).toLocaleString()))))))),
                    React.createElement("div", { className: "mb-4" },
                        React.createElement("div", { className: "flex justify-between items-center mb-4" },
                            React.createElement("h3", { className: "text-xl font-bold" }, "\u52E4\u6020\u8A73\u7D30"),
                            React.createElement("button", { onClick: () => exportAttendanceDetailToPNG(selectedPayslipEmployee), className: "px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 flex items-center gap-2" },
                                React.createElement(Download, { className: "w-4 h-4" }),
                                "\u52E4\u6020\u8A73\u7D30\u3092PNG\u4FDD\u5B58")),
                        React.createElement("div", { className: "text-sm text-gray-600 mb-2" },
                            "\u5408\u8A08\u52B4\u50CD\u6642\u9593: ",
                            totals.hours.toFixed(2),
                            "\u6642\u9593 (15\u5206\u5358\u4F4D\u3067\u8A08\u7B97)"),
                        React.createElement("div", { className: "overflow-x-auto", id: "attendance-detail-table" },
                            React.createElement("table", { className: "w-full border-collapse border text-sm" },
                                React.createElement("thead", { className: "bg-gray-100" },
                                    React.createElement("tr", null,
                                        React.createElement("th", { className: "border p-2" }, "\u65E5\u4ED8"),
                                        React.createElement("th", { className: "border p-2" }, "\u51FA\u52E4"),
                                        React.createElement("th", { className: "border p-2" }, "\u4F11\u61A9\u51651"),
                                        React.createElement("th", { className: "border p-2" }, "\u4F11\u61A9\u51FA1"),
                                        React.createElement("th", { className: "border p-2" }, "\u4F11\u61A9\u51652"),
                                        React.createElement("th", { className: "border p-2" }, "\u4F11\u61A9\u51FA2"),
                                        React.createElement("th", { className: "border p-2" }, "\u9000\u52E4"),
                                        React.createElement("th", { className: "border p-2" }, "\u52B4\u50CD\u6642\u9593"),
                                        React.createElement("th", { className: "border p-2" }, "\u65E5\u7D66"),
                                        React.createElement("th", { className: "border p-2" }, "\u5099\u8003"))),
                                React.createElement("tbody", null, workDays.map(({ day, dayOfWeek, record, workHours, dailyPay }) => {
                                    const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                                    const renderEditableCell = (field, value) => {
                                        const isEditing = (editingTime === null || editingTime === void 0 ? void 0 : editingTime.employeeId) === selectedPayslipEmployee
                                            && (editingTime === null || editingTime === void 0 ? void 0 : editingTime.dateKey) === dateKey
                                            && (editingTime === null || editingTime === void 0 ? void 0 : editingTime.field) === field;
                                        if (isEditing) {
                                            return (React.createElement("td", { className: "border p-1" },
                                                React.createElement("input", { type: "text", value: editingValue, onChange: (e) => setEditingValue(e.target.value), onKeyDown: (e) => {
                                                        if (e.key === 'Enter')
                                                            saveEditedTime();
                                                        if (e.key === 'Escape')
                                                            cancelEditingTime();
                                                    }, className: "w-full p-1 text-center border-2 border-blue-500", placeholder: "HH:MM", autoFocus: true }),
                                                React.createElement("label", { className: "flex items-center gap-1 mt-1 text-xs" },
                                                    React.createElement("input", { type: "checkbox", checked: editingIsHoliday, onChange: (e) => setEditingIsHoliday(e.target.checked), className: "rounded" }),
                                                    React.createElement("span", { className: "text-red-600 font-bold" }, "\u4F11\u65E5\u51FA\u52E4\uFF08\u5272\u589735%\uFF09")),
                                                React.createElement("div", { className: "flex items-center gap-1 mt-1" },
                                                    React.createElement("span", { className: "text-xs" }, "\u6642\u7D66:"),
                                                    React.createElement("input", { type: "number", value: editingHourlyRate, onChange: (e) => setEditingHourlyRate(e.target.value), onKeyDown: (e) => {
                                                            if (e.key === 'Enter')
                                                                saveEditedTime();
                                                            if (e.key === 'Escape')
                                                                cancelEditingTime();
                                                        }, className: "flex-1 p-1 text-xs border border-gray-300 rounded", placeholder: "\u6642\u7D66(\u5186)" }),
                                                    React.createElement("span", { className: "text-xs" }, "\u5186")),
                                                React.createElement("input", { type: "text", value: editingMemo, onChange: (e) => setEditingMemo(e.target.value), onKeyDown: (e) => {
                                                        if (e.key === 'Enter')
                                                            saveEditedTime();
                                                        if (e.key === 'Escape')
                                                            cancelEditingTime();
                                                    }, className: "w-full p-1 text-xs border border-gray-300 mt-1", placeholder: "\u30E1\u30E2(\u4F8B:\u8CB7\u3044\u7269\u3092\u983C\u3093\u3060\u70BA\u4FEE\u6B63)" }),
                                                React.createElement("div", { className: "flex gap-1 mt-1" },
                                                    React.createElement("button", { onClick: saveEditedTime, className: "flex-1 bg-green-500 text-white px-1 rounded text-xs" }, "\u4FDD\u5B58"),
                                                    React.createElement("button", { onClick: cancelEditingTime, className: "flex-1 bg-gray-500 text-white px-1 rounded text-xs" }, "\u53D6\u6D88"))));
                                        }
                                        return (React.createElement("td", { className: "border p-2 text-center cursor-pointer hover:bg-blue-50 no-print-hover", onClick: () => startEditingTime(selectedPayslipEmployee, dateKey, field, value), title: "\u30AF\u30EA\u30C3\u30AF\u3067\u7DE8\u96C6" }, value || '-'));
                                    };
                                    return (React.createElement("tr", { key: day },
                                        React.createElement("td", { className: "border p-2 text-center bg-gray-50" },
                                            day,
                                            "\u65E5(",
                                            dayOfWeek,
                                            ")"),
                                        renderEditableCell('clockIn', record === null || record === void 0 ? void 0 : record.clockIn),
                                        renderEditableCell('breakStart1', record === null || record === void 0 ? void 0 : record.breakStart1),
                                        renderEditableCell('breakEnd1', record === null || record === void 0 ? void 0 : record.breakEnd1),
                                        renderEditableCell('breakStart2', record === null || record === void 0 ? void 0 : record.breakStart2),
                                        renderEditableCell('breakEnd2', record === null || record === void 0 ? void 0 : record.breakEnd2),
                                        renderEditableCell('clockOut', record === null || record === void 0 ? void 0 : record.clockOut),
                                        React.createElement("td", { className: "border p-2 text-center bg-gray-50" },
                                            workHours.toFixed(2),
                                            "h"),
                                        React.createElement("td", { className: "border p-2 text-right bg-gray-50" },
                                            "\u00A5",
                                            Math.round(dailyPay.total).toLocaleString()),
                                        React.createElement("td", { className: "border p-2 text-left text-xs bg-gray-50" },
                                            (record === null || record === void 0 ? void 0 : record.isHoliday) && React.createElement("div", { className: "text-purple-600 font-bold" }, "\u4F11\u65E5\u51FA\u52E4(35%)"),
                                            dailyPay.overtimeHours > 0 && (React.createElement("div", { className: "text-orange-600 font-bold" },
                                                "\u8D85\u904E\u5206",
                                                dailyPay.overtimeHours.toFixed(2),
                                                "\u6642\u9593(25%)")),
                                            dailyPay.lateNightHours > 0 && (React.createElement("div", { className: "text-blue-600 font-bold" },
                                                "\u6DF1\u591C\u8CC3\u91D1",
                                                dailyPay.lateNightHours.toFixed(2),
                                                "\u6642\u9593(25%)")),
                                            (record === null || record === void 0 ? void 0 : record.editHistory) && record.editHistory.length > 0 && record.editHistory[record.editHistory.length - 1].memo && (React.createElement("div", { className: "text-gray-600 mt-1" }, record.editHistory[record.editHistory.length - 1].memo)))));
                                }))),
                            React.createElement("p", { className: "mt-2 text-gray-600 text-xs no-print" }, "\uD83D\uDCA1 \u6642\u523B\u30BB\u30EB\u3092\u30AF\u30EA\u30C3\u30AF\u3067\u7DE8\u96C6\u3067\u304D\u307E\u3059\u3002\u6642\u523B\u3068\u30E1\u30E2\u3092\u5165\u529B\u3057\u3066Enter\u3067\u4FDD\u5B58\u3001Esc\u3067\u30AD\u30E3\u30F3\u30BB\u30EB\u3002"))),
                    React.createElement("div", { className: "mt-8 text-sm text-gray-600" },
                        React.createElement("p", null, "\u203B\u3053\u306E\u7D66\u4E0E\u660E\u7D30\u66F8\u306F\u52B4\u50CD\u57FA\u6E96\u6CD5\u306B\u57FA\u3065\u304D\u30015\u5E74\u9593\u4FDD\u7BA1\u3057\u3066\u304F\u3060\u3055\u3044\u3002"),
                        React.createElement("p", null, "\u203B\u6642\u9593\u5916\u52B4\u50CD(8\u6642\u9593\u8D85\u904E)\u306F25%\u5272\u5897\u3001\u4F11\u65E5\u51FA\u52E4\u306F35%\u5272\u5897\u3001\u6DF1\u591C\u52B4\u50CD(22\u6642-\u7FCC5\u6642)\u306F25%\u5272\u5897\u306B\u3066\u8A08\u7B97\u3055\u308C\u3066\u3044\u307E\u3059\u3002"),
                        React.createElement("p", null, "\u203B\u52B4\u50CD\u6642\u9593\u306F15\u5206\u5358\u4F4D\u3067\u8A08\u7B97\u3055\u308C\u3066\u3044\u307E\u3059(\u51FA\u52E4\u306F\u5207\u308A\u4E0A\u3052\u3001\u9000\u52E4\u306F\u5207\u308A\u6368\u3066)"))));
            })()),
        showAddEmployee && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
            React.createElement("div", { className: "bg-white rounded-lg p-6 w-full max-w-md" },
                React.createElement("h3", { className: "text-xl font-bold mb-4" }, "\u5F93\u696D\u54E1\u3092\u8FFD\u52A0"),
                React.createElement(AddEmployeeForm, { onSave: addEmployee, onCancel: () => setShowAddEmployee(false) })))),
        editingTime && (React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50", onClick: () => setEditingTime(null) },
            React.createElement("div", { className: "bg-white rounded-lg p-6 w-96", onClick: (e) => e.stopPropagation() },
                React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u6642\u523B\u7DE8\u96C6"),
                React.createElement("div", { className: "space-y-4" },
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u6642\u523B (HH:MM)"),
                        React.createElement("input", { type: "text", value: editingValue, onChange: (e) => setEditingValue(e.target.value), className: "w-full p-2 border rounded", placeholder: "09:00" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" },
                            React.createElement("input", { type: "checkbox", checked: editingIsHoliday, onChange: (e) => setEditingIsHoliday(e.target.checked), className: "mr-2" }),
                            "\u4F11\u65E5\u51FA\u52E4 (35%\u5272\u5897)")),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u6642\u7D66\uFF08\u3053\u306E\u65E5\u306E\u307F\uFF09"),
                        React.createElement("input", { type: "number", value: editingHourlyRate, onChange: (e) => setEditingHourlyRate(e.target.value), className: "w-full p-2 border rounded", placeholder: "1500" })),
                    React.createElement("div", null,
                        React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u30E1\u30E2"),
                        React.createElement("textarea", { value: editingMemo, onChange: (e) => setEditingMemo(e.target.value), className: "w-full p-2 border rounded", rows: "3", placeholder: "\u5099\u8003\u3084\u30E1\u30E2\u3092\u5165\u529B" })),
                    React.createElement("div", { className: "flex gap-2 justify-end" },
                        React.createElement("button", { onClick: () => setEditingTime(null), className: "px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600" }, "\u30AD\u30E3\u30F3\u30BB\u30EB"),
                        React.createElement("button", { onClick: saveEditedTime, className: "px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600" }, "\u4FDD\u5B58")))))),
        React.createElement(CustomAlert, null),
        React.createElement(CustomConfirm, null),
        React.createElement(ImageSettingsModal, null),
        React.createElement("div", { className: "bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg shadow-lg p-6 mb-6 border-2 border-purple-200" },
            React.createElement("div", { className: "flex items-center justify-between" },
                React.createElement("div", { className: "flex items-center gap-3" },
                    React.createElement("div", { className: "bg-purple-600 text-white p-3 rounded-lg" },
                        React.createElement("svg", { className: "w-8 h-8", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
                            React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" }))),
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-2xl font-bold text-gray-800" }, "\u4F1A\u8A08\u30BD\u30D5\u30C8\u9023\u643A"),
                        React.createElement("p", { className: "text-sm text-gray-600 mt-1" }, "\u5F25\u751F\u4F1A\u8A08\u30FBfreee\u30FB\u30DE\u30CD\u30FC\u30D5\u30A9\u30EF\u30FC\u30C9\u306A\u3069\u306B\u5BFE\u5FDC"))),
                React.createElement("button", { onClick: exportAccountingDataCSV, className: "px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 shadow-lg hover:shadow-xl transition-all flex items-center gap-2 font-bold", title: "\u5E74\u5EA6\u3092\u9078\u629E\u3057\u3066\u58F2\u4E0A\u30FB\u4EBA\u4EF6\u8CBB\u30FB\u5F93\u696D\u54E1\u30DE\u30B9\u30BF\u306A\u3069\u306ECSV\u3092\u4E00\u62EC\u51FA\u529B" },
                    React.createElement("svg", { className: "w-5 h-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
                        React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" })),
                    "\u30C7\u30FC\u30BF\u9023\u643ACSV\u51FA\u529B")),
            React.createElement("div", { className: "mt-4 grid grid-cols-2 md:grid-cols-4 gap-3" },
                React.createElement("div", { className: "bg-white p-3 rounded-lg shadow-sm" },
                    React.createElement("div", { className: "text-xs text-gray-500 mb-1" }, "\u58F2\u4E0A\u30C7\u30FC\u30BF"),
                    React.createElement("div", { className: "text-sm font-semibold text-gray-700" }, "\u30B5\u30DE\u30EA\u30FC\u30FB\u65E5\u6B21\u660E\u7D30")),
                React.createElement("div", { className: "bg-white p-3 rounded-lg shadow-sm" },
                    React.createElement("div", { className: "text-xs text-gray-500 mb-1" }, "\u5546\u54C1\u5225\u58F2\u4E0A"),
                    React.createElement("div", { className: "text-sm font-semibold text-gray-700" }, "\u8CA9\u58F2\u6570\u91CF\u30FB\u91D1\u984D")),
                React.createElement("div", { className: "bg-white p-3 rounded-lg shadow-sm" },
                    React.createElement("div", { className: "text-xs text-gray-500 mb-1" }, "\u4EBA\u4EF6\u8CBB\u30C7\u30FC\u30BF"),
                    React.createElement("div", { className: "text-sm font-semibold text-gray-700" }, "\u5F93\u696D\u54E1\u5225\u7D66\u4E0E")),
                React.createElement("div", { className: "bg-white p-3 rounded-lg shadow-sm" },
                    React.createElement("div", { className: "text-xs text-gray-500 mb-1" }, "\u4ED5\u8A33\u5E33"),
                    React.createElement("div", { className: "text-sm font-semibold text-gray-700" }, "\u5F25\u751F\u4F1A\u8A08\u5F62\u5F0F"))))));
};
// ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const EditEmployeeForm = ({ employee, onSave, onCancel }) => {
    const [name, setName] = useState((employee === null || employee === void 0 ? void 0 : employee.name) || '');
    const [rate, setRate] = useState((employee === null || employee === void 0 ? void 0 : employee.hourlyRate) || 0);
    const [transport, setTransport] = useState((employee === null || employee === void 0 ? void 0 : employee.transportAllowance) || 0);
    const [salaryType, setSalaryType] = useState((employee === null || employee === void 0 ? void 0 : employee.salaryType) || 'æ™‚é–“çµ¦');
    const [monthlySalary, setMonthlySalary] = useState((employee === null || employee === void 0 ? void 0 : employee.monthlySalary) || 0);
    const [prefecture, setPrefecture] = useState((employee === null || employee === void 0 ? void 0 : employee.prefecture) || 'æ±äº¬');
    const [age, setAge] = useState((employee === null || employee === void 0 ? void 0 : employee.age) || 30);
    const [minimumWage, setMinimumWage] = useState((employee === null || employee === void 0 ? void 0 : employee.minimumWage) || INSURANCE_DATA.minimumWage[(employee === null || employee === void 0 ? void 0 : employee.prefecture) || 'æ±äº¬']);
    const [insuranceSwitches, setInsuranceSwitches] = useState((employee === null || employee === void 0 ? void 0 : employee.insuranceSwitches) || {
        healthInsurance: true,
        pension: true,
        employmentInsurance: true,
        residentTax: true
    });
    const [allowances, setAllowances] = useState((employee === null || employee === void 0 ? void 0 : employee.allowances) || {
        family: 0, sales: 0, position: 0, commuting: 0, expense: 0, housing: 0
    });
    const [deductions, setDeductions] = useState((employee === null || employee === void 0 ? void 0 : employee.deductions) || {
        rent: 0, utilities: 0
    });
    const [salaryHistory, setSalaryHistory] = useState((employee === null || employee === void 0 ? void 0 : employee.salaryHistory) ? [...employee.salaryHistory].sort((a, b) => a.fromYearMonth.localeCompare(b.fromYearMonth)) : []);
    const prefectures = Object.keys(INSURANCE_DATA.minimumWage);
    const addSalaryHistoryEntry = () => {
        setSalaryHistory([...salaryHistory, { fromYearMonth: '', monthlySalary: 0, prefecture: 'æ±äº¬' }]);
    };
    const removeSalaryHistoryEntry = (index) => {
        setSalaryHistory(salaryHistory.filter((_, i) => i !== index));
    };
    const updateSalaryHistoryEntry = (index, field, value) => {
        const updated = salaryHistory.map((entry, i) => i === index ? Object.assign(Object.assign({}, entry), { [field]: field === 'monthlySalary' ? (parseFloat(value) || 0) : value }) : entry);
        setSalaryHistory(updated);
    };
    const handlePrefectureChange = (newPref) => {
        setPrefecture(newPref);
        setMinimumWage(INSURANCE_DATA.minimumWage[newPref] || 1000);
    };
    return (React.createElement("div", { className: "space-y-3 p-4 bg-gray-50 rounded w-full max-h-[70vh] overflow-y-auto" },
        React.createElement("div", { className: "grid grid-cols-2 gap-3" },
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u6C0F\u540D"),
                React.createElement("input", { type: "text", value: name, onChange: (e) => setName(e.target.value), className: "w-full p-2 border rounded" })),
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u7D66\u4E0E\u30BF\u30A4\u30D7"),
                React.createElement("select", { value: salaryType, onChange: (e) => setSalaryType(e.target.value), className: "w-full p-2 border rounded" },
                    React.createElement("option", { value: "\u6642\u9593\u7D66" }, "\u6642\u9593\u7D66"),
                    React.createElement("option", { value: "\u56FA\u5B9A\u7D66" }, "\u56FA\u5B9A\u7D66")))),
        React.createElement("div", { className: "grid grid-cols-2 gap-3" },
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u90FD\u9053\u5E9C\u770C"),
                React.createElement("select", { value: prefecture, onChange: (e) => setPrefecture(e.target.value), className: "w-full p-2 border rounded text-sm" }, prefectures.map(pref => (React.createElement("option", { key: pref, value: pref }, pref))))),
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u5E74\u9F62"),
                React.createElement("input", { type: "number", value: age, onChange: (e) => setAge(e.target.value), className: "w-full p-2 border rounded" }))),
        React.createElement("div", null,
            React.createElement("label", { className: "text-sm font-medium" }, "\u6700\u4F4E\u8CC3\u91D1(\u5186/\u6642)"),
            React.createElement("input", { type: "number", value: minimumWage, onChange: (e) => setMinimumWage(e.target.value), className: "w-full p-2 border rounded" }),
            React.createElement("div", { className: "text-xs text-gray-500 mt-1" },
                "\u203B\u53C2\u8003: ",
                prefecture,
                "\u306E\u6CD5\u5B9A\u6700\u4F4E\u8CC3\u91D1\u306F\u00A5",
                INSURANCE_DATA.minimumWage[prefecture],
                "\u3067\u3059")),
        React.createElement("div", { className: "grid grid-cols-2 gap-3" },
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u6642\u7D66(\u5186)"),
                React.createElement("input", { type: "number", value: rate, onChange: (e) => setRate(e.target.value), className: "w-full p-2 border rounded" })),
            React.createElement("div", null,
                React.createElement("label", { className: "text-sm font-medium" }, "\u4EA4\u901A\u8CBB(\u5186/\u65E5)"),
                React.createElement("input", { type: "number", value: transport, onChange: (e) => setTransport(e.target.value), className: "w-full p-2 border rounded" }))),
        salaryType === 'å›ºå®šçµ¦' && (React.createElement("div", null,
            React.createElement("label", { className: "text-sm font-medium" }, "\u56FA\u5B9A\u7D66(\u6708\u984D\u30FB\u5186)"),
            React.createElement("input", { type: "number", value: monthlySalary, onChange: (e) => setMonthlySalary(e.target.value), className: "w-full p-2 border rounded" }))),
        React.createElement("div", { className: "bg-yellow-50 p-2 rounded" },
            React.createElement("h5", { className: "text-sm font-bold mb-2" }, "\u652F\u7D66\u9805\u76EE\uFF08\u624B\u5F53\uFF09"),
            React.createElement("div", { className: "grid grid-cols-3 gap-2" },
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u5BB6\u65CF\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.family, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { family: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u55B6\u696D\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.sales, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { sales: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u5F79\u8077\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.position, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { position: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u901A\u52E4\u8CBB"),
                    React.createElement("input", { type: "number", value: allowances.commuting, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { commuting: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u7D4C\u8CBB"),
                    React.createElement("input", { type: "number", value: allowances.expense, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { expense: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u5BB6\u8CC3\u88DC\u52A9"),
                    React.createElement("input", { type: "number", value: allowances.housing, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { housing: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })))),
        React.createElement("div", { className: "bg-blue-50 p-2 rounded" },
            React.createElement("h5", { className: "text-sm font-bold mb-2" }, "\u793E\u4F1A\u4FDD\u967A\u30FB\u7A0E\u91D1\u8A2D\u5B9A"),
            React.createElement("div", { className: "text-xs text-gray-600 mb-2" }, "\u203B\u30A2\u30EB\u30D0\u30A4\u30C8\u3084\u56FD\u6C11\u5065\u5EB7\u4FDD\u967A\u306E\u65B9\u306F\u8A72\u5F53\u9805\u76EE\u3092OFF\u306B\u3057\u3066\u304F\u3060\u3055\u3044"),
            React.createElement("div", { className: "space-y-1" },
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer text-sm" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.healthInsurance, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { healthInsurance: e.target.checked })), className: "w-3 h-3" }),
                    "\u5065\u5EB7\u4FDD\u967A\u3092\u9069\u7528"),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer text-sm" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.pension, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { pension: e.target.checked })), className: "w-3 h-3" }),
                    "\u539A\u751F\u5E74\u91D1\u3092\u9069\u7528"),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer text-sm" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.employmentInsurance, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { employmentInsurance: e.target.checked })), className: "w-3 h-3" }),
                    "\u96C7\u7528\u4FDD\u967A\u3092\u9069\u7528"),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer text-sm" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.residentTax, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { residentTax: e.target.checked })), className: "w-3 h-3" }),
                    "\u4F4F\u6C11\u7A0E\u3092\u9069\u7528"))),
        React.createElement("div", { className: "bg-red-50 p-2 rounded" },
            React.createElement("h5", { className: "text-sm font-bold mb-2" }, "\u63A7\u9664\u9805\u76EE\uFF08\u624B\u5165\u529B\u5206\uFF09"),
            React.createElement("div", { className: "grid grid-cols-2 gap-2" },
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u5BB6\u8CC3"),
                    React.createElement("input", { type: "number", value: deductions.rent, onChange: (e) => setDeductions(Object.assign(Object.assign({}, deductions), { rent: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs" }, "\u5149\u71B1\u8CBB"),
                    React.createElement("input", { type: "number", value: deductions.utilities, onChange: (e) => setDeductions(Object.assign(Object.assign({}, deductions), { utilities: parseFloat(e.target.value) || 0 })), className: "w-full p-1 border rounded text-sm" })))),
        salaryType === 'å›ºå®šçµ¦' && (React.createElement("div", { className: "bg-purple-50 p-3 rounded border border-purple-200" },
            React.createElement("div", { className: "flex items-center justify-between mb-2" },
                React.createElement("h5", { className: "text-sm font-bold text-purple-800" }, "\u7D66\u4E0E\u5909\u66F4\u5C65\u6B74\uFF08\u7D2F\u8A08\u5DEE\u984D\u8A08\u7B97\u306B\u4F7F\u7528\uFF09"),
                React.createElement("button", { type: "button", onClick: addSalaryHistoryEntry, className: "text-xs px-2 py-1 bg-purple-500 text-white rounded hover:bg-purple-600" }, "\uFF0B \u8FFD\u52A0")),
            React.createElement("div", { className: "text-xs text-gray-600 mb-2" },
                "\u203B \u7D66\u4E0E\u30FB\u90FD\u9053\u5E9C\u770C\u304C\u5909\u308F\u3063\u305F\u5834\u5408\u3001\u5909\u66F4\u524D\u306E\u60C5\u5831\u3092\u3053\u3053\u306B\u767B\u9332\u3057\u3066\u304F\u3060\u3055\u3044\u3002",
                React.createElement("br", null),
                "\u300C\u9069\u7528\u958B\u59CB\u5E74\u6708\u300D\u4EE5\u964D\u306F\u767B\u9332\u3057\u305F\u7D66\u4E0E\u30FB\u90FD\u9053\u5E9C\u770C\u3067\u8A08\u7B97\u3055\u308C\u307E\u3059\u3002"),
            salaryHistory.length === 0 ? (React.createElement("p", { className: "text-xs text-gray-500" }, "\u5C65\u6B74\u306A\u3057\uFF08\u5168\u671F\u9593\u3001\u4E0A\u8A18\u306E\u73FE\u5728\u306E\u8A2D\u5B9A\u3067\u8A08\u7B97\uFF09")) : (React.createElement("div", { className: "space-y-2" }, salaryHistory.map((entry, index) => (React.createElement("div", { key: index, className: "flex gap-2 items-center bg-white p-2 rounded border" },
                React.createElement("div", { className: "flex-1" },
                    React.createElement("label", { className: "text-xs text-gray-600" }, "\u9069\u7528\u958B\u59CB\u5E74\u6708"),
                    React.createElement("input", { type: "month", value: entry.fromYearMonth, onChange: (e) => updateSalaryHistoryEntry(index, 'fromYearMonth', e.target.value), className: "w-full p-1 border rounded text-xs" })),
                React.createElement("div", { className: "flex-1" },
                    React.createElement("label", { className: "text-xs text-gray-600" }, "\u6708\u984D\u7D66\u4E0E\uFF08\u5186\uFF09"),
                    React.createElement("input", { type: "number", value: entry.monthlySalary, onChange: (e) => updateSalaryHistoryEntry(index, 'monthlySalary', e.target.value), className: "w-full p-1 border rounded text-xs" })),
                React.createElement("div", { className: "flex-1" },
                    React.createElement("label", { className: "text-xs text-gray-600" }, "\u90FD\u9053\u5E9C\u770C"),
                    React.createElement("select", { value: entry.prefecture, onChange: (e) => updateSalaryHistoryEntry(index, 'prefecture', e.target.value), className: "w-full p-1 border rounded text-xs" }, Object.keys(INSURANCE_DATA.minimumWage).map(pref => (React.createElement("option", { key: pref, value: pref }, pref))))),
                React.createElement("button", { type: "button", onClick: () => removeSalaryHistoryEntry(index), className: "text-red-500 hover:text-red-700 text-xs px-1", title: "\u524A\u9664" }, "\u2715")))))),
            salaryHistory.length > 0 && (React.createElement("div", { className: "text-xs text-purple-700 mt-2 bg-purple-100 p-2 rounded" },
                "\u26A0\uFE0F \u73FE\u5728\u306E\u8A2D\u5B9A\uFF08\u4E0A\u8A18\u30D5\u30A9\u30FC\u30E0\uFF09\u304C\u6700\u65B0\u671F\u9593\u306B\u9069\u7528\u3055\u308C\u307E\u3059\u3002",
                React.createElement("br", null),
                "\u4F8B: \u5C65\u6B74\u300C2024-04\u301C, \u7D66\u4E0EA, \u5948\u826F\u300D\uFF0B\u73FE\u5728\u300C2025-01\u301C, \u7D66\u4E0EB, \u6771\u4EAC\u300D\u306E\u5834\u5408\u3001",
                React.createElement("br", null),
                "2025-01\u4EE5\u964D\u306F\u7D66\u4E0EB\u30FB\u6771\u4EAC\u3001\u305D\u308C\u4EE5\u524D\u306F\u7D66\u4E0EA\u30FB\u5948\u826F\u3067\u8A08\u7B97\u3055\u308C\u307E\u3059\u3002")))),
        React.createElement("div", { className: "flex gap-2 justify-end" },
            React.createElement("button", { onClick: () => {
                    if (employee === null || employee === void 0 ? void 0 : employee.id) {
                        onSave(employee.id, name, rate, transport, salaryType, monthlySalary, prefecture, age, allowances, deductions, minimumWage, insuranceSwitches, salaryHistory);
                    }
                }, className: "px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center gap-2" },
                React.createElement(Save, { className: "w-4 h-4" }),
                "\u4FDD\u5B58"),
            React.createElement("button", { onClick: onCancel, className: "px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 flex items-center gap-2" },
                React.createElement(X, { className: "w-4 h-4" }),
                "\u30AD\u30E3\u30F3\u30BB\u30EB"))));
};
const AddEmployeeForm = ({ onSave, onCancel }) => {
    const [name, setName] = useState('');
    const [rate, setRate] = useState('');
    const [transport, setTransport] = useState('');
    const [salaryType, setSalaryType] = useState('æ™‚é–“çµ¦');
    const [monthlySalary, setMonthlySalary] = useState('');
    const [prefecture, setPrefecture] = useState('æ±äº¬');
    const [age, setAge] = useState('30');
    const [minimumWage, setMinimumWage] = useState(INSURANCE_DATA.minimumWage['æ±äº¬']);
    const [insuranceSwitches, setInsuranceSwitches] = useState({
        healthInsurance: true,
        pension: true,
        employmentInsurance: true,
        residentTax: true
    });
    const [allowances, setAllowances] = useState({
        family: 0, sales: 0, position: 0, commuting: 0, expense: 0, housing: 0
    });
    const [deductions, setDeductions] = useState({ rent: 0, utilities: 0 });
    const prefectures = Object.keys(INSURANCE_DATA.minimumWage);
    // éƒ½é“åºœçœŒå¤‰æ›´æ™‚ã«å‚è€ƒå€¤ã¨ã—ã¦æœ€ä½è³ƒé‡‘ã‚’æ›´æ–°
    const handlePrefectureChange = (newPref) => {
        setPrefecture(newPref);
        setMinimumWage(INSURANCE_DATA.minimumWage[newPref] || 1000);
    };
    return (React.createElement("div", { className: "space-y-4 max-h-[70vh] overflow-y-auto p-4" },
        React.createElement("div", { className: "grid grid-cols-2 gap-4" },
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u6C0F\u540D *"),
                React.createElement("input", { type: "text", value: name, onChange: (e) => setName(e.target.value), className: "w-full p-2 border rounded", placeholder: "\u5C71\u7530\u592A\u90CE" })),
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u7D66\u4E0E\u30BF\u30A4\u30D7 *"),
                React.createElement("select", { value: salaryType, onChange: (e) => setSalaryType(e.target.value), className: "w-full p-2 border rounded" },
                    React.createElement("option", { value: "\u6642\u9593\u7D66" }, "\u6642\u9593\u7D66"),
                    React.createElement("option", { value: "\u56FA\u5B9A\u7D66" }, "\u56FA\u5B9A\u7D66")))),
        React.createElement("div", { className: "grid grid-cols-2 gap-4" },
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u90FD\u9053\u5E9C\u770C *"),
                React.createElement("select", { value: prefecture, onChange: (e) => handlePrefectureChange(e.target.value), className: "w-full p-2 border rounded" }, prefectures.map(pref => (React.createElement("option", { key: pref, value: pref }, pref))))),
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u5E74\u9F62 *"),
                React.createElement("input", { type: "number", value: age, onChange: (e) => setAge(e.target.value), className: "w-full p-2 border rounded", placeholder: "30" }))),
        React.createElement("div", null,
            React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u6700\u4F4E\u8CC3\u91D1(\u5186/\u6642) *"),
            React.createElement("input", { type: "number", value: minimumWage, onChange: (e) => setMinimumWage(e.target.value), className: "w-full p-2 border rounded", placeholder: "1000" }),
            React.createElement("div", { className: "text-xs text-gray-500 mt-1" },
                "\u203B\u53C2\u8003: ",
                prefecture,
                "\u306E\u6CD5\u5B9A\u6700\u4F4E\u8CC3\u91D1\u306F\u00A5",
                INSURANCE_DATA.minimumWage[prefecture],
                "\u3067\u3059\uFF08\u56FA\u5B9A\u7D66\u306E\u5834\u5408\u3001\u3053\u306E\u6700\u4F4E\u8CC3\u91D1\u3067\u6642\u9593\u7D66\u8A08\u7B97\u3055\u308C\u307E\u3059\uFF09")),
        React.createElement("div", { className: "grid grid-cols-2 gap-4" },
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u6642\u7D66(\u5186) *"),
                React.createElement("input", { type: "number", value: rate, onChange: (e) => setRate(e.target.value), className: "w-full p-2 border rounded", placeholder: minimumWage })),
            React.createElement("div", null,
                React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u4EA4\u901A\u8CBB(\u5186/\u65E5)"),
                React.createElement("input", { type: "number", value: transport, onChange: (e) => setTransport(e.target.value), className: "w-full p-2 border rounded", placeholder: "500" }))),
        salaryType === 'å›ºå®šçµ¦' && (React.createElement("div", { className: "bg-green-50 p-3 rounded" },
            React.createElement("label", { className: "block text-sm font-medium mb-2" }, "\u56FA\u5B9A\u7D66(\u6708\u984D\u30FB\u5186) *"),
            React.createElement("input", { type: "number", value: monthlySalary, onChange: (e) => setMonthlySalary(e.target.value), className: "w-full p-2 border rounded", placeholder: "250000" }),
            React.createElement("div", { className: "text-xs text-gray-500 mt-1" }, "\u203B\u56FA\u5B9A\u7D66\u306E\u5834\u5408\u3001\u5B9F\u969B\u306E\u652F\u7D66\u984D\u306F\u56FA\u5B9A\u7D66\u3067\u3059\u304C\u3001\u6642\u9593\u7D66\u63DB\u7B97\u306F\u6700\u4F4E\u8CC3\u91D1\u3067\u8A08\u7B97\u3055\u308C\u307E\u3059"))),
        React.createElement("div", { className: "bg-yellow-50 p-3 rounded" },
            React.createElement("h4", { className: "font-bold mb-3" }, "\u652F\u7D66\u9805\u76EE\uFF08\u624B\u5F53\uFF09"),
            React.createElement("div", { className: "grid grid-cols-2 gap-3" },
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u5BB6\u65CF\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.family, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { family: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u55B6\u696D\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.sales, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { sales: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u5F79\u8077\u624B\u5F53"),
                    React.createElement("input", { type: "number", value: allowances.position, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { position: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u901A\u52E4\u8CBB"),
                    React.createElement("input", { type: "number", value: allowances.commuting, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { commuting: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u7D4C\u8CBB"),
                    React.createElement("input", { type: "number", value: allowances.expense, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { expense: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u5BB6\u8CC3\u88DC\u52A9"),
                    React.createElement("input", { type: "number", value: allowances.housing, onChange: (e) => setAllowances(Object.assign(Object.assign({}, allowances), { housing: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })))),
        React.createElement("div", { className: "bg-blue-50 p-3 rounded" },
            React.createElement("h4", { className: "font-bold mb-3" }, "\u793E\u4F1A\u4FDD\u967A\u30FB\u7A0E\u91D1\u8A2D\u5B9A"),
            React.createElement("div", { className: "text-xs text-gray-600 mb-3" }, "\u203B\u30A2\u30EB\u30D0\u30A4\u30C8\u3084\u56FD\u6C11\u5065\u5EB7\u4FDD\u967A\u306E\u65B9\u306F\u8A72\u5F53\u9805\u76EE\u3092OFF\u306B\u3057\u3066\u304F\u3060\u3055\u3044"),
            React.createElement("div", { className: "space-y-2" },
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.healthInsurance, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { healthInsurance: e.target.checked })), className: "w-4 h-4" }),
                    React.createElement("span", { className: "text-sm" }, "\u5065\u5EB7\u4FDD\u967A\u3092\u9069\u7528\u3059\u308B")),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.pension, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { pension: e.target.checked })), className: "w-4 h-4" }),
                    React.createElement("span", { className: "text-sm" }, "\u539A\u751F\u5E74\u91D1\u3092\u9069\u7528\u3059\u308B")),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.employmentInsurance, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { employmentInsurance: e.target.checked })), className: "w-4 h-4" }),
                    React.createElement("span", { className: "text-sm" }, "\u96C7\u7528\u4FDD\u967A\u3092\u9069\u7528\u3059\u308B")),
                React.createElement("label", { className: "flex items-center gap-2 cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: insuranceSwitches.residentTax, onChange: (e) => setInsuranceSwitches(Object.assign(Object.assign({}, insuranceSwitches), { residentTax: e.target.checked })), className: "w-4 h-4" }),
                    React.createElement("span", { className: "text-sm" }, "\u4F4F\u6C11\u7A0E\u3092\u9069\u7528\u3059\u308B"))),
            React.createElement("div", { className: "text-xs text-gray-500 mt-2" }, "\u6240\u5F97\u7A0E\u306F\u6CD5\u5F8B\u306B\u3088\u308A\u81EA\u52D5\u9069\u7528\u3055\u308C\u307E\u3059")),
        React.createElement("div", { className: "bg-red-50 p-3 rounded" },
            React.createElement("h4", { className: "font-bold mb-3" }, "\u63A7\u9664\u9805\u76EE\uFF08\u624B\u5165\u529B\u5206\uFF09"),
            React.createElement("div", { className: "text-xs text-gray-600 mb-2" }, "\u203B\u5065\u5EB7\u4FDD\u967A\u30FB\u539A\u751F\u5E74\u91D1\u30FB\u96C7\u7528\u4FDD\u967A\u30FB\u6240\u5F97\u7A0E\u30FB\u4F4F\u6C11\u7A0E\u306F\u81EA\u52D5\u8A08\u7B97\u3055\u308C\u307E\u3059"),
            React.createElement("div", { className: "grid grid-cols-2 gap-3" },
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u5BB6\u8CC3"),
                    React.createElement("input", { type: "number", value: deductions.rent, onChange: (e) => setDeductions(Object.assign(Object.assign({}, deductions), { rent: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })),
                React.createElement("div", null,
                    React.createElement("label", { className: "block text-xs mb-1" }, "\u5149\u71B1\u8CBB"),
                    React.createElement("input", { type: "number", value: deductions.utilities, onChange: (e) => setDeductions(Object.assign(Object.assign({}, deductions), { utilities: parseFloat(e.target.value) || 0 })), className: "w-full p-2 border rounded text-sm", placeholder: "0" })))),
        React.createElement("div", { className: "flex gap-3 justify-end sticky bottom-0 bg-white pt-3 border-t" },
            React.createElement("button", { onClick: onCancel, className: "px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600" }, "\u30AD\u30E3\u30F3\u30BB\u30EB"),
            React.createElement("button", { onClick: () => {
                    if (name && rate) {
                        onSave(name, rate, transport || 0, salaryType, monthlySalary || 0, prefecture, age, allowances, deductions, minimumWage, insuranceSwitches);
                        setName('');
                        setRate('');
                        setTransport('');
                        setSalaryType('æ™‚é–“çµ¦');
                        setMonthlySalary('');
                        setPrefecture('æ±äº¬');
                        setAge('30');
                        setAllowances({ family: 0, sales: 0, position: 0, commuting: 0, expense: 0, housing: 0 });
                        setDeductions({ rent: 0, utilities: 0 });
                    }
                    else {
                        showCustomAlertFunc('åå‰ã¨æ™‚çµ¦ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'âš ï¸ å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'âš ï¸');
                    }
                }, className: "px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600" }, "\u8FFD\u52A0"))));
};
// ========== ğŸ’¾ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ==========
const BackupManagement = ({ currentStoreId, showCustomConfirm, showCustomAlert }) => {
    const [backups, setBackups] = useState([]);
    const [loading, setLoading] = useState(true);
    const [restoring, setRestoring] = useState(false);
    const [creating, setCreating] = useState(false);
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸€è¦§ã‚’èª­ã¿è¾¼ã‚€
    useEffect(() => {
        loadBackups();
    }, [currentStoreId]);
    const loadBackups = async () => {
        try {
            setLoading(true);
            const { getDocs, collection } = window.firebaseModules;
            let backupsRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                backupsRef = collection(window.db, 'stores', currentStoreId, 'backups');
            }
            else {
                backupsRef = collection(window.db, 'backups');
            }
            const snapshot = await getDocs(backupsRef);
            const backupsList = [];
            snapshot.forEach(doc => {
                var _a;
                const data = doc.data();
                backupsList.push(Object.assign(Object.assign({ id: doc.id }, data), { timestamp: ((_a = data.timestamp) === null || _a === void 0 ? void 0 : _a.toDate()) || new Date() }));
            });
            // æ—¥ä»˜é †ã«ã‚½ãƒ¼ãƒˆï¼ˆæ–°ã—ã„é †ï¼‰
            backupsList.sort((a, b) => b.timestamp - a.timestamp);
            setBackups(backupsList);
            setLoading(false);
            console.log('ğŸ“‹ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸€è¦§:', backupsList.length, 'ä»¶');
        }
        catch (error) {
            console.error('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            setLoading(false);
        }
    };
    // æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ
    const createManualBackup = async () => {
        var _a;
        try {
            // ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            const confirmResult = await showCustomConfirm('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ã‹ï¼Ÿ\n\nä»¥ä¸‹ãŒãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã™ï¼š\nâ€¢ å•†å“\nâ€¢ å¾“æ¥­å“¡\nâ€¢ æ³¨æ–‡å±¥æ­´\nâ€¢ å‹¤æ€ ãƒ‡ãƒ¼ã‚¿\nâ€¢ ãƒ†ãƒ¼ãƒ–ãƒ«\nâ€¢ å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®š\nâ€¢ ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š\nâ€¢ åœ¨åº«è¨­å®š\nâ€¢ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š\nâ€¢ å–¶æ¥­æ™‚é–“è¨­å®š\nâ€¢ ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š', 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ', 'ä½œæˆã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
            if (!confirmResult)
                return;
            // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã§ãƒ¡ãƒ¢å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹
            const memo = await new Promise((resolve) => {
                // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã®HTMLè¦ç´ ã‚’ä½œæˆ
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                            position: fixed;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: rgba(0, 0, 0, 0.5);
                            backdrop-filter: blur(4px);
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            z-index: 10000;
                            animation: fadeIn 0.3s ease;
                        `;
                const dialog = document.createElement('div');
                dialog.style.cssText = `
                            background: white;
                            border-radius: 20px;
                            padding: 32px;
                            max-width: 480px;
                            width: 90%;
                            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                            animation: slideUp 0.3s ease;
                        `;
                const title = document.createElement('div');
                title.textContent = 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ãƒ¡ãƒ¢ã‚’è¿½åŠ ';
                title.style.cssText = `
                            font-size: 20px;
                            font-weight: bold;
                            color: #1a202c;
                            margin-bottom: 12px;
                        `;
                const subtitle = document.createElement('div');
                subtitle.textContent = 'ä»»æ„ã§ãƒ¡ãƒ¢ã‚’å…¥åŠ›ã§ãã¾ã™';
                subtitle.style.cssText = `
                            font-size: 14px;
                            color: #718096;
                            margin-bottom: 20px;
                        `;
                const example = document.createElement('div');
                example.textContent = 'ä¾‹: ä¾¡æ ¼æ”¹å®šå‰ã€3æœˆ1æ—¥ã‹ã‚‰ã®ä¾¡æ ¼ã€ãªã©';
                example.style.cssText = `
                            font-size: 13px;
                            color: #a0aec0;
                            margin-bottom: 16px;
                            font-style: italic;
                        `;
                const input = document.createElement('input');
                input.type = 'text';
                input.maxLength = 30;
                input.placeholder = 'ãƒ¡ãƒ¢ã‚’å…¥åŠ›ï¼ˆ30æ–‡å­—ä»¥å†…ï¼‰';
                input.style.cssText = `
                            width: 100%;
                            padding: 14px;
                            border: 2px solid #e2e8f0;
                            border-radius: 10px;
                            font-size: 15px;
                            margin-bottom: 24px;
                            transition: all 0.2s;
                            box-sizing: border-box;
                        `;
                input.addEventListener('focus', () => {
                    input.style.borderColor = '#3b82f6';
                    input.style.boxShadow = '0 0 0 3px rgba(59, 130, 246, 0.1)';
                });
                input.addEventListener('blur', () => {
                    input.style.borderColor = '#e2e8f0';
                    input.style.boxShadow = 'none';
                });
                const buttonContainer = document.createElement('div');
                buttonContainer.style.cssText = `
                            display: flex;
                            gap: 12px;
                            justify-content: flex-end;
                        `;
                const cancelBtn = document.createElement('button');
                cancelBtn.textContent = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«';
                cancelBtn.style.cssText = `
                            padding: 12px 24px;
                            border: none;
                            border-radius: 10px;
                            font-size: 15px;
                            font-weight: 600;
                            cursor: pointer;
                            background: #f7fafc;
                            color: #4a5568;
                            transition: all 0.2s;
                        `;
                cancelBtn.addEventListener('mouseover', () => {
                    cancelBtn.style.background = '#edf2f7';
                });
                cancelBtn.addEventListener('mouseout', () => {
                    cancelBtn.style.background = '#f7fafc';
                });
                cancelBtn.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                    resolve(null);
                });
                const okBtn = document.createElement('button');
                okBtn.textContent = 'OK';
                okBtn.style.cssText = `
                            padding: 12px 32px;
                            border: none;
                            border-radius: 10px;
                            font-size: 15px;
                            font-weight: 600;
                            cursor: pointer;
                            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                            color: white;
                            transition: all 0.2s;
                            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
                        `;
                okBtn.addEventListener('mouseover', () => {
                    okBtn.style.transform = 'translateY(-2px)';
                    okBtn.style.boxShadow = '0 6px 16px rgba(59, 130, 246, 0.4)';
                });
                okBtn.addEventListener('mouseout', () => {
                    okBtn.style.transform = 'translateY(0)';
                    okBtn.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.3)';
                });
                okBtn.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                    resolve(input.value || '');
                });
                // Enterã‚­ãƒ¼ã§ç¢ºå®š
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        okBtn.click();
                    }
                });
                buttonContainer.appendChild(cancelBtn);
                buttonContainer.appendChild(okBtn);
                dialog.appendChild(title);
                dialog.appendChild(subtitle);
                dialog.appendChild(example);
                dialog.appendChild(input);
                dialog.appendChild(buttonContainer);
                overlay.appendChild(dialog);
                document.body.appendChild(overlay);
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                setTimeout(() => input.focus(), 100);
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨CSS
                const style = document.createElement('style');
                style.textContent = `
                            @keyframes fadeIn {
                                from { opacity: 0; }
                                to { opacity: 1; }
                            }
                            @keyframes slideUp {
                                from {
                                    opacity: 0;
                                    transform: translateY(20px);
                                }
                                to {
                                    opacity: 1;
                                    transform: translateY(0);
                                }
                            }
                        `;
                document.head.appendChild(style);
            });
            if (memo === null)
                return; // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸå ´åˆ
            setCreating(true);
            console.log('æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é–‹å§‹');
            const { getDocs, setDoc, doc, Timestamp, query, orderBy, limit, collection } = window.firebaseModules;
            const now = new Date();
            const dateTimeStr = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(now.getSeconds()).padStart(2, '0')}`;
            const backupData = {
                timestamp: Timestamp.now(),
                date: dateTimeStr,
                type: 'manual',
                memo: memo || '',
                data: {}
            };
            // å•†å“ãƒ‡ãƒ¼ã‚¿
            let menusRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                menusRef = collection(window.db, 'stores', currentStoreId, 'menus');
            }
            else {
                menusRef = collection(window.db, 'menu');
            }
            const menusSnapshot = await getDocs(menusRef);
            backupData.data.menus = [];
            menusSnapshot.forEach(docSnap => {
                backupData.data.menus.push(Object.assign({ id: docSnap.id }, docSnap.data()));
            });
            // å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿
            let employeesRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                employeesRef = collection(window.db, 'stores', currentStoreId, 'employees');
            }
            else {
                employeesRef = collection(window.db, 'kintai_employees');
            }
            const employeesSnapshot = await getDocs(employeesRef);
            backupData.data.employees = [];
            employeesSnapshot.forEach(docSnap => {
                backupData.data.employees.push(Object.assign({ id: docSnap.id }, docSnap.data()));
            });
            // æ³¨æ–‡å±¥æ­´ï¼ˆæœ€è¿‘1000ä»¶ï¼‰
            let ordersRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                ordersRef = collection(window.db, 'stores', currentStoreId, 'orders');
            }
            else {
                ordersRef = collection(window.db, 'orders');
            }
            // ã‚·ãƒ³ãƒ—ãƒ«ã«å…¨ä»¶å–å¾—ï¼ˆæ‰‹å‹•ã§1000ä»¶ã«åˆ¶é™ï¼‰
            const ordersSnapshot = await getDocs(ordersRef);
            backupData.data.orders = [];
            let orderCount = 0;
            const ordersList = [];
            ordersSnapshot.forEach(docSnap => {
                const data = docSnap.data();
                ordersList.push(Object.assign(Object.assign({ id: docSnap.id }, data), { _timestamp: data.createdAt || data.timestamp || new Date(0) }));
            });
            // æ—¥ä»˜ã§ã‚½ãƒ¼ãƒˆï¼ˆæ–°ã—ã„é †ï¼‰
            ordersList.sort((a, b) => {
                var _a, _b;
                const timeA = ((_a = a._timestamp) === null || _a === void 0 ? void 0 : _a.toDate) ? a._timestamp.toDate() : new Date(a._timestamp);
                const timeB = ((_b = b._timestamp) === null || _b === void 0 ? void 0 : _b.toDate) ? b._timestamp.toDate() : new Date(b._timestamp);
                return timeB - timeA;
            });
            // æœ€æ–°1000ä»¶ã®ã¿ä¿å­˜
            backupData.data.orders = ordersList.slice(0, 1000).map(item => {
                const { _timestamp } = item, rest = __rest(item, ["_timestamp"]);
                return rest;
            });
            console.log('âœ… æ³¨æ–‡å±¥æ­´å–å¾—:', backupData.data.orders.length, 'ä»¶');
            // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€è¿‘1000ä»¶ï¼‰
            let attendanceRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                attendanceRef = collection(window.db, 'stores', currentStoreId, 'attendance');
            }
            else {
                attendanceRef = collection(window.db, 'kintai_attendance');
            }
            // ã‚·ãƒ³ãƒ—ãƒ«ã«å…¨ä»¶å–å¾—ï¼ˆæ‰‹å‹•ã§1000ä»¶ã«åˆ¶é™ï¼‰
            const attendanceSnapshot = await getDocs(attendanceRef);
            backupData.data.attendance = [];
            const attendanceList = [];
            attendanceSnapshot.forEach(docSnap => {
                const data = docSnap.data();
                attendanceList.push(Object.assign(Object.assign({ id: docSnap.id }, data), { _timestamp: data.createdAt || data.timestamp || new Date(0) }));
            });
            // æ—¥ä»˜ã§ã‚½ãƒ¼ãƒˆï¼ˆæ–°ã—ã„é †ï¼‰
            attendanceList.sort((a, b) => {
                var _a, _b;
                const timeA = ((_a = a._timestamp) === null || _a === void 0 ? void 0 : _a.toDate) ? a._timestamp.toDate() : new Date(a._timestamp);
                const timeB = ((_b = b._timestamp) === null || _b === void 0 ? void 0 : _b.toDate) ? b._timestamp.toDate() : new Date(b._timestamp);
                return timeB - timeA;
            });
            // æœ€æ–°1000ä»¶ã®ã¿ä¿å­˜
            backupData.data.attendance = attendanceList.slice(0, 1000).map(item => {
                const { _timestamp } = item, rest = __rest(item, ["_timestamp"]);
                return rest;
            });
            console.log('âœ… å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å–å¾—:', backupData.data.attendance.length, 'ä»¶');
            // ğŸ†• è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
            const { getDoc } = window.firebaseModules;
            // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š
            try {
                let receiptSettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    receiptSettingsRef = doc(window.db, 'stores', currentStoreId, 'receipt_settings', 'default');
                }
                else {
                    receiptSettingsRef = doc(window.db, 'receipt_settings', 'default');
                }
                const receiptDoc = await getDoc(receiptSettingsRef);
                backupData.data.receipt_settings = receiptDoc.exists() ? receiptDoc.data() : null;
                console.log('âœ… ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š:', backupData.data.receipt_settings ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.receipt_settings = null;
            }
            // å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®šï¼ˆmenu_settingsï¼‰ã¨ãƒˆãƒƒãƒ”ãƒ³ã‚°
            try {
                let menuSettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    menuSettingsRef = doc(window.db, 'stores', currentStoreId, 'menu_settings', 'default');
                }
                else {
                    menuSettingsRef = doc(window.db, 'menu_settings', 'default');
                }
                const menuSettingsDoc = await getDoc(menuSettingsRef);
                const menuSettingsData = menuSettingsDoc.exists() ? menuSettingsDoc.data() : null;
                // menu_settingsã«ãƒˆãƒƒãƒ”ãƒ³ã‚°æƒ…å ±ã‚’å«ã‚ã‚‹
                if (menuSettingsData) {
                    // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å–å¾—
                    let toppingsRef;
                    if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                        toppingsRef = collection(window.db, 'stores', currentStoreId, 'toppings');
                    }
                    else {
                        toppingsRef = collection(window.db, 'toppings');
                    }
                    try {
                        const toppingsSnapshot = await getDocs(toppingsRef);
                        const toppings = [];
                        toppingsSnapshot.forEach(docSnap => {
                            toppings.push(Object.assign({ id: docSnap.id }, docSnap.data()));
                        });
                        menuSettingsData.toppings = toppings;
                        console.log('âœ… ãƒˆãƒƒãƒ”ãƒ³ã‚°å–å¾—:', toppings.length, 'ä»¶');
                    }
                    catch (e) {
                        console.warn('ãƒˆãƒƒãƒ”ãƒ³ã‚°å–å¾—ã‚¨ãƒ©ãƒ¼:', e.message);
                        menuSettingsData.toppings = [];
                    }
                }
                backupData.data.menu_settings = menuSettingsData;
                console.log('âœ… å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®š:', backupData.data.menu_settings ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.menu_settings = null;
            }
            // åœ¨åº«è¨­å®š
            try {
                let inventorySettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    inventorySettingsRef = doc(window.db, 'stores', currentStoreId, 'inventory_settings', 'default');
                }
                else {
                    inventorySettingsRef = doc(window.db, 'inventory_settings', 'default');
                }
                const inventoryDoc = await getDoc(inventorySettingsRef);
                backupData.data.inventory_settings = inventoryDoc.exists() ? inventoryDoc.data() : null;
                console.log('âœ… åœ¨åº«è¨­å®š:', backupData.data.inventory_settings ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('åœ¨åº«è¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.inventory_settings = null;
            }
            // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
            try {
                let alertSettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    alertSettingsRef = doc(window.db, 'stores', currentStoreId, 'alert_settings', 'default');
                }
                else {
                    alertSettingsRef = doc(window.db, 'alert_settings', 'default');
                }
                const alertDoc = await getDoc(alertSettingsRef);
                backupData.data.alert_settings = alertDoc.exists() ? alertDoc.data() : null;
                console.log('âœ… ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š:', backupData.data.alert_settings ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.alert_settings = null;
            }
            // å–¶æ¥­æ™‚é–“è¨­å®š
            try {
                let businessHoursRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    businessHoursRef = doc(window.db, 'stores', currentStoreId, 'business_hours', 'default');
                }
                else {
                    businessHoursRef = doc(window.db, 'business_hours', 'default');
                }
                const businessDoc = await getDoc(businessHoursRef);
                backupData.data.business_hours = businessDoc.exists() ? businessDoc.data() : null;
                console.log('âœ… å–¶æ¥­æ™‚é–“è¨­å®š:', backupData.data.business_hours ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('å–¶æ¥­æ™‚é–“è¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.business_hours = null;
            }
            // ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š
            try {
                let tableSettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    tableSettingsRef = doc(window.db, 'stores', currentStoreId, 'table_settings', 'default');
                }
                else {
                    tableSettingsRef = doc(window.db, 'table_settings', 'default');
                }
                const tableDoc = await getDoc(tableSettingsRef);
                backupData.data.table_settings = tableDoc.exists() ? tableDoc.data() : null;
                console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š:', backupData.data.table_settings ? 'å–å¾—' : 'ãªã—');
            }
            catch (e) {
                console.warn('ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.table_settings = null;
            }
            // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆå„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰
            try {
                let tablesRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    tablesRef = collection(window.db, 'stores', currentStoreId, 'tables');
                }
                else {
                    tablesRef = collection(window.db, 'tables');
                }
                const tablesSnapshot = await getDocs(tablesRef);
                backupData.data.tables = [];
                tablesSnapshot.forEach(docSnap => {
                    backupData.data.tables.push(Object.assign({ id: docSnap.id }, docSnap.data()));
                });
                console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿å–å¾—:', backupData.data.tables.length, 'ä»¶');
            }
            catch (e) {
                console.warn('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—:', e.message);
                backupData.data.tables = [];
            }
            // ä¿å­˜
            const backupId = `manual_${dateTimeStr}`;
            let backupRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                backupRef = doc(window.db, 'stores', currentStoreId, 'backups', backupId);
            }
            else {
                backupRef = doc(window.db, 'backups', backupId);
            }
            await setDoc(backupRef, backupData);
            console.log('âœ… æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†:', backupId);
            const settingsCount = [
                backupData.data.menu_settings,
                backupData.data.receipt_settings,
                backupData.data.inventory_settings,
                backupData.data.alert_settings,
                backupData.data.business_hours,
                backupData.data.table_settings
            ].filter(s => s !== null).length;
            setCreating(false);
            const memoText = memo ? `\nãƒ¡ãƒ¢: ${memo}` : '';
            showCustomAlert(`ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆã—ã¾ã—ãŸ\n\nå•†å“: ${backupData.data.menus.length}ä»¶\nå¾“æ¥­å“¡: ${backupData.data.employees.length}å\næ³¨æ–‡: ${backupData.data.orders.length}ä»¶\nå‹¤æ€ : ${backupData.data.attendance.length}ä»¶\nãƒ†ãƒ¼ãƒ–ãƒ«: ${((_a = backupData.data.tables) === null || _a === void 0 ? void 0 : _a.length) || 0}ä»¶\nè¨­å®š: ${settingsCount}ç¨®é¡${memoText}`, 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†');
            // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
            await loadBackups();
        }
        catch (error) {
            console.error('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
            setCreating(false);
            showCustomAlert('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ\n\n' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
    const restoreBackup = async (backup) => {
        try {
            // ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            const memoInfo = backup.memo ? `\nãƒ¡ãƒ¢: ${backup.memo}` : '';
            const confirmResult = await showCustomConfirm(`ã“ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ\n\nä½œæˆæ—¥æ™‚: ${backup.timestamp.toLocaleString('ja-JP')}\nã‚¿ã‚¤ãƒ—: ${backup.type === 'auto' ? 'è‡ªå‹•' : 'æ‰‹å‹•'}${memoInfo}\n\nè­¦å‘Š: ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼`, 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©å…ƒ', 'å¾©å…ƒã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
            if (!confirmResult)
                return;
            setRestoring(true);
            console.log('ğŸ”„ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©å…ƒé–‹å§‹:', backup.id);
            const { setDoc, doc, Timestamp } = window.firebaseModules;
            const data = backup.data;
            // å•†å“ã‚’å¾©å…ƒ
            if (data.menus) {
                for (const menu of data.menus) {
                    const menuRef = window.getStoreDoc('menus', menu.id);
                    const menuData = Object.assign({}, menu);
                    delete menuData.id;
                    await setDoc(menuRef, menuData);
                }
                console.log(`âœ… å•†å“å¾©å…ƒ: ${data.menus.length}ä»¶`);
            }
            // å¾“æ¥­å“¡ã‚’å¾©å…ƒ
            if (data.employees) {
                for (const employee of data.employees) {
                    const empRef = window.getStoreDoc('employees', employee.id);
                    const empData = Object.assign({}, employee);
                    delete empData.id;
                    await setDoc(empRef, empData);
                }
                console.log(`âœ… å¾“æ¥­å“¡å¾©å…ƒ: ${data.employees.length}å`);
            }
            // æ³¨æ–‡å±¥æ­´ã‚’å¾©å…ƒ
            if (data.orders) {
                for (const order of data.orders) {
                    const orderRef = window.getStoreDoc('orders', order.id);
                    const orderData = Object.assign({}, order);
                    delete orderData.id;
                    await setDoc(orderRef, orderData);
                }
                console.log(`âœ… æ³¨æ–‡å¾©å…ƒ: ${data.orders.length}ä»¶`);
            }
            // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
            if (data.attendance) {
                for (const att of data.attendance) {
                    const attRef = window.getStoreDoc('attendance', att.id);
                    const attData = Object.assign({}, att);
                    delete attData.id;
                    await setDoc(attRef, attData);
                }
                console.log(`âœ… å‹¤æ€ å¾©å…ƒ: ${data.attendance.length}ä»¶`);
            }
            // ğŸ†• è¨­å®šã‚’å¾©å…ƒ
            let settingsRestoredCount = 0;
            // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š
            if (data.receipt_settings) {
                let receiptRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    receiptRef = doc(window.db, 'stores', currentStoreId, 'receipt_settings', 'default');
                }
                else {
                    receiptRef = doc(window.db, 'receipt_settings', 'default');
                }
                await setDoc(receiptRef, data.receipt_settings);
                settingsRestoredCount++;
                console.log('âœ… ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®šå¾©å…ƒ');
            }
            // å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®šã¨ãƒˆãƒƒãƒ”ãƒ³ã‚°
            if (data.menu_settings) {
                let menuSettingsRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    menuSettingsRef = doc(window.db, 'stores', currentStoreId, 'menu_settings', 'default');
                }
                else {
                    menuSettingsRef = doc(window.db, 'menu_settings', 'default');
                }
                // ãƒˆãƒƒãƒ”ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é›¢
                const menuSettingsData = Object.assign({}, data.menu_settings);
                const toppings = menuSettingsData.toppings || [];
                delete menuSettingsData.toppings;
                // menu_settingsã‚’å¾©å…ƒ
                await setDoc(menuSettingsRef, menuSettingsData);
                // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚’å¾©å…ƒ
                if (toppings.length > 0) {
                    for (const topping of toppings) {
                        let toppingRef;
                        if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                            toppingRef = doc(window.db, 'stores', currentStoreId, 'toppings', topping.id);
                        }
                        else {
                            toppingRef = doc(window.db, 'toppings', topping.id);
                        }
                        const toppingData = Object.assign({}, topping);
                        delete toppingData.id;
                        await setDoc(toppingRef, toppingData);
                    }
                    console.log(`âœ… ãƒˆãƒƒãƒ”ãƒ³ã‚°å¾©å…ƒ: ${toppings.length}ä»¶`);
                }
                settingsRestoredCount++;
                console.log('âœ… å•†å“ã‚«ãƒ†ã‚´ãƒªè¨­å®šå¾©å…ƒ');
            }
            // åœ¨åº«è¨­å®š
            if (data.inventory_settings) {
                let inventoryRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    inventoryRef = doc(window.db, 'stores', currentStoreId, 'inventory_settings', 'default');
                }
                else {
                    inventoryRef = doc(window.db, 'inventory_settings', 'default');
                }
                await setDoc(inventoryRef, data.inventory_settings);
                settingsRestoredCount++;
                console.log('âœ… åœ¨åº«è¨­å®šå¾©å…ƒ');
            }
            // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
            if (data.alert_settings) {
                let alertRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    alertRef = doc(window.db, 'stores', currentStoreId, 'alert_settings', 'default');
                }
                else {
                    alertRef = doc(window.db, 'alert_settings', 'default');
                }
                await setDoc(alertRef, data.alert_settings);
                settingsRestoredCount++;
                console.log('âœ… ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šå¾©å…ƒ');
            }
            // å–¶æ¥­æ™‚é–“è¨­å®š
            if (data.business_hours) {
                let businessRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    businessRef = doc(window.db, 'stores', currentStoreId, 'business_hours', 'default');
                }
                else {
                    businessRef = doc(window.db, 'business_hours', 'default');
                }
                await setDoc(businessRef, data.business_hours);
                settingsRestoredCount++;
                console.log('âœ… å–¶æ¥­æ™‚é–“è¨­å®šå¾©å…ƒ');
            }
            // ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š
            if (data.table_settings) {
                let tableRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    tableRef = doc(window.db, 'stores', currentStoreId, 'table_settings', 'default');
                }
                else {
                    tableRef = doc(window.db, 'table_settings', 'default');
                }
                await setDoc(tableRef, data.table_settings);
                settingsRestoredCount++;
                console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šå¾©å…ƒ');
            }
            // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
            if (data.tables) {
                for (const table of data.tables) {
                    const tableRef = window.getStoreDoc('tables', table.id);
                    const tableData = Object.assign({}, table);
                    delete tableData.id;
                    await setDoc(tableRef, tableData);
                }
                console.log(`âœ… ãƒ†ãƒ¼ãƒ–ãƒ«å¾©å…ƒ: ${data.tables.length}ä»¶`);
            }
            console.log(`âœ… è¨­å®šå¾©å…ƒ: ${settingsRestoredCount}ç¨®é¡`);
            setRestoring(false);
            showCustomAlert('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒãŒå®Œäº†ã—ã¾ã—ãŸ\n\nãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚', 'å¾©å…ƒå®Œäº†');
            // ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
            setTimeout(() => {
                window.location.reload();
            }, 2000);
        }
        catch (error) {
            console.error('å¾©å…ƒã‚¨ãƒ©ãƒ¼:', error);
            setRestoring(false);
            showCustomAlert('å¾©å…ƒã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤
    const deleteBackup = async (backupId) => {
        try {
            // ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            const confirmResult = await showCustomConfirm('ã“ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nå‰Šé™¤ã—ãŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯å¾©å…ƒã§ãã¾ã›ã‚“ã€‚', 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å‰Šé™¤', 'å‰Šé™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
            if (!confirmResult)
                return;
            const { deleteDoc, doc } = window.firebaseModules;
            let backupRef;
            if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                backupRef = doc(window.db, 'stores', currentStoreId, 'backups', backupId);
            }
            else {
                backupRef = doc(window.db, 'backups', backupId);
            }
            await deleteDoc(backupRef);
            showCustomAlert('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'å‰Šé™¤å®Œäº†', 'âœ…');
            await loadBackups();
        }
        catch (error) {
            console.error('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\n\n' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'âŒ');
        }
    };
    return (React.createElement("div", { className: "space-y-6" },
        React.createElement("div", { className: "bg-blue-50 border-2 border-blue-300 rounded-lg p-4" },
            React.createElement("h3", { className: "text-lg font-bold text-blue-700 mb-2" }, "\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u306B\u3064\u3044\u3066"),
            React.createElement("ul", { className: "text-sm text-blue-600 space-y-1 list-disc list-inside" },
                React.createElement("li", null,
                    React.createElement("strong", null, "\u81EA\u52D5\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7:"),
                    " \u7CBE\u7B97\u6642\u306B\u4F5C\u6210\u3055\u308C\u30017\u65E5\u5206\u304C\u30ED\u30FC\u30C6\u30FC\u30B7\u30E7\u30F3\u3067\u4FDD\u6301\u3055\u308C\u307E\u3059"),
                React.createElement("li", null,
                    React.createElement("strong", null, "\u624B\u52D5\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7:"),
                    " \u3044\u3064\u3067\u3082\u4F5C\u6210\u3067\u304D\u3001\u624B\u52D5\u3067\u524A\u9664\u3059\u308B\u307E\u3067\u4FDD\u6301\u3055\u308C\u307E\u3059"),
                React.createElement("li", null,
                    React.createElement("strong", null, "\u30E1\u30E2\u6A5F\u80FD:"),
                    " \u624B\u52D5\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u4F5C\u6210\u6642\u306B\u30E1\u30E2\u3092\u8FFD\u52A0\u3067\u304D\u307E\u3059\uFF08\u4F8B: \u4FA1\u683C\u6539\u5B9A\u524D\u30013\u67081\u65E5\u304B\u3089\u306E\u4FA1\u683C\u306A\u3069\uFF09"),
                React.createElement("li", null, "\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u306B\u306F\u5546\u54C1\u3001\u5F93\u696D\u54E1\u3001\u6CE8\u6587\u5C65\u6B74\uFF08\u6700\u8FD11000\u4EF6\uFF09\u3001\u52E4\u6020\u30C7\u30FC\u30BF\uFF08\u6700\u8FD11000\u4EF6\uFF09\u3001\u30C6\u30FC\u30D6\u30EB\u3001\u5404\u7A2E\u8A2D\u5B9A\uFF08\u30AB\u30C6\u30B4\u30EA\u30FB\u30EC\u30B7\u30FC\u30C8\u30FB\u5728\u5EAB\u30FB\u30A2\u30E9\u30FC\u30C8\u30FB\u55B6\u696D\u6642\u9593\u30FB\u30C6\u30FC\u30D6\u30EB\uFF09\u304C\u542B\u307E\u308C\u307E\u3059"))),
        React.createElement("div", { className: "bg-gradient-to-r from-blue-500 to-blue-700 rounded-lg shadow-lg p-6 text-white" },
            React.createElement("h3", { className: "text-xl font-bold mb-3" }, "\u4ECA\u3059\u3050\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7"),
            React.createElement("p", { className: "text-sm mb-4 opacity-90" }, "\u73FE\u5728\u306E\u30C7\u30FC\u30BF\u3092\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u3057\u307E\u3059\u3002\u5927\u304D\u306A\u5909\u66F4\u3092\u884C\u3046\u524D\u306B\u63A8\u5968\u3057\u307E\u3059\u3002"),
            React.createElement("button", { onClick: createManualBackup, disabled: creating || restoring, className: "w-full px-6 py-3 bg-white text-blue-700 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100" }, creating ? 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆä¸­...' : 'æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ')),
        React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6" },
            React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u4E00\u89A7"),
            loading ? (React.createElement("div", { className: "text-center py-8" },
                React.createElement("p", { className: "text-gray-600" }, "\u8AAD\u307F\u8FBC\u307F\u4E2D..."))) : backups.length === 0 ? (React.createElement("div", { className: "text-center py-8" },
                React.createElement("p", { className: "text-gray-500" }, "\u30D0\u30C3\u30AF\u30A2\u30C3\u30D7\u304C\u3042\u308A\u307E\u305B\u3093"))) : (React.createElement("div", { className: "space-y-3" }, backups.map(backup => {
                var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;
                return (React.createElement("div", { key: backup.id, className: "border rounded-lg p-4 hover:bg-gray-50" },
                    React.createElement("div", { className: "flex justify-between items-start mb-2" },
                        React.createElement("div", null,
                            React.createElement("div", { className: "flex items-center gap-2 mb-1" },
                                React.createElement("span", { className: `px-2 py-1 rounded text-xs font-bold ${backup.type === 'auto'
                                        ? 'bg-green-100 text-green-700'
                                        : 'bg-blue-100 text-blue-700'}` }, backup.type === 'auto' ? 'è‡ªå‹•' : 'æ‰‹å‹•'),
                                React.createElement("span", { className: "text-sm font-semibold text-gray-700" }, backup.timestamp.toLocaleString('ja-JP'))),
                            backup.memo && (React.createElement("div", { className: "text-sm text-blue-600 font-medium mb-1" },
                                "\u30E1\u30E2: ",
                                backup.memo)),
                            React.createElement("div", { className: "text-xs text-gray-500 space-x-3" },
                                React.createElement("span", null,
                                    "\u5546\u54C1: ",
                                    ((_b = (_a = backup.data) === null || _a === void 0 ? void 0 : _a.menus) === null || _b === void 0 ? void 0 : _b.length) || 0,
                                    "\u4EF6"),
                                React.createElement("span", null,
                                    "\u5F93\u696D\u54E1: ",
                                    ((_d = (_c = backup.data) === null || _c === void 0 ? void 0 : _c.employees) === null || _d === void 0 ? void 0 : _d.length) || 0,
                                    "\u540D"),
                                React.createElement("span", null,
                                    "\u6CE8\u6587: ",
                                    ((_f = (_e = backup.data) === null || _e === void 0 ? void 0 : _e.orders) === null || _f === void 0 ? void 0 : _f.length) || 0,
                                    "\u4EF6"),
                                React.createElement("span", null,
                                    "\u52E4\u6020: ",
                                    ((_h = (_g = backup.data) === null || _g === void 0 ? void 0 : _g.attendance) === null || _h === void 0 ? void 0 : _h.length) || 0,
                                    "\u4EF6"),
                                React.createElement("span", null,
                                    "\u30C6\u30FC\u30D6\u30EB: ",
                                    ((_k = (_j = backup.data) === null || _j === void 0 ? void 0 : _j.tables) === null || _k === void 0 ? void 0 : _k.length) || 0,
                                    "\u4EF6"))),
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("button", { onClick: () => restoreBackup(backup), disabled: restoring || creating, className: "px-3 py-1 bg-green-500 text-white text-sm rounded hover:bg-green-600 disabled:bg-gray-300" }, restoring ? 'å¾©å…ƒä¸­...' : 'å¾©å…ƒ'),
                            backup.type === 'manual' && (React.createElement("button", { onClick: () => deleteBackup(backup.id), disabled: restoring || creating, className: "px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 disabled:bg-gray-300" }, "\u524A\u9664"))))));
            }))))));
};
// ========== å‰Šé™¤è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ==========
const DeleteSettings = ({ currentStoreId, showCustomConfirm, showCustomAlert }) => {
    const [products, setProducts] = useState([]);
    const [categories, setCategories] = useState([]);
    const [employees, setEmployees] = useState([]);
    const [tables, setTables] = useState([]);
    const [selectedProducts, setSelectedProducts] = useState([]);
    const [selectedCategories, setSelectedCategories] = useState([]);
    const [selectedEmployees, setSelectedEmployees] = useState([]);
    const [selectedTables, setSelectedTables] = useState([]);
    const [loading, setLoading] = useState(true);
    // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
    useEffect(() => {
        loadData();
    }, [currentStoreId]);
    const loadData = async () => {
        setLoading(true);
        try {
            console.log('=== å‰Šé™¤è¨­å®š: ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹ ===');
            console.log('ç¾åœ¨ã®åº—èˆ—ID (props):', currentStoreId);
            console.log('window.currentStoreId:', window.currentStoreId);
            const { getDocs, collection } = window.firebaseModules;
            // å•†å“ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆmenusã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ï¼‰
            console.log('å•†å“ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹...');
            const menusCollection = window.getStoreCollection('menus');
            const menusSnapshot = await getDocs(menusCollection);
            console.log('å•†å“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°:', menusSnapshot.docs.length);
            const allProducts = [];
            const allCategories = new Set();
            menusSnapshot.docs.forEach((doc, index) => {
                console.log(`--- å•†å“ ${index + 1} ---`);
                console.log('ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID:', doc.id);
                const data = doc.data();
                console.log('ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ¼:', Object.keys(data));
                console.log('name:', data.name, 'category:', data.category, 'price:', data.price);
                // éè¡¨ç¤ºå•†å“ã¯ã‚¹ã‚­ãƒƒãƒ—
                if (data.hidden) {
                    console.log('  â†’ éè¡¨ç¤ºå•†å“ã®ãŸã‚ã‚¹ã‚­ãƒƒãƒ—');
                    return;
                }
                if (data.name) {
                    const category = data.category || 'æœªåˆ†é¡';
                    allCategories.add(category);
                    allProducts.push({
                        id: doc.id,
                        docId: doc.id,
                        category: category,
                        name: data.name,
                        price: data.price || 0
                    });
                    console.log(`  â†’ è¿½åŠ : ${category} - ${data.name} (Â¥${data.price || 0})`);
                }
            });
            console.log('=== å•†å“ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº† ===');
            console.log('ç·å•†å“æ•°:', allProducts.length);
            console.log('ç·ã‚«ãƒ†ã‚´ãƒªæ•°:', allCategories.size);
            console.log('ã‚«ãƒ†ã‚´ãƒªä¸€è¦§:', Array.from(allCategories));
            setProducts(allProducts);
            setCategories(Array.from(allCategories));
            // å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
            console.log('=== å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹ ===');
            const employeesCollection = window.getStoreCollection('employees');
            const employeesSnapshot = await getDocs(employeesCollection);
            console.log('å¾“æ¥­å“¡ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°:', employeesSnapshot.docs.length);
            const employeesData = employeesSnapshot.docs.map(doc => {
                const data = doc.data();
                console.log('å¾“æ¥­å“¡:', data.name, 'æ™‚çµ¦:', data.rate);
                return Object.assign({ id: doc.id }, data);
            });
            console.log('=== å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº† ===');
            console.log('ç·å¾“æ¥­å“¡æ•°:', employeesData.length);
            setEmployees(employeesData);
            // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
            console.log('=== ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹ ===');
            console.log('window.currentStoreId:', window.currentStoreId);
            console.log('props.currentStoreId:', currentStoreId);
            const tablesCollection = window.getStoreCollection('tables');
            const tablesSnapshot = await getDocs(tablesCollection);
            console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°:', tablesSnapshot.docs.length);
            let tablesData = [];
            tablesSnapshot.forEach(doc => {
                const data = doc.data();
                console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID:', doc.id, 'name:', data.name);
                tablesData.push({
                    id: doc.id,
                    name: data.name || doc.id
                });
            });
            console.log('ãƒ†ãƒ¼ãƒ–ãƒ«æ•°:', tablesData.length);
            console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒªã‚¹ãƒˆ:', tablesData.map(t => t.name).join(', '));
            setTables(tablesData);
            console.log('=== ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº† ===');
        }
        catch (error) {
            console.error('âŒ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            console.error('ã‚¨ãƒ©ãƒ¼è©³ç´°:', error.message);
            console.error('ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:', error.stack);
            showCustomAlert('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
        setLoading(false);
    };
    // å•†å“å‰Šé™¤
    const deleteProducts = async () => {
        if (selectedProducts.length === 0) {
            showCustomAlert('å‰Šé™¤ã™ã‚‹å•†å“ã‚’é¸æŠã—ã¦ãã ã•ã„', 'è­¦å‘Š');
            return;
        }
        const confirmed = await showCustomConfirm(`é¸æŠã—ãŸ${selectedProducts.length}ä»¶ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“`, 'å•†å“å‰Šé™¤', 'å‰Šé™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { deleteDoc, doc } = window.firebaseModules;
            // å„å•†å“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤
            for (const productId of selectedProducts) {
                const product = products.find(p => p.id === productId);
                if (!product)
                    continue;
                let productRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    productRef = doc(window.db, 'stores', currentStoreId, 'menus', product.docId);
                }
                else {
                    productRef = doc(window.db, 'menus', product.docId);
                }
                await deleteDoc(productRef);
                console.log(`å‰Šé™¤: ${product.name} (${product.docId})`);
            }
            showCustomAlert(`${selectedProducts.length}ä»¶ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'å‰Šé™¤å®Œäº†');
            setSelectedProducts([]);
            loadData();
        }
        catch (error) {
            console.error('å•†å“å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlert('å•†å“ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤
    const deleteCategories = async () => {
        if (selectedCategories.length === 0) {
            showCustomAlert('å‰Šé™¤ã™ã‚‹ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„', 'è­¦å‘Š');
            return;
        }
        const confirmed = await showCustomConfirm(`é¸æŠã—ãŸ${selectedCategories.length}ä»¶ã®ã‚«ãƒ†ã‚´ãƒªã¨ãã®ä¸­ã®å…¨å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“`, 'ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤', 'å‰Šé™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { deleteDoc, doc } = window.firebaseModules;
            // é¸æŠã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã«å±ã™ã‚‹å•†å“ã‚’å…¨ã¦å‰Šé™¤
            const productsToDelete = products.filter(p => selectedCategories.includes(p.category));
            console.log(`å‰Šé™¤ã™ã‚‹ã‚«ãƒ†ã‚´ãƒª: ${selectedCategories.join(', ')}`);
            console.log(`å‰Šé™¤ã™ã‚‹å•†å“æ•°: ${productsToDelete.length}`);
            for (const product of productsToDelete) {
                let productRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    productRef = doc(window.db, 'stores', currentStoreId, 'menus', product.docId);
                }
                else {
                    productRef = doc(window.db, 'menus', product.docId);
                }
                await deleteDoc(productRef);
                console.log(`å‰Šé™¤: ${product.category} - ${product.name}`);
            }
            showCustomAlert(`${selectedCategories.length}ä»¶ã®ã‚«ãƒ†ã‚´ãƒªã¨${productsToDelete.length}ä»¶ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'å‰Šé™¤å®Œäº†');
            setSelectedCategories([]);
            loadData();
        }
        catch (error) {
            console.error('ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlert('ã‚«ãƒ†ã‚´ãƒªã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // å¾“æ¥­å“¡å‰Šé™¤
    const deleteEmployees = async () => {
        if (selectedEmployees.length === 0) {
            showCustomAlert('å‰Šé™¤ã™ã‚‹å¾“æ¥­å“¡ã‚’é¸æŠã—ã¦ãã ã•ã„', 'è­¦å‘Š');
            return;
        }
        const employeeNames = selectedEmployees.map(id => {
            const emp = employees.find(e => e.id === id);
            return emp ? emp.name : '';
        }).filter(Boolean).join(', ');
        const confirmed = await showCustomConfirm(`ä»¥ä¸‹ã®å¾“æ¥­å“¡ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n${employeeNames}\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“\nå‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚‚å…¨ã¦å‰Šé™¤ã•ã‚Œã¾ã™`, 'å¾“æ¥­å“¡å‰Šé™¤', 'å‰Šé™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { deleteDoc, getDocs, query, where, doc, collection } = window.firebaseModules;
            for (const employeeId of selectedEmployees) {
                // å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
                let employeeRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    employeeRef = doc(window.db, 'stores', currentStoreId, 'employees', employeeId);
                }
                else {
                    employeeRef = doc(window.db, 'kintai_employees', employeeId);
                }
                await deleteDoc(employeeRef);
                // å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
                let attendanceCollection;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    attendanceCollection = collection(window.db, 'stores', currentStoreId, 'attendance');
                }
                else {
                    attendanceCollection = collection(window.db, 'kintai_attendance');
                }
                const q = query(attendanceCollection, where('employeeId', '==', employeeId));
                const attendanceSnapshot = await getDocs(q);
                for (const docSnap of attendanceSnapshot.docs) {
                    await deleteDoc(docSnap.ref);
                }
            }
            showCustomAlert(`${selectedEmployees.length}åã®å¾“æ¥­å“¡ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'å‰Šé™¤å®Œäº†');
            setSelectedEmployees([]);
            loadData();
        }
        catch (error) {
            console.error('å¾“æ¥­å“¡å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlert('å¾“æ¥­å“¡ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ', 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤
    const deleteTables = async () => {
        if (selectedTables.length === 0) {
            showCustomAlert('å‰Šé™¤ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'è­¦å‘Š');
            return;
        }
        const tableNames = selectedTables.map(id => {
            const table = tables.find(t => t.id === id);
            return table ? table.name : '';
        }).filter(Boolean).join(', ');
        const confirmed = await showCustomConfirm(`ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n${tableNames}\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“`, 'ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤', 'å‰Šé™¤ã™ã‚‹', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«');
        if (!confirmed)
            return;
        try {
            const { deleteDoc, doc } = window.firebaseModules;
            // å„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤
            for (const tableId of selectedTables) {
                let tableRef;
                if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                    tableRef = doc(window.db, 'stores', currentStoreId, 'tables', tableId);
                }
                else {
                    tableRef = doc(window.db, 'tables', tableId);
                }
                await deleteDoc(tableRef);
                console.log(`å‰Šé™¤: ${tableId}`);
            }
            showCustomAlert(`${selectedTables.length}å€‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'å‰Šé™¤å®Œäº†');
            setSelectedTables([]);
            loadData();
        }
        catch (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlert('ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ', 'ã‚¨ãƒ©ãƒ¼');
        }
    };
    // å…¨å‰Šé™¤ï¼ˆåˆæœŸåŒ–ï¼‰
    const deleteAll = async () => {
        const confirmText = prompt('å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\n\n' +
            'ä»¥ä¸‹ã®å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã¾ã™:\n' +
            `- å•†å“: ${products.length}ä»¶\n` +
            `- å¾“æ¥­å“¡: ${employees.length}å\n` +
            '- å…¨ã¦ã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿\n' +
            '- å…¨ã¦ã®æ³¨æ–‡å±¥æ­´\n' +
            '- å…¨ã¦ã®ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š\n\n' +
            'ç¶šè¡Œã™ã‚‹å ´åˆã¯ã€Œå‰Šé™¤ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„');
        if (confirmText !== 'å‰Šé™¤') {
            if (confirmText !== null) {
                showCustomAlertFunc('ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ', 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«', '!');
            }
            return;
        }
        const finalConfirm = confirm('æœ¬å½“ã«å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯çµ¶å¯¾ã«å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ï¼');
        if (!finalConfirm)
            return;
        try {
            const { deleteDoc, getDocs, collection, doc } = window.firebaseModules;
            let deletedCount = 0;
            // ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§
            const collectionsToDelete = [
                'menus', // å•†å“
                'employees', // å¾“æ¥­å“¡ï¼ˆæ–°ãƒ‘ã‚¹ï¼‰
                'kintai_employees', // å¾“æ¥­å“¡ï¼ˆæ—§ãƒ‘ã‚¹ï¼‰
                'attendance', // å‹¤æ€ ï¼ˆæ–°ãƒ‘ã‚¹ï¼‰
                'kintai_attendance', // å‹¤æ€ ï¼ˆæ—§ãƒ‘ã‚¹ï¼‰
                'orders', // æ³¨æ–‡
                'receipt_settings', // ãƒ¬ã‚·ãƒ¼ãƒˆè¨­å®š
                'alert_settings', // ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
                'menu_settings', // ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®š
                'tables', // ãƒ†ãƒ¼ãƒ–ãƒ«
                'tableSettings' // ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š
            ];
            for (const collectionName of collectionsToDelete) {
                try {
                    let collectionRef;
                    if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                        collectionRef = collection(window.db, 'stores', currentStoreId, collectionName);
                    }
                    else {
                        collectionRef = collection(window.db, collectionName);
                    }
                    const snapshot = await getDocs(collectionRef);
                    console.log(`${collectionName}: ${snapshot.docs.length}ä»¶`);
                    for (const docSnap of snapshot.docs) {
                        await deleteDoc(docSnap.ref);
                        deletedCount++;
                    }
                }
                catch (error) {
                    console.warn(`${collectionName}ã®å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ï¼ˆå­˜åœ¨ã—ãªã„å¯èƒ½æ€§ï¼‰:`, error.message);
                }
            }
            showCustomAlertFunc(`å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\nå‰Šé™¤ä»¶æ•°: ${deletedCount}ä»¶\n\nãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„`, 'åˆæœŸåŒ–å®Œäº†', 'OK');
            // ãƒ‡ãƒ¼ã‚¿ã‚’å†èª­ã¿è¾¼ã¿
            setTimeout(() => {
                loadData();
            }, 2000);
        }
        catch (error) {
            console.error('å…¨å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            showCustomAlertFunc('å…¨å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'ã‚¨ãƒ©ãƒ¼', 'X');
        }
    };
    // 7å¹´ä»¥ä¸Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å‰Šé™¤
    const deleteOldData = async () => {
        try {
            const { deleteDoc, getDocs, collection, Timestamp } = window.firebaseModules;
            // 7å¹´å‰ã®æ—¥æ™‚ã‚’è¨ˆç®—
            const sevenYearsAgo = new Date();
            sevenYearsAgo.setFullYear(sevenYearsAgo.getFullYear() - 7);
            const cutoffTimestamp = Timestamp.fromDate(sevenYearsAgo);
            console.log('=== 7å¹´ä»¥ä¸Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•å‰Šé™¤é–‹å§‹ ===');
            console.log('åŸºæº–æ—¥:', sevenYearsAgo.toLocaleDateString('ja-JP'));
            let deletedCount = 0;
            // å‰Šé™¤å¯¾è±¡ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆcreatedAtãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹ã‚‚ã®ï¼‰
            const collectionsToCheck = [
                { name: 'orders', field: 'createdAt' }, // æ³¨æ–‡
                { name: 'attendance', field: 'createdAt' }, // å‹¤æ€ ï¼ˆæ–°ãƒ‘ã‚¹ï¼‰
                { name: 'kintai_attendance', field: 'createdAt' } // å‹¤æ€ ï¼ˆæ—§ãƒ‘ã‚¹ï¼‰
            ];
            for (const { name: collectionName, field } of collectionsToCheck) {
                try {
                    let collectionRef;
                    if (currentStoreId && currentStoreId !== '' && currentStoreId !== null) {
                        collectionRef = collection(window.db, 'stores', currentStoreId, collectionName);
                    }
                    else {
                        collectionRef = collection(window.db, collectionName);
                    }
                    const snapshot = await getDocs(collectionRef);
                    for (const docSnap of snapshot.docs) {
                        const data = docSnap.data();
                        // createdAtãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹å ´åˆã®ã¿ãƒã‚§ãƒƒã‚¯
                        if (data[field]) {
                            const docDate = data[field].toDate();
                            // 7å¹´ä»¥ä¸Šå‰ã®ãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤
                            if (docDate < sevenYearsAgo) {
                                await deleteDoc(docSnap.ref);
                                deletedCount++;
                                console.log(`å‰Šé™¤: ${collectionName}/${docSnap.id} (${docDate.toLocaleDateString('ja-JP')})`);
                            }
                        }
                    }
                }
                catch (error) {
                    console.warn(`${collectionName}ã®ç¢ºèªã§ã‚¨ãƒ©ãƒ¼:`, error.message);
                }
            }
            console.log('=== 7å¹´ä»¥ä¸Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤å®Œäº† ===');
            console.log('å‰Šé™¤ä»¶æ•°:', deletedCount);
            if (deletedCount > 0) {
                showCustomAlertFunc(`7å¹´ä»¥ä¸Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’${deletedCount}ä»¶å‰Šé™¤ã—ã¾ã—ãŸ`, 'è‡ªå‹•å‰Šé™¤å®Œäº†', 'OK');
            }
            return deletedCount;
        }
        catch (error) {
            console.error('å¤ã„ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            return 0;
        }
    };
    // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆæ™‚ã«å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
    useEffect(() => {
        if (!loading) {
            // åˆå›èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
            deleteOldData();
        }
    }, [loading]);
    return (React.createElement("div", { className: "space-y-6" },
        loading && (React.createElement("div", { className: "text-center py-8" },
            React.createElement("p", { className: "text-gray-600" }, "\u30C7\u30FC\u30BF\u8AAD\u307F\u8FBC\u307F\u4E2D..."))),
        !loading && (React.createElement(React.Fragment, null,
            React.createElement("div", { className: "bg-red-50 border-2 border-red-300 rounded-lg p-4" },
                React.createElement("h2", { className: "text-xl font-bold text-red-700 mb-2" }, "\u91CD\u8981\u306A\u6CE8\u610F\u4E8B\u9805"),
                React.createElement("p", { className: "text-red-600" }, "\u524A\u9664\u3057\u305F\u30C7\u30FC\u30BF\u306F\u5143\u306B\u623B\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u305B\u3093\u3002\u614E\u91CD\u306B\u64CD\u4F5C\u3057\u3066\u304F\u3060\u3055\u3044\u3002")),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6" },
                React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u5546\u54C1\u524A\u9664"),
                React.createElement("div", { className: "max-h-96 overflow-y-auto border rounded p-4 mb-4" }, products.length === 0 ? (React.createElement("p", { className: "text-gray-500" }, "\u5546\u54C1\u304C\u3042\u308A\u307E\u305B\u3093")) : (React.createElement("div", { className: "space-y-2" }, products.map(product => (React.createElement("label", { key: product.id, className: "flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: selectedProducts.includes(product.id), onChange: (e) => {
                            if (e.target.checked) {
                                setSelectedProducts([...selectedProducts, product.id]);
                            }
                            else {
                                setSelectedProducts(selectedProducts.filter(id => id !== product.id));
                            }
                        }, className: "w-4 h-4" }),
                    React.createElement("span", { className: "text-sm" },
                        React.createElement("span", { className: "font-semibold" }, product.category),
                        " - ",
                        product.name,
                        " (\u00A5",
                        product.price,
                        ")"))))))),
                React.createElement("div", { className: "flex gap-3" },
                    React.createElement("button", { onClick: () => setSelectedProducts(products.map(p => p.id)), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u5168\u9078\u629E"),
                    React.createElement("button", { onClick: () => setSelectedProducts([]), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u9078\u629E\u89E3\u9664"),
                    React.createElement("button", { onClick: deleteProducts, disabled: selectedProducts.length === 0, className: "px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed ml-auto" },
                        "\u9078\u629E\u3057\u305F\u5546\u54C1\u3092\u524A\u9664 (",
                        selectedProducts.length,
                        "\u4EF6)"))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6" },
                React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u5546\u54C1\u30AB\u30C6\u30B4\u30EA\u524A\u9664"),
                React.createElement("div", { className: "max-h-96 overflow-y-auto border rounded p-4 mb-4" }, categories.length === 0 ? (React.createElement("p", { className: "text-gray-500" }, "\u30AB\u30C6\u30B4\u30EA\u304C\u3042\u308A\u307E\u305B\u3093")) : (React.createElement("div", { className: "space-y-2" }, categories.map(category => (React.createElement("label", { key: category, className: "flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: selectedCategories.includes(category), onChange: (e) => {
                            if (e.target.checked) {
                                setSelectedCategories([...selectedCategories, category]);
                            }
                            else {
                                setSelectedCategories(selectedCategories.filter(c => c !== category));
                            }
                        }, className: "w-4 h-4" }),
                    React.createElement("span", { className: "font-semibold" }, category),
                    React.createElement("span", { className: "text-sm text-gray-500" },
                        "(",
                        products.filter(p => p.category === category).length,
                        "\u4EF6\u306E\u5546\u54C1)"))))))),
                React.createElement("div", { className: "flex gap-3" },
                    React.createElement("button", { onClick: () => setSelectedCategories([...categories]), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u5168\u9078\u629E"),
                    React.createElement("button", { onClick: () => setSelectedCategories([]), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u9078\u629E\u89E3\u9664"),
                    React.createElement("button", { onClick: deleteCategories, disabled: selectedCategories.length === 0, className: "px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed ml-auto" },
                        "\u9078\u629E\u3057\u305F\u30AB\u30C6\u30B4\u30EA\u3092\u524A\u9664 (",
                        selectedCategories.length,
                        "\u4EF6)"))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6" },
                React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u5F93\u696D\u54E1\u524A\u9664"),
                React.createElement("div", { className: "max-h-96 overflow-y-auto border rounded p-4 mb-4" }, employees.length === 0 ? (React.createElement("p", { className: "text-gray-500" }, "\u5F93\u696D\u54E1\u304C\u3044\u307E\u305B\u3093")) : (React.createElement("div", { className: "space-y-2" }, employees.map(employee => (React.createElement("label", { key: employee.id, className: "flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: selectedEmployees.includes(employee.id), onChange: (e) => {
                            if (e.target.checked) {
                                setSelectedEmployees([...selectedEmployees, employee.id]);
                            }
                            else {
                                setSelectedEmployees(selectedEmployees.filter(id => id !== employee.id));
                            }
                        }, className: "w-4 h-4" }),
                    React.createElement("span", { className: "font-semibold" }, employee.name),
                    React.createElement("span", { className: "text-sm text-gray-500" },
                        "(\u6642\u7D66: \u00A5",
                        employee.rate,
                        ")"))))))),
                React.createElement("div", { className: "flex gap-3" },
                    React.createElement("button", { onClick: () => setSelectedEmployees(employees.map(e => e.id)), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u5168\u9078\u629E"),
                    React.createElement("button", { onClick: () => setSelectedEmployees([]), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u9078\u629E\u89E3\u9664"),
                    React.createElement("button", { onClick: deleteEmployees, disabled: selectedEmployees.length === 0, className: "px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed ml-auto" },
                        "\u9078\u629E\u3057\u305F\u5F93\u696D\u54E1\u3092\u524A\u9664 (",
                        selectedEmployees.length,
                        "\u540D)"))),
            React.createElement("div", { className: "bg-white rounded-lg shadow-lg p-6" },
                React.createElement("h3", { className: "text-lg font-bold mb-4" }, "\u30C6\u30FC\u30D6\u30EB\u524A\u9664"),
                React.createElement("div", { className: "max-h-96 overflow-y-auto border rounded p-4 mb-4" }, tables.length === 0 ? (React.createElement("p", { className: "text-gray-500" }, "\u30C6\u30FC\u30D6\u30EB\u304C\u3042\u308A\u307E\u305B\u3093")) : (React.createElement("div", { className: "space-y-2" }, tables.map(table => (React.createElement("label", { key: table.id, className: "flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer" },
                    React.createElement("input", { type: "checkbox", checked: selectedTables.includes(table.id), onChange: (e) => {
                            if (e.target.checked) {
                                setSelectedTables([...selectedTables, table.id]);
                            }
                            else {
                                setSelectedTables(selectedTables.filter(id => id !== table.id));
                            }
                        }, className: "w-4 h-4" }),
                    React.createElement("span", { className: "font-semibold" }, table.name))))))),
                React.createElement("div", { className: "flex gap-3" },
                    React.createElement("button", { onClick: () => setSelectedTables(tables.map(t => t.id)), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u5168\u9078\u629E"),
                    React.createElement("button", { onClick: () => setSelectedTables([]), className: "px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" }, "\u9078\u629E\u89E3\u9664"),
                    React.createElement("button", { onClick: deleteTables, disabled: selectedTables.length === 0, className: "px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed ml-auto" },
                        "\u9078\u629E\u3057\u305F\u30C6\u30FC\u30D6\u30EB\u3092\u524A\u9664 (",
                        selectedTables.length,
                        "\u500B)"))),
            React.createElement("div", { className: "bg-gradient-to-r from-red-600 to-red-800 rounded-lg shadow-lg p-6 text-white" },
                React.createElement("h3", { className: "text-xl font-bold mb-3" }, "\u5168\u524A\u9664\uFF08\u521D\u671F\u5316\uFF09"),
                React.createElement("p", { className: "text-sm mb-4 opacity-90" }, "\u5168\u3066\u306E\u5546\u54C1\u3001\u5F93\u696D\u54E1\u3001\u52E4\u6020\u30C7\u30FC\u30BF\u3001\u6CE8\u6587\u5C65\u6B74\u3001\u8A2D\u5B9A\u3092\u524A\u9664\u3057\u307E\u3059\u3002"),
                React.createElement("div", { className: "bg-white bg-opacity-20 rounded p-3 mb-4" },
                    React.createElement("p", { className: "text-sm font-semibold mb-2" }, "\u524A\u9664\u3055\u308C\u308B\u30C7\u30FC\u30BF:"),
                    React.createElement("ul", { className: "text-sm space-y-1 list-disc list-inside" },
                        React.createElement("li", null,
                            "\u5546\u54C1: ",
                            products.length,
                            "\u4EF6"),
                        React.createElement("li", null,
                            "\u5F93\u696D\u54E1: ",
                            employees.length,
                            "\u540D"),
                        React.createElement("li", null, "\u5168\u3066\u306E\u52E4\u6020\u30C7\u30FC\u30BF"),
                        React.createElement("li", null, "\u5168\u3066\u306E\u6CE8\u6587\u5C65\u6B74"),
                        React.createElement("li", null, "\u5168\u3066\u306E\u8A2D\u5B9A"))),
                React.createElement("button", { onClick: deleteAll, className: "w-full px-6 py-3 bg-white text-red-700 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105" }, "\u5168\u30C7\u30FC\u30BF\u3092\u524A\u9664\uFF08\u521D\u671F\u5316\uFF09")),
            React.createElement("div", { className: "bg-gradient-to-r from-orange-500 to-orange-700 rounded-lg shadow-lg p-6 text-white" },
                React.createElement("h3", { className: "text-xl font-bold mb-3" }, "\u53E4\u3044\u30C7\u30FC\u30BF\u306E\u524A\u9664"),
                React.createElement("p", { className: "text-sm mb-4 opacity-90" }, "7\u5E74\u4EE5\u4E0A\u524D\u306E\u6CE8\u6587\u5C65\u6B74\u3068\u52E4\u6020\u30C7\u30FC\u30BF\u3092\u524A\u9664\u3057\u307E\u3059\u3002"),
                React.createElement("div", { className: "bg-white bg-opacity-20 rounded p-3 mb-4" },
                    React.createElement("p", { className: "text-sm" }, "\u6CE8: \u3053\u306E\u6A5F\u80FD\u306F\u7BA1\u7406\u753B\u9762\u3092\u958B\u3044\u305F\u6642\u306B\u81EA\u52D5\u7684\u306B\u5B9F\u884C\u3055\u308C\u307E\u3059\u3002\u624B\u52D5\u3067\u5B9F\u884C\u3059\u308B\u5834\u5408\u306F\u4E0B\u306E\u30DC\u30BF\u30F3\u3092\u62BC\u3057\u3066\u304F\u3060\u3055\u3044\u3002")),
                React.createElement("button", { onClick: async () => {
                        const count = await deleteOldData();
                        if (count === 0) {
                            showCustomAlertFunc('7å¹´ä»¥ä¸Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ', 'ç¢ºèªå®Œäº†', 'OK');
                        }
                    }, className: "w-full px-6 py-3 bg-white text-orange-700 rounded-lg hover:bg-gray-100 font-bold shadow-lg transition-all hover:scale-105" }, "7\u5E74\u4EE5\u4E0A\u53E4\u3044\u30C7\u30FC\u30BF\u3092\u524A\u9664"))))));
};
// Firebaseã®æº–å‚™ãŒã§ããŸã‚‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
const waitAndRender = () => {
    if (window.FirebaseReady) {
        ReactDOM.render(React.createElement(AdminSystem, null), document.getElementById('root'));
        if (window.hideLoadingScreen)
            window.hideLoadingScreen();
    }
    else {
        setTimeout(waitAndRender, 100);
    }
};
waitAndRender();

</script>
</body>
</html>