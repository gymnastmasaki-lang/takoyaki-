<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒãƒ³ãƒ‡ã‚£ã‚·ã‚¹ãƒ†ãƒ </title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ */
    .login-screen {
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .login-screen h1 {
      text-align: center;
      color: #667eea;
      margin-bottom: 30px;
      font-size: 28px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: bold;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .login-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }
    
    .login-btn:active {
      transform: scale(0.98);
    }
    
    /* ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç”»é¢ */
    .tables-screen {
      display: none;
    }
    
    .header {
      background: white;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .header h2 {
      color: #667eea;
      margin-bottom: 10px;
    }
    
    .header .store-info {
      color: #666;
      font-size: 14px;
    }
    
    .logout-btn {
      background: #f44336;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .tables-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }
    
    .table-card {
      background: white;
      border-radius: 15px;
      padding: 30px 20px;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .table-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    .table-card:active {
      transform: translateY(-2px);
    }
    
    .table-card .table-name {
      font-size: 24px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 10px;
    }
    
    .table-card .table-status {
      font-size: 12px;
      color: #999;
    }
    
    .hidden {
      display: none !important;
    }
    
    .error-message {
      background: #ffebee;
      color: #c62828;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .debug-info {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-top: 15px;
      font-size: 11px;
      font-family: monospace;
      color: #666;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: white;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
    <div class="login-screen" id="loginScreen">
      <h1>ğŸ½ï¸ ãƒãƒ³ãƒ‡ã‚£ã‚·ã‚¹ãƒ†ãƒ </h1>
      <div id="errorMessage" class="error-message hidden"></div>
      
      <div class="form-group">
        <label for="storeSelect">åº—èˆ—ã‚’é¸æŠ</label>
        <select id="storeSelect">
          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="passwordInput">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
        <input type="password" id="passwordInput" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      </div>
      
      <button class="login-btn" onclick="handleLogin()">ãƒ­ã‚°ã‚¤ãƒ³</button>
      
      <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
      <div id="debugInfo" class="debug-info"></div>
    </div>
    
    <!-- ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç”»é¢ -->
    <div class="tables-screen" id="tablesScreen">
      <div class="header">
        <h2 id="storeNameDisplay">åº—èˆ—å</h2>
        <div class="store-info">ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        <button class="logout-btn" onclick="handleLogout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>
      
      <div class="tables-grid" id="tablesGrid">
        <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
      </div>
    </div>
  </div>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, query, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    
    const firebaseConfig = {
      apiKey: "AIzaSyBoSdfEkez-b3P0BUHtowxCrTw-yEBdHSg",
      authDomain: "takoyaki-order-system-bacd7.firebaseapp.com",
      projectId: "takoyaki-order-system-bacd7",
      storageBucket: "takoyaki-order-system-bacd7.firebasestorage.app",
      messagingSenderId: "104494752890",
      appId: "1:104494752890:web:c0a25d62f42ffca01687c3"
    };
    
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
    window.db = db;
    window.collection = collection;
    window.query = query;
    window.getDocs = getDocs;
    window.doc = doc;
    window.getDoc = getDoc;
    
    console.log('âœ… FirebaseåˆæœŸåŒ–å®Œäº†');
    addDebugLog('âœ… FirebaseåˆæœŸåŒ–å®Œäº†');
    
    // åº—èˆ—ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿
    loadStoreList();
  </script>
  
  <script>
    let currentStoreId = null;
    let currentStoreName = null;
    let storesData = {}; // åº—èˆ—ã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    
    // ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’ç”»é¢ã«è¡¨ç¤º
    function addDebugLog(message) {
      const debugDiv = document.getElementById('debugInfo');
      const timestamp = new Date().toLocaleTimeString();
      debugDiv.innerHTML += `[${timestamp}] ${message}\n`;
      debugDiv.scrollTop = debugDiv.scrollHeight;
      console.log(message);
    }
    
    // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¦‹ã‚„ã™ãæ–‡å­—åˆ—åŒ–
    function formatObject(obj) {
      return JSON.stringify(obj, null, 2);
    }
    
    // åº—èˆ—ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿
    async function loadStoreList() {
      try {
        addDebugLog('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        addDebugLog('ğŸ”„ åº—èˆ—ãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿é–‹å§‹');
        
        const storesSnapshot = await window.getDocs(window.collection(window.db, 'stores'));
        const storeSelect = document.getElementById('storeSelect');
        
        storeSelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>';
        storesData = {}; // ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
        
        addDebugLog(`ğŸ“¦ å–å¾—ã—ãŸåº—èˆ—æ•°: ${storesSnapshot.size}`);
        
        storesSnapshot.forEach(doc => {
          const storeId = doc.id;
          const storeData = doc.data();
          
          // å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒ­ã‚°ã«å‡ºåŠ›
          addDebugLog(`\nğŸ“ åº—èˆ—ID: ${storeId}`);
          addDebugLog(`ãƒ‡ãƒ¼ã‚¿æ§‹é€ :\n${formatObject(storeData)}`);
          
          // åº—èˆ—åã‚’å–å¾—ï¼ˆè¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾å¿œï¼‰
          let storeName = storeId; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID
          
          // æ§˜ã€…ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã«å¯¾å¿œ
          if (storeData.storeName) {
            storeName = storeData.storeName;
            addDebugLog(`  âœ“ storeNameä½¿ç”¨: ${storeName}`);
          } else if (storeData.name) {
            storeName = storeData.name;
            addDebugLog(`  âœ“ nameä½¿ç”¨: ${storeName}`);
          } else if (storeData.åº—èˆ—å) {
            storeName = storeData.åº—èˆ—å;
            addDebugLog(`  âœ“ åº—èˆ—åä½¿ç”¨: ${storeName}`);
          } else if (storeData.title) {
            storeName = storeData.title;
            addDebugLog(`  âœ“ titleä½¿ç”¨: ${storeName}`);
          } else {
            addDebugLog(`  âš  åº—èˆ—åãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ã€IDä½¿ç”¨: ${storeName}`);
          }
          
          // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ï¼ˆè¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾å¿œï¼‰
          let password = '0000'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
          
          if (storeData.password !== undefined && storeData.password !== null) {
            password = String(storeData.password);
            addDebugLog(`  âœ“ password: ${password} (å‹: ${typeof storeData.password})`);
          } else if (storeData.pass !== undefined && storeData.pass !== null) {
            password = String(storeData.pass);
            addDebugLog(`  âœ“ pass: ${password} (å‹: ${typeof storeData.pass})`);
          } else if (storeData.ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ !== undefined && storeData.ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ !== null) {
            password = String(storeData.ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰);
            addDebugLog(`  âœ“ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: ${password}`);
          } else {
            addDebugLog(`  âš  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½¿ç”¨: ${password}`);
          }
          
          // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
          storesData[storeId] = {
            name: storeName,
            password: password,
            rawData: storeData
          };
          
          // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã«è¿½åŠ 
          const option = document.createElement('option');
          option.value = storeId;
          option.textContent = storeName;
          storeSelect.appendChild(option);
        });
        
        // ä¸‹èµ¤å¡šåº—ã‚‚è¿½åŠ ï¼ˆæ—§ã‚·ã‚¹ãƒ†ãƒ ç”¨ï¼‰
        const oldStoreOption = document.createElement('option');
        oldStoreOption.value = 'shimoakatsuka';
        oldStoreOption.textContent = 'ç²‰ã‚‚ã‚“å±‹ å…« ä¸‹èµ¤å¡šåº—';
        storesData['shimoakatsuka'] = {
          name: 'ç²‰ã‚‚ã‚“å±‹ å…« ä¸‹èµ¤å¡šåº—',
          password: '1111',
          rawData: { legacy: true }
        };
        storeSelect.appendChild(oldStoreOption);
        addDebugLog('\nğŸ“ æ—§åº—èˆ—è¿½åŠ : ä¸‹èµ¤å¡šåº— (PW: 1111)');
        
        addDebugLog(`\nâœ… åº—èˆ—ãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿å®Œäº† (${Object.keys(storesData).length}åº—èˆ—)`);
        addDebugLog('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n');
      } catch (error) {
        addDebugLog(`\nâŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`);
        showError('åº—èˆ—ãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }
    
    // ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
    window.handleLogin = async function() {
      const storeSelect = document.getElementById('storeSelect');
      const passwordInput = document.getElementById('passwordInput');
      
      const storeId = storeSelect.value;
      const inputPassword = passwordInput.value.trim();
      
      addDebugLog('\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
      addDebugLog('ğŸ” ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ');
      
      if (!storeId) {
        addDebugLog('âŒ åº—èˆ—æœªé¸æŠ');
        showError('åº—èˆ—ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      if (!inputPassword) {
        addDebugLog('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æœªå…¥åŠ›');
        showError('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      const storeInfo = storesData[storeId];
      if (!storeInfo) {
        addDebugLog('âŒ åº—èˆ—æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        showError('åº—èˆ—æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        return;
      }
      
      const storeName = storeInfo.name;
      const correctPassword = storeInfo.password;
      
      addDebugLog(`åº—èˆ—ID: ${storeId}`);
      addDebugLog(`åº—èˆ—å: ${storeName}`);
      addDebugLog(`å…¥åŠ›PW: "${inputPassword}" (${inputPassword.length}æ–‡å­—)`);
      addDebugLog(`æ­£è§£PW: "${correctPassword}" (${correctPassword.length}æ–‡å­—)`);
      addDebugLog(`å‹: å…¥åŠ›=${typeof inputPassword}, æ­£è§£=${typeof correctPassword}`);
      
      // ãƒã‚¤ãƒˆãƒ¬ãƒ™ãƒ«æ¯”è¼ƒ
      const inputBytes = Array.from(inputPassword).map(c => c.charCodeAt(0));
      const correctBytes = Array.from(correctPassword).map(c => c.charCodeAt(0));
      addDebugLog(`å…¥åŠ›bytes: [${inputBytes.join(', ')}]`);
      addDebugLog(`æ­£è§£bytes: [${correctBytes.join(', ')}]`);
      
      // æ–‡å­—åˆ—ã¨ã—ã¦å³å¯†ã«æ¯”è¼ƒ
      const isMatch = inputPassword === correctPassword;
      addDebugLog(`æ¯”è¼ƒçµæœ: ${isMatch ? 'âœ… ä¸€è‡´' : 'âŒ ä¸ä¸€è‡´'}`);
      
      if (!isMatch) {
        addDebugLog('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸ä¸€è‡´');
        showError('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
        return;
      }
      
      // ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
      addDebugLog('âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ!');
      currentStoreId = storeId === 'shimoakatsuka' ? null : storeId;
      currentStoreName = storeName;
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜
      sessionStorage.setItem('handyStoreId', currentStoreId || '');
      sessionStorage.setItem('handyStoreName', currentStoreName);
      
      // ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç”»é¢ã‚’è¡¨ç¤º
      showTablesScreen();
    };
    
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
    window.handleLogout = function() {
      sessionStorage.removeItem('handyStoreId');
      sessionStorage.removeItem('handyStoreName');
      
      currentStoreId = null;
      currentStoreName = null;
      
      document.getElementById('loginScreen').classList.remove('hidden');
      document.getElementById('tablesScreen').classList.add('hidden');
      
      document.getElementById('passwordInput').value = '';
      document.getElementById('debugInfo').innerHTML = '';
    };
    
    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.classList.remove('hidden');
      
      setTimeout(() => {
        errorDiv.classList.add('hidden');
      }, 3000);
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç”»é¢ã‚’è¡¨ç¤º
    async function showTablesScreen() {
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('tablesScreen').classList.remove('hidden');
      document.getElementById('storeNameDisplay').textContent = currentStoreName;
      
      await loadTables();
    }
    
    // ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
    async function loadTables() {
      try {
        const tablesGrid = document.getElementById('tablesGrid');
        tablesGrid.innerHTML = '<div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>';
        
        let tablesRef;
        if (currentStoreId) {
          // æ–°ã‚·ã‚¹ãƒ†ãƒ : stores/{storeId}/tables
          tablesRef = window.collection(window.db, 'stores', currentStoreId, 'tables');
        } else {
          // æ—§ã‚·ã‚¹ãƒ†ãƒ : tables
          tablesRef = window.collection(window.db, 'tables');
        }
        
        const tablesSnapshot = await window.getDocs(tablesRef);
        const tables = [];
        
        tablesSnapshot.forEach(doc => {
          tables.push({
            id: doc.id,
            ...doc.data()
          });
        });
        
        // orderãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã‚½ãƒ¼ãƒˆ
        tables.sort((a, b) => {
          const orderA = a.order || 0;
          const orderB = b.order || 0;
          if (orderA !== orderB) {
            return orderA - orderB;
          }
          return a.name.localeCompare(b.name);
        });
        
        if (tables.length === 0) {
          tablesGrid.innerHTML = '<div style="color: white; text-align: center; padding: 40px;">ãƒ†ãƒ¼ãƒ–ãƒ«ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
          return;
        }
        
        tablesGrid.innerHTML = '';
        
        tables.forEach(table => {
          const tableCard = document.createElement('div');
          tableCard.className = 'table-card';
          tableCard.onclick = () => openMenu(table.name);
          
          tableCard.innerHTML = `
            <div class="table-name">${table.name}</div>
            <div class="table-status">ã‚¿ãƒƒãƒ—ã—ã¦æ³¨æ–‡</div>
          `;
          
          tablesGrid.appendChild(tableCard);
        });
        
        console.log('âœ… ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§èª­ã¿è¾¼ã¿å®Œäº†:', tables.length + 'ä»¶');
      } catch (error) {
        console.error('âŒ ãƒ†ãƒ¼ãƒ–ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        tablesGrid.innerHTML = '<div style="color: white; text-align: center; padding: 40px;">ãƒ†ãƒ¼ãƒ–ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
      }
    }
    
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ã‚’é–‹ã
    function openMenu(tableName) {
      console.log('ğŸ“± ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ã‚’é–‹ã:', tableName);
      
      // menu.htmlã«é·ç§»ï¼ˆstoreIdã¨tableã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ¸¡ã™ï¼‰
      let menuUrl = `menu.html?table=${encodeURIComponent(tableName)}&mode=handy`;
      
      if (currentStoreId) {
        menuUrl += `&store=${currentStoreId}`;
      }
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«åº—èˆ—æƒ…å ±ã‚’ä¿å­˜ï¼ˆmenu.htmlã§ä½¿ç”¨ï¼‰
      sessionStorage.setItem('handyStoreId', currentStoreId || '');
      sessionStorage.setItem('handyStoreName', currentStoreName);
      sessionStorage.setItem('handyTableName', tableName);
      
      window.location.href = menuUrl;
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å¾©å…ƒ
    window.addEventListener('DOMContentLoaded', () => {
      const savedStoreId = sessionStorage.getItem('handyStoreId');
      const savedStoreName = sessionStorage.getItem('handyStoreName');
      
      if (savedStoreName) {
        currentStoreId = savedStoreId === '' ? null : savedStoreId;
        currentStoreName = savedStoreName;
        
        console.log('âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å¾©å…ƒ:', currentStoreName);
        showTablesScreen();
      }
    });
  </script>
</body>
</html>
