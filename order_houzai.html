<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åŒ…æç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ  - ç²‰ã‚‚ã‚“å±‹å…« ä¸‹èµ¤å¡šåº—</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js";
    
    const firebaseConfig = {
      apiKey: "AIzaSyBoSdfEkez-b3P0BUHtowxCrTw-yEBdHSg",
      authDomain: "takoyaki-order-system-bacd7.firebaseapp.com",
      projectId: "takoyaki-order-system-bacd7",
      storageBucket: "takoyaki-order-system-bacd7.firebasestorage.app",
      messagingSenderId: "104494752890",
      appId: "1:104494752890:web:c0a25d62f42ffca01687c3"
    };
    
    const app = initializeApp(firebaseConfig);
    const functions = getFunctions(app);
    
    window.firebaseFunctions = functions;
    window.httpsCallable = httpsCallable;
    window.firebaseReady = true;
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      min-height: 100vh;
      padding: 10px;
      margin: 0;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      padding: 15px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 3px solid #FF6B6B;
      padding-bottom: 15px;
    }
    
    .header h1 {
      color: #333;
      font-size: 20px;
      margin-bottom: 5px;
    }
    
    .header .subtitle {
      color: #666;
      font-size: 13px;
    }
    
    .info-section {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    
    .info-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      flex-direction: column;
      align-items: stretch;
    }
    
    .info-row:last-child {
      margin-bottom: 0;
    }
    
    .info-row label {
      width: 100%;
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
      font-size: 14px;
    }
    
    .info-row input {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .info-row input:focus {
      outline: none;
      border-color: #FF6B6B;
    }
    
    .order-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
      font-size: 12px;
    }
    
    .order-table thead {
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      color: white;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .order-table th {
      padding: 10px 5px;
      text-align: left;
      font-weight: bold;
      font-size: 11px;
    }
    
    .order-table th:nth-child(1) { width: 60px; font-size: 10px; }
    .order-table th:nth-child(2) { width: auto; }
    .order-table th:nth-child(3) { width: 70px; }
    .order-table th:nth-child(4) { width: 70px; }
    
    .order-table tbody tr {
      border-bottom: 1px solid #eee;
    }
    
    .order-table tbody tr:hover {
      background: #f8f9fa;
    }
    
    .order-table td {
      padding: 8px 5px;
      font-size: 12px;
    }
    
    .order-table td:first-child {
      font-size: 10px;
      color: #666;
    }
    
    .order-table select {
      width: 100%;
      padding: 6px 2px;
      border: 2px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      background: white;
      cursor: pointer;
      box-sizing: border-box;
    }
    
    .order-table select:focus {
      outline: none;
      border-color: #FF6B6B;
    }
    
    .order-table select:not([value=""]) {
      background: #ffe6e6;
      border-color: #FF6B6B;
    }
    
    .action-buttons {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      flex: 1;
      min-width: 0;
    }
    
    .btn:active {
      transform: scale(0.95);
    }
    
    .btn-pdf {
      background: linear-gradient(135deg, #f44336 0%, #e91e63 100%);
      color: white;
    }
    
    .btn-csv {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
    }
    
    .btn-send {
      background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
      color: white;
    }
    
    .btn-link {
      background: linear-gradient(135deg, #9C27B0 0%, #673AB7 100%);
      color: white;
      text-decoration: none;
    }
    
    .note {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 12px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    .note-title {
      font-weight: bold;
      color: #856404;
      margin-bottom: 5px;
    }
    
    .note-content {
      color: #856404;
      font-size: 12px;
      line-height: 1.6;
    }
    
    @media print {
      body {
        background: white;
        padding: 0;
      }
      
      .container {
        box-shadow: none;
        padding: 20px;
      }
      
      .action-buttons, .note {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>åŒ…æç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </h1>
    </div>
    
    <div class="info-section">
      <div class="info-row">
        <label>é¡§å®¢ã‚³ãƒ¼ãƒ‰:</label>
        <input type="text" id="customerCode" value="2965" placeholder="é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      </div>
      <div class="info-row">
        <label>ç™ºæ³¨æ—¥:</label>
        <input type="date" id="orderDate">
      </div>
    </div>
    
    <table class="order-table" id="orderTable">
      <thead>
        <tr>
          <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th>å•†å“å</th>
          <th>ã‚±ãƒ¼ã‚¹æ•°</th>
          <th>ãƒãƒ©æ•°</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>3009</td>
          <td>èˆŸï¼—å¯¸</td>
          
          <td><select class="qty-case" data-product="èˆŸï¼—å¯¸" data-code="3009" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="èˆŸï¼—å¯¸" data-code="3009" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3011</td>
          <td>èˆŸ9å¯¸</td>
          
          <td><select class="qty-case" data-product="èˆŸ9å¯¸" data-code="3011" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="èˆŸ9å¯¸" data-code="3011" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3786</td>
          <td>åå…¥ã‚Šè¢‹å°ã€€No.30</td>
          
          <td><select class="qty-case" data-product="åå…¥ã‚Šè¢‹å°ã€€No.30" data-code="3786" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="åå…¥ã‚Šè¢‹å°ã€€No.30" data-code="3786" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3787</td>
          <td>åå…¥ã‚Šè¢‹å¤§ No.35</td>
          
          <td><select class="qty-case" data-product="åå…¥ã‚Šè¢‹å¤§ No.35" data-code="3787" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="åå…¥ã‚Šè¢‹å¤§ No.35" data-code="3787" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—</td>
          
          <td><select class="qty-case" data-product="ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—" data-unit="æœ¬"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—" data-unit="æœ¬"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3036</td>
          <td>ç‰¹ä¸€æµ…</td>
          
          <td><select class="qty-case" data-product="ç‰¹ä¸€æµ…" data-code="3036" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ç‰¹ä¸€æµ…" data-code="3036" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3031</td>
          <td>ãƒ‘ãƒƒã‚¯ä¸­æ·±</td>
          
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯ä¸­æ·±" data-code="3031" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯ä¸­æ·±" data-code="3031" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3133</td>
          <td>ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…</td>
          
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…" data-code="3133" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…" data-code="3133" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3132</td>
          <td>ãƒ‘ãƒƒã‚¯å¤§æ·±</td>
          
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯å¤§æ·±" data-code="3132" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯å¤§æ·±" data-code="3132" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3662</td>
          <td>ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)</td>
          
          <td><select class="qty-case" data-product="ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)" data-code="3662" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)" data-code="3662" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ãƒ€ã‚·å®¹å™¨</td>
          
          <td><select class="qty-case" data-product="ãƒ€ã‚·å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ€ã‚·å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹</td>
          
          <td><select class="qty-case" data-product="ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3611</td>
          <td>è¢‹ä»˜ã¯ã—</td>
          
          <td><select class="qty-case" data-product="è¢‹ä»˜ã¯ã—" data-code="3611" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="è¢‹ä»˜ã¯ã—" data-code="3611" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3201</td>
          <td>ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿</td>
          
          <td><select class="qty-case" data-product="ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿" data-code="3201" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿" data-code="3201" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3200</td>
          <td>ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“</td>
          
          <td><select class="qty-case" data-product="ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“" data-code="3200" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“" data-code="3200" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹</td>
          
          <td><select class="qty-case" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨</td>
          
          <td><select class="qty-case" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4513</td>
          <td>æ›¿ç³¸ã€€å°</td>
          
          <td><select class="qty-case" data-product="æ›¿ç³¸ã€€å°" data-code="4513" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ›¿ç³¸ã€€å°" data-code="4513" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4026</td>
          <td>ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹</td>
          
          <td><select class="qty-case" data-product="ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹" data-code="4026" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹" data-code="4026" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‹ãæ°·ã‚«ãƒƒãƒ—</td>
          
          <td><select class="qty-case" data-product="ã‹ãæ°·ã‚«ãƒƒãƒ—" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‹ãæ°·ã‚«ãƒƒãƒ—" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>æ°·ã‚¹ãƒˆãƒ­ãƒ¼</td>
          
          <td><select class="qty-case" data-product="æ°·ã‚¹ãƒˆãƒ­ãƒ¼" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ°·ã‚¹ãƒˆãƒ­ãƒ¼" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼</td>
          
          <td><select class="qty-case" data-product="é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4008</td>
          <td>æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³</td>
          
          <td><select class="qty-case" data-product="æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³" data-code="4008" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³" data-code="4008" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ</td>
          
          <td><select class="qty-case" data-product="ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3645</td>
          <td>è¼ªã‚´ãƒ </td>
          
          <td><select class="qty-case" data-product="è¼ªã‚´ãƒ " data-code="3645" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="è¼ªã‚´ãƒ " data-code="3645" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ç´™ãŠã—ã¼ã‚Š</td>
          
          <td><select class="qty-case" data-product="ç´™ãŠã—ã¼ã‚Š" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ç´™ãŠã—ã¼ã‚Š" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
      </tbody>
    </table>
    
    <div class="action-buttons" id="actionButtons">
      <button class="btn btn-pdf" onclick="generatePDF()">ğŸ“„ PDFå‡ºåŠ›</button>
      <button class="btn btn-send" onclick="sendOrder()" id="sendBtn">ğŸ“§ ç™ºæ³¨ã™ã‚‹</button>
    </div>
    
    <div class="action-buttons" id="switchButtons" style="display: none;">
      <a href="order_shokuzai.html" class="btn btn-link">é£Ÿæç™ºæ³¨ã¸</a>
    </div>
    
    <div class="note">
      <div class="note-title">ğŸ’¡ ä½¿ã„æ–¹</div>
      <div class="note-content">
        1. é¡§å®¢ã‚³ãƒ¼ãƒ‰ã¨ç™ºæ³¨æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„<br>
        2. å„å•†å“ã®ã‚±ãƒ¼ã‚¹æ•°ãƒ»ãƒãƒ©æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆæ•°é‡ã‚’é¸æŠã—ãŸå•†å“ã®ã¿ç™ºæ³¨ã•ã‚Œã¾ã™ï¼‰
      </div>
    </div>
  </div>
  
  <script>
    // ä»Šæ—¥ã®æ—¥ä»˜ã‚’è¨­å®š
    document.getElementById('orderDate').valueAsDate = new Date();
    
    // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸã‚‰èƒŒæ™¯è‰²ã‚’å¤‰æ›´
    document.querySelectorAll('select').forEach(select => {
      select.addEventListener('change', function() {
        if (this.value) {
          this.style.background = '#ffe6e6';
          this.style.borderColor = '#FF6B6B';
        } else {
          this.style.background = 'white';
          this.style.borderColor = '#ddd';
        }
      });
    });
    
    // PDFç”Ÿæˆ
    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = caseSelect.value;
        const baraQty = baraSelect.value;
        
        if (caseQty || baraQty) {
          const code = caseSelect.dataset.code || '';
          const product = caseSelect.dataset.product;
          const unit = caseSelect.dataset.unit;
          
          orders.push({
            code: code,
            product: product,
            unit: unit,
            caseQty: caseQty,
            baraQty: baraQty
          });
        }
      });
      
      if (orders.length === 0) {
        alert('æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // PDFã®ãƒ˜ãƒƒãƒ€ãƒ¼
      doc.setFontSize(18);
      doc.text('ç™ºæ³¨è¡¨ï¼ˆåŒ…æï¼‰', 105, 20, { align: 'center' });
      
      doc.setFontSize(12);
      doc.text(`é¡§å®¢ã‚³ãƒ¼ãƒ‰: ${customerCode}`, 20, 35);
      doc.text(`ç™ºæ³¨æ—¥: ${orderDate}`, 20, 42);
      
      // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼
      doc.setFontSize(10);
      let y = 55;
      doc.text('å•†å“ã‚³ãƒ¼ãƒ‰', 20, y);
      doc.text('å•†å“å', 60, y);
      doc.text('ã‚±ãƒ¼ã‚¹æ•°', 130, y);
      doc.text('ãƒãƒ©æ•°', 165, y);
      
      doc.line(20, y + 2, 200, y + 2);
      
      y += 8;
      
      // å•†å“ãƒªã‚¹ãƒˆ
      orders.forEach(order => {
        if (y > 270) {
          doc.addPage();
          y = 20;
        }
        
        doc.text(order.code, 20, y);
        doc.text(order.product, 60, y);
        doc.text(order.caseQty || '-', 130, y);
        doc.text(order.baraQty || '-', 165, y);
        
        y += 7;
      });
      
      // PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
      doc.save(`åŒ…æç™ºæ³¨_${orderDate}.pdf`);
    }
    
    // CSVå‡ºåŠ›ï¼ˆPCAå•†é­‚å•†ç®¡ç”¨ï¼‰
    function downloadCSV() {
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      if (!customerCode) {
        alert('é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = parseInt(caseSelect.value) || 0;
        const baraQty = parseInt(baraSelect.value) || 0;
        
        if (caseQty > 0 || baraQty > 0) {
          const code = caseSelect.dataset.code || '';
          
          // å•†å“ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã®ã¿CSVã«å«ã‚ã‚‹
          if (code) {
            orders.push({
              productCode: code,
              quantity: baraQty,  // ãƒãƒ©æ•°ã¯ã€Œæ•°é‡ã€åˆ—
              boxes: caseQty      // ã‚±ãƒ¼ã‚¹æ•°ã¯ã€Œç®±æ•°ã€åˆ—ï¼ˆåŒºåˆ†ï¼‰
            });
          }
        }
      });
      
      if (orders.length === 0) {
        alert('å•†å“ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å•†å“ã®æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // CSVãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆPCAå•†é­‚å•†ç®¡å½¢å¼ï¼‰
      let csv = 'å•†å“ã‚³ãƒ¼ãƒ‰,æ•°é‡,ç®±æ•°\n';
      
      // CSVãƒ‡ãƒ¼ã‚¿
      orders.forEach(order => {
        csv += `${order.productCode},${order.quantity},${order.boxes}\n`;
      });
      
      // BOMä»˜ãã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆExcelã§æ–‡å­—åŒ–ã‘é˜²æ­¢ï¼‰
      const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
      const blob = new Blob([bom, csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `åŒ…æç™ºæ³¨_PCA_${orderDate}.csv`;
      link.click();
    }
    
    // ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆFirebase Functionsä½¿ç”¨ï¼‰
    async function sendOrder() {
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      if (!customerCode) {
        alert('é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = caseSelect.value;
        const baraQty = baraSelect.value;
        
        if (caseQty || baraQty) {
          const code = caseSelect.dataset.code || '';
          const product = caseSelect.dataset.product;
          
          orders.push({
            code: code,
            product: product,
            caseQty: caseQty,
            baraQty: baraQty
          });
        }
      });
      
      if (orders.length === 0) {
        alert('æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
      const sendBtn = document.getElementById('sendBtn');
      const originalText = sendBtn.textContent;
      sendBtn.disabled = true;
      sendBtn.textContent = 'ğŸ“§ é€ä¿¡ä¸­...';
      sendBtn.style.opacity = '0.6';
      
      try {
        // Firebase Functionsã‚’å‘¼ã³å‡ºã—
        const sendOrderFunction = window.httpsCallable(window.firebaseFunctions, 'sendOrder');
        const result = await sendOrderFunction({
          customerCode: customerCode,
          orderDate: orderDate,
          orders: orders,
          orderType: 'houzai'
        });
        
        alert('âœ… ç™ºæ³¨ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼\nPDFã¨CSVã‚’æ·»ä»˜ã—ã¦ gymnastmasaki@yahoo.co.jp ã«é€ä¿¡æ¸ˆã¿ã§ã™ã€‚');
        
        // åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
        document.getElementById('actionButtons').style.display = 'none';
        document.getElementById('switchButtons').style.display = 'flex';
        
      } catch (error) {
        console.error('é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
        alert('âŒ é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
        
        // ãƒœã‚¿ãƒ³ã‚’å…ƒã«æˆ»ã™
        sendBtn.disabled = false;
        sendBtn.textContent = originalText;
        sendBtn.style.opacity = '1';
      }
    }
  </script>
</body>
</html>
