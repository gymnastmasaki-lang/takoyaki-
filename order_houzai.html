<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åŒ…æç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ  - ç²‰ã‚‚ã‚“å±‹å…« ä¸‹èµ¤å¡šåº—</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      padding: 40px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 3px solid #FF6B6B;
      padding-bottom: 20px;
    }
    
    .header h1 {
      color: #333;
      font-size: 28px;
      margin-bottom: 10px;
    }
    
    .header .subtitle {
      color: #666;
      font-size: 16px;
    }
    
    .info-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
    
    .info-row {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .info-row:last-child {
      margin-bottom: 0;
    }
    
    .info-row label {
      width: 150px;
      font-weight: bold;
      color: #333;
    }
    
    .info-row input {
      flex: 1;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
    }
    
    .info-row input:focus {
      outline: none;
      border-color: #FF6B6B;
    }
    
    .order-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .order-table thead {
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      color: white;
    }
    
    .order-table th {
      padding: 15px 10px;
      text-align: left;
      font-weight: bold;
    }
    
    .order-table th:nth-child(1) { width: 100px; }
    .order-table th:nth-child(2) { width: auto; }
    .order-table th:nth-child(3) { width: 80px; }
    .order-table th:nth-child(4) { width: 120px; }
    .order-table th:nth-child(5) { width: 120px; }
    
    .order-table tbody tr {
      border-bottom: 1px solid #eee;
    }
    
    .order-table tbody tr:hover {
      background: #f8f9fa;
    }
    
    .order-table td {
      padding: 12px 10px;
    }
    
    .order-table select {
      width: 100%;
      padding: 8px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      background: white;
      cursor: pointer;
    }
    
    .order-table select:focus {
      outline: none;
      border-color: #FF6B6B;
    }
    
    .order-table select:not([value=""]) {
      background: #ffe6e6;
      border-color: #FF6B6B;
    }
    
    .action-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 15px 40px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .btn-pdf {
      background: linear-gradient(135deg, #f44336 0%, #e91e63 100%);
      color: white;
    }
    
    .btn-csv {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
    }
    
    .btn-send {
      background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
      color: white;
    }
    
    .btn-link {
      background: linear-gradient(135deg, #9C27B0 0%, #673AB7 100%);
      color: white;
      text-decoration: none;
    }
    
    .note {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin-top: 20px;
      border-radius: 4px;
    }
    
    .note-title {
      font-weight: bold;
      color: #856404;
      margin-bottom: 5px;
    }
    
    .note-content {
      color: #856404;
      font-size: 14px;
    }
    
    @media print {
      body {
        background: white;
        padding: 0;
      }
      
      .container {
        box-shadow: none;
        padding: 20px;
      }
      
      .action-buttons, .note {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“¦ åŒ…æç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ </h1>
      <div class="subtitle">ç²‰ã‚‚ã‚“å±‹å…« ä¸‹èµ¤å¡šåº—</div>
    </div>
    
    <div class="info-section">
      <div class="info-row">
        <label>é¡§å®¢ã‚³ãƒ¼ãƒ‰:</label>
        <input type="text" id="customerCode" value="2965" placeholder="é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      </div>
      <div class="info-row">
        <label>ç™ºæ³¨æ—¥:</label>
        <input type="date" id="orderDate">
      </div>
    </div>
    
    <table class="order-table" id="orderTable">
      <thead>
        <tr>
          <th>å•†å“ã‚³ãƒ¼ãƒ‰</th>
          <th>å•†å“å</th>
          <th>å˜ä½</th>
          <th>ã‚±ãƒ¼ã‚¹æ•°</th>
          <th>ãƒãƒ©æ•°</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>3009</td>
          <td>èˆŸï¼—å¯¸</td>
          <td>ã‚±ãƒ¼ã‚¹</td>
          <td><select class="qty-case" data-product="èˆŸï¼—å¯¸" data-code="3009" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="èˆŸï¼—å¯¸" data-code="3009" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3011</td>
          <td>èˆŸ9å¯¸</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="èˆŸ9å¯¸" data-code="3011" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="èˆŸ9å¯¸" data-code="3011" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3786</td>
          <td>åå…¥ã‚Šè¢‹å°ã€€No.30</td>
          <td>ã‚±ãƒ¼ã‚¹</td>
          <td><select class="qty-case" data-product="åå…¥ã‚Šè¢‹å°ã€€No.30" data-code="3786" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="åå…¥ã‚Šè¢‹å°ã€€No.30" data-code="3786" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3787</td>
          <td>åå…¥ã‚Šè¢‹å¤§ No.35</td>
          <td>ã‚±ãƒ¼ã‚¹</td>
          <td><select class="qty-case" data-product="åå…¥ã‚Šè¢‹å¤§ No.35" data-code="3787" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="åå…¥ã‚Šè¢‹å¤§ No.35" data-code="3787" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—</td>
          <td>æœ¬</td>
          <td><select class="qty-case" data-product="ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—" data-unit="æœ¬"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚µãƒ©ãƒ³ãƒ©ãƒƒãƒ—" data-unit="æœ¬"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3036</td>
          <td>ç‰¹ä¸€æµ…</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ç‰¹ä¸€æµ…" data-code="3036" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ç‰¹ä¸€æµ…" data-code="3036" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3031</td>
          <td>ãƒ‘ãƒƒã‚¯ä¸­æ·±</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯ä¸­æ·±" data-code="3031" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯ä¸­æ·±" data-code="3031" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3133</td>
          <td>ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…" data-code="3133" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯ç‰¹ä¸­æµ…" data-code="3133" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3132</td>
          <td>ãƒ‘ãƒƒã‚¯å¤§æ·±</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãƒ‘ãƒƒã‚¯å¤§æ·±" data-code="3132" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‘ãƒƒã‚¯å¤§æ·±" data-code="3132" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3662</td>
          <td>ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)" data-code="3662" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¿ãƒ¬ãƒ“ãƒ³è§’ä¸­(ãƒãƒ³é…¢å…¥ã‚Œ)" data-code="3662" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ãƒ€ã‚·å®¹å™¨</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãƒ€ã‚·å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ€ã‚·å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒ‹ãƒ¥ãƒ¼ãƒãƒªè¢‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3611</td>
          <td>è¢‹ä»˜ã¯ã—</td>
          <td>ã‚±ãƒ¼ã‚¹</td>
          <td><select class="qty-case" data-product="è¢‹ä»˜ã¯ã—" data-code="3611" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="è¢‹ä»˜ã¯ã—" data-code="3611" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3201</td>
          <td>ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿" data-code="3201" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãŠå¥½ã¿ç„¼ãã€€ãƒ•ã‚¿" data-code="3201" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3200</td>
          <td>ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“" data-code="3200" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãŠå¥½ã¿ç„¼ãã€€æœ¬ä½“" data-code="3200" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—è“‹" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¯ãƒªãƒ¼ãƒ³ã‚«ãƒƒãƒ—å®¹å™¨" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4513</td>
          <td>æ›¿ç³¸ã€€å°</td>
          <td>å€‹</td>
          <td><select class="qty-case" data-product="æ›¿ç³¸ã€€å°" data-code="4513" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ›¿ç³¸ã€€å°" data-code="4513" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4026</td>
          <td>ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹</td>
          <td>ç®±</td>
          <td><select class="qty-case" data-product="ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹" data-code="4026" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ãƒãƒªæ‰‹è¢‹ã‚¨ãƒ³ãƒœã‚¹" data-code="4026" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‹ãæ°·ã‚«ãƒƒãƒ—</td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="ã‹ãæ°·ã‚«ãƒƒãƒ—" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‹ãæ°·ã‚«ãƒƒãƒ—" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>æ°·ã‚¹ãƒˆãƒ­ãƒ¼</td>
          <td>ç®±</td>
          <td><select class="qty-case" data-product="æ°·ã‚¹ãƒˆãƒ­ãƒ¼" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ°·ã‚¹ãƒˆãƒ­ãƒ¼" data-unit="ç®±"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼</td>
          <td>å€‹</td>
          <td><select class="qty-case" data-product="é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="é‰„æ¿ã‚¯ãƒªãƒ¼ãƒŠãƒ¼" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>4008</td>
          <td>æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³</td>
          <td>å€‹</td>
          <td><select class="qty-case" data-product="æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³" data-code="4008" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="æ¿ƒç¸®æ´—å‰¤ã€€ã‚³ãƒ³ã‚¯ã‚¨ã‚³" data-code="4008" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ</td>
          <td>å€‹</td>
          <td><select class="qty-case" data-product="ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ã‚¨ã‚³ã‚¹ãƒãƒ¼ãƒˆ" data-unit="å€‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td>3645</td>
          <td>è¼ªã‚´ãƒ </td>
          <td>è¢‹</td>
          <td><select class="qty-case" data-product="è¼ªã‚´ãƒ " data-code="3645" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="è¼ªã‚´ãƒ " data-code="3645" data-unit="è¢‹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
        <tr>
          <td></td>
          <td>ç´™ãŠã—ã¼ã‚Š</td>
          <td>ã‚±ãƒ¼ã‚¹</td>
          <td><select class="qty-case" data-product="ç´™ãŠã—ã¼ã‚Š" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
          <td><select class="qty-bara" data-product="ç´™ãŠã—ã¼ã‚Š" data-unit="ã‚±ãƒ¼ã‚¹"><option value="">-</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
        </tr>
      </tbody>
    </table>
    
    <div class="action-buttons">
      <button class="btn btn-pdf" onclick="generatePDF()">ğŸ“„ PDFå‡ºåŠ›</button>
      <button class="btn btn-csv" onclick="downloadCSV()">ğŸ“Š CSVå‡ºåŠ›</button>
      <button class="btn btn-send" onclick="sendOrder()">ğŸ“§ ç™ºæ³¨ã™ã‚‹</button>
      <a href="order_shokuzai.html" class="btn btn-link">ğŸœ é£Ÿæç™ºæ³¨ã¸</a>
    </div>
    
    <div class="note">
      <div class="note-title">ğŸ’¡ ä½¿ã„æ–¹</div>
      <div class="note-content">
        1. é¡§å®¢ã‚³ãƒ¼ãƒ‰ã¨ç™ºæ³¨æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„<br>
        2. å„å•†å“ã®ã‚±ãƒ¼ã‚¹æ•°ãƒ»ãƒãƒ©æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆæ•°é‡ã‚’é¸æŠã—ãŸå•†å“ã®ã¿ç™ºæ³¨ã•ã‚Œã¾ã™ï¼‰<br>
        3. ã€ŒPDFå‡ºåŠ›ã€ã§ç™ºæ³¨æ›¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã¾ãŸã¯ã€Œç™ºæ³¨ã™ã‚‹ã€ã§æ „å’Œé£Ÿå“ã«ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã§ãã¾ã™<br>
        4. ã€ŒCSVå‡ºåŠ›ã€ã§PCAå•†é­‚å•†ç®¡ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™<br>
        â€» CSVå‡ºåŠ›ã¯å•†å“ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å•†å“ã®ã¿å¯¾è±¡ã§ã™ï¼ˆã‚±ãƒ¼ã‚¹â†’ç®±æ•°ã€ãƒãƒ©â†’æ•°é‡ï¼‰
      </div>
    </div>
  </div>
  
  <script>
    // ä»Šæ—¥ã®æ—¥ä»˜ã‚’è¨­å®š
    document.getElementById('orderDate').valueAsDate = new Date();
    
    // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸã‚‰èƒŒæ™¯è‰²ã‚’å¤‰æ›´
    document.querySelectorAll('select').forEach(select => {
      select.addEventListener('change', function() {
        if (this.value) {
          this.style.background = '#ffe6e6';
          this.style.borderColor = '#FF6B6B';
        } else {
          this.style.background = 'white';
          this.style.borderColor = '#ddd';
        }
      });
    });
    
    // PDFç”Ÿæˆ
    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = caseSelect.value;
        const baraQty = baraSelect.value;
        
        if (caseQty || baraQty) {
          const code = caseSelect.dataset.code || '';
          const product = caseSelect.dataset.product;
          const unit = caseSelect.dataset.unit;
          
          orders.push({
            code: code,
            product: product,
            unit: unit,
            caseQty: caseQty,
            baraQty: baraQty
          });
        }
      });
      
      if (orders.length === 0) {
        alert('æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // PDFã®ãƒ˜ãƒƒãƒ€ãƒ¼
      doc.setFontSize(18);
      doc.text('ç™ºæ³¨è¡¨ï¼ˆåŒ…æï¼‰', 105, 20, { align: 'center' });
      
      doc.setFontSize(12);
      doc.text(`é¡§å®¢ã‚³ãƒ¼ãƒ‰: ${customerCode}`, 20, 35);
      doc.text('ç²‰ã‚‚ã‚“å±‹å…«ã€€ä¸‹èµ¤å¡šåº—', 20, 42);
      doc.text(`ç™ºæ³¨æ—¥: ${orderDate}`, 20, 49);
      
      // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼
      doc.setFontSize(10);
      let y = 60;
      doc.text('å•†å“ã‚³ãƒ¼ãƒ‰', 20, y);
      doc.text('å•†å“å', 60, y);
      doc.text('å˜ä½', 120, y);
      doc.text('ã‚±ãƒ¼ã‚¹æ•°', 145, y);
      doc.text('ãƒãƒ©æ•°', 175, y);
      
      doc.line(20, y + 2, 200, y + 2);
      
      y += 8;
      
      // å•†å“ãƒªã‚¹ãƒˆ
      orders.forEach(order => {
        if (y > 270) {
          doc.addPage();
          y = 20;
        }
        
        doc.text(order.code, 20, y);
        doc.text(order.product, 60, y);
        doc.text(order.unit, 120, y);
        doc.text(order.caseQty || '-', 145, y);
        doc.text(order.baraQty || '-', 175, y);
        
        y += 7;
      });
      
      // PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
      doc.save(`åŒ…æç™ºæ³¨_${orderDate}.pdf`);
    }
    
    // CSVå‡ºåŠ›ï¼ˆPCAå•†é­‚å•†ç®¡ç”¨ï¼‰
    function downloadCSV() {
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      if (!customerCode) {
        alert('é¡§å®¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = parseInt(caseSelect.value) || 0;
        const baraQty = parseInt(baraSelect.value) || 0;
        
        if (caseQty > 0 || baraQty > 0) {
          const code = caseSelect.dataset.code || '';
          
          // å•†å“ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã®ã¿CSVã«å«ã‚ã‚‹
          if (code) {
            orders.push({
              productCode: code,
              quantity: baraQty,  // ãƒãƒ©æ•°ã¯ã€Œæ•°é‡ã€åˆ—
              boxes: caseQty      // ã‚±ãƒ¼ã‚¹æ•°ã¯ã€Œç®±æ•°ã€åˆ—ï¼ˆåŒºåˆ†ï¼‰
            });
          }
        }
      });
      
      if (orders.length === 0) {
        alert('å•†å“ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å•†å“ã®æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // CSVãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆPCAå•†é­‚å•†ç®¡å½¢å¼ï¼‰
      let csv = 'å•†å“ã‚³ãƒ¼ãƒ‰,æ•°é‡,ç®±æ•°\n';
      
      // CSVãƒ‡ãƒ¼ã‚¿
      orders.forEach(order => {
        csv += `${order.productCode},${order.quantity},${order.boxes}\n`;
      });
      
      // BOMä»˜ãã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆExcelã§æ–‡å­—åŒ–ã‘é˜²æ­¢ï¼‰
      const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
      const blob = new Blob([bom, csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `åŒ…æç™ºæ³¨_PCA_${orderDate}.csv`;
      link.click();
    }
    
    // ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆå®Ÿè£…ä¾‹ - å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã«ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå¿…è¦ï¼‰
    function sendOrder() {
      const customerCode = document.getElementById('customerCode').value;
      const orderDate = document.getElementById('orderDate').value;
      
      // æ•°é‡ãŒé¸æŠã•ã‚ŒãŸå•†å“ã‚’åé›†
      const orders = [];
      document.querySelectorAll('.order-table tbody tr').forEach(row => {
        const caseSelect = row.querySelector('.qty-case');
        const baraSelect = row.querySelector('.qty-bara');
        const caseQty = caseSelect.value;
        const baraQty = baraSelect.value;
        
        if (caseQty || baraQty) {
          const code = caseSelect.dataset.code || '';
          const product = caseSelect.dataset.product;
          const unit = caseSelect.dataset.unit;
          
          orders.push({
            code: code,
            product: product,
            unit: unit,
            caseQty: caseQty,
            baraQty: baraQty
          });
        }
      });
      
      if (orders.length === 0) {
        alert('æ•°é‡ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }
      
      // ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ä½œæˆ
      let body = `ç™ºæ³¨è¡¨ï¼ˆåŒ…æï¼‰\n\n`;
      body += `é¡§å®¢ã‚³ãƒ¼ãƒ‰: ${customerCode}\n`;
      body += `åº—èˆ—: ç²‰ã‚‚ã‚“å±‹å…«ã€€ä¸‹èµ¤å¡šåº—\n`;
      body += `ç™ºæ³¨æ—¥: ${orderDate}\n\n`;
      body += `å•†å“ã‚³ãƒ¼ãƒ‰\tå•†å“å\tå˜ä½\tã‚±ãƒ¼ã‚¹æ•°\tãƒãƒ©æ•°\n`;
      body += `${'='.repeat(60)}\n`;
      
      orders.forEach(order => {
        body += `${order.code}\t${order.product}\t${order.unit}\t${order.caseQty || '-'}\t${order.baraQty || '-'}\n`;
      });
      
      // mailtoãƒªãƒ³ã‚¯ã‚’ä½¿ç”¨ï¼ˆå®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã«ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå¿…è¦ï¼‰
      const subject = encodeURIComponent(`ã€ç™ºæ³¨ã€‘ç²‰ã‚‚ã‚“å±‹å…« ä¸‹èµ¤å¡šåº— - åŒ…æ - ${orderDate}`);
      const mailBody = encodeURIComponent(body);
      const mailtoLink = `mailto:gymnastmasaki@yahoo.co.jp?subject=${subject}&body=${mailBody}`;
      
      window.location.href = mailtoLink;
      
      alert('ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆãŒèµ·å‹•ã—ã¾ã™ã€‚\nå†…å®¹ã‚’ç¢ºèªã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚');
    }
  </script>
</body>
</html>
