<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç·Šæ€¥è¨ºæ–­ãƒšãƒ¼ã‚¸</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    
    h1 {
      color: #333;
      margin-bottom: 20px;
      font-size: 28px;
    }
    
    .test-box {
      background: #e8f5e9;
      border: 3px solid #4CAF50;
      padding: 20px;
      margin: 15px 0;
      border-radius: 8px;
    }
    
    .test-box h2 {
      color: #4CAF50;
      margin-bottom: 10px;
      font-size: 20px;
    }
    
    .code {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 5px;
      font-family: monospace;
      margin: 10px 0;
      white-space: pre-wrap;
      word-break: break-all;
    }
    
    .warning {
      background: #fff3cd;
      border: 3px solid #ffc107;
      color: #856404;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: bold;
    }
    
    .error {
      background: #ffebee;
      border: 3px solid #f44336;
      color: #c62828;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: bold;
    }
    
    #js-test {
      display: none;
    }
    
    .success {
      background: #e8f5e9;
      border: 3px solid #4CAF50;
      color: #2e7d32;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: bold;
    }
    
    button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px 5px;
    }
    
    button:hover {
      background: #1976D2;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”§ ç·Šæ€¥è¨ºæ–­ãƒšãƒ¼ã‚¸</h1>
    
    <div class="test-box">
      <h2>âœ… ãƒ†ã‚¹ãƒˆ1: HTMLã®è¡¨ç¤º</h2>
      <p>ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ãˆã¦ã„ã‚Œã°ã€HTMLã¯æ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p>
    </div>
    
    <div class="test-box">
      <h2>âœ… ãƒ†ã‚¹ãƒˆ2: CSSã®é©ç”¨</h2>
      <p>ã“ã®æ ã«ç·‘è‰²ã®æ ç·šã¨èƒŒæ™¯è‰²ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°ã€CSSã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚</p>
    </div>
    
    <div class="error" id="js-error">
      <h2>âŒ ãƒ†ã‚¹ãƒˆ3: JavaScriptãŒç„¡åŠ¹ã§ã™</h2>
      <p>ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã€JavaScriptãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
      <p><strong>å¯¾å‡¦æ³•ï¼š</strong></p>
      <ol style="margin-left: 20px; margin-top: 10px;">
        <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§JavaScriptã‚’æœ‰åŠ¹ã«ã™ã‚‹</li>
        <li>ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ï¼ˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰ã§è©¦ã™</li>
        <li>åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆChromeã€Safariï¼‰ã§è©¦ã™</li>
      </ol>
    </div>
    
    <div id="js-test" class="success">
      <h2>âœ… ãƒ†ã‚¹ãƒˆ3: JavaScriptãŒå‹•ä½œã—ã¦ã„ã¾ã™</h2>
      <p>JavaScriptã¯æ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
      <div class="code" id="browser-info"></div>
    </div>
    
    <div class="warning">
      <h2>âš ï¸ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
      <p>ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€å„ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p>
    </div>
    
    <button onclick="testBasicJS()">åŸºæœ¬JSãƒ†ã‚¹ãƒˆ</button>
    <button onclick="testFirebase()">Firebaseæ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
    <button onclick="copyInfo()">è¨ºæ–­æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼</button>
    
    <div id="test-results" style="margin-top: 20px;"></div>
    
    <div class="code" id="diagnostic-info" style="margin-top: 20px; display: none;"></div>
  </div>

  <script>
    // JavaScriptãŒå‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã™
    document.addEventListener('DOMContentLoaded', function() {
      console.log('âœ… JavaScriptå®Ÿè¡Œé–‹å§‹');
      
      // JavaScriptã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éš ã™
      document.getElementById('js-error').style.display = 'none';
      
      // JavaScriptæˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
      const jsTest = document.getElementById('js-test');
      jsTest.style.display = 'block';
      
      // ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±ã‚’è¡¨ç¤º
      const browserInfo = document.getElementById('browser-info');
      browserInfo.textContent = 
        'User Agent: ' + navigator.userAgent + '\n' +
        'ç”»é¢ã‚µã‚¤ã‚º: ' + window.innerWidth + ' x ' + window.innerHeight + '\n' +
        'è¨€èª: ' + navigator.language + '\n' +
        'URL: ' + window.location.href + '\n' +
        'ç¾åœ¨æ™‚åˆ»: ' + new Date().toLocaleString('ja-JP');
      
      console.log('âœ… DOMèª­ã¿è¾¼ã¿å®Œäº†');
    });
    
    function testBasicJS() {
      const results = document.getElementById('test-results');
      results.innerHTML = '<div class="success"><h2>âœ… åŸºæœ¬JavaScriptãƒ†ã‚¹ãƒˆæˆåŠŸ</h2><p>alertã€å¤‰æ•°ã€é–¢æ•°ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚</p></div>';
      
      alert('JavaScript ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ï¼');
      console.log('âœ… åŸºæœ¬JSãƒ†ã‚¹ãƒˆå®Œäº†');
    }
    
    async function testFirebase() {
      const results = document.getElementById('test-results');
      results.innerHTML = '<div class="test-box"><h2>ğŸ”„ Firebaseãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</h2><p>å°‘ã€…ãŠå¾…ã¡ãã ã•ã„...</p></div>';
      
      try {
        // Firebase SDKã‚’å‹•çš„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        console.log('ğŸ“¦ Firebase SDKã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­...');
        const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
        const { getFirestore, collection, getDocs } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
        
        console.log('âœ… Firebase SDKã‚¤ãƒ³ãƒãƒ¼ãƒˆæˆåŠŸ');
        
        const firebaseConfig = {
          apiKey: "AIzaSyBoSdfEkez-b3P0BUHtowxCrTw-yEBdHSg",
          authDomain: "takoyaki-order-system-bacd7.firebaseapp.com",
          projectId: "takoyaki-order-system-bacd7",
          storageBucket: "takoyaki-order-system-bacd7.firebasestorage.app",
          messagingSenderId: "104494752890",
          appId: "1:104494752890:web:c0a25d62f42ffca01687c3"
        };
        
        console.log('ğŸ”§ Firebaseã‚’åˆæœŸåŒ–ä¸­...');
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        console.log('âœ… FirebaseåˆæœŸåŒ–æˆåŠŸ');
        console.log('ğŸ“‹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...');
        
        const menuSnapshot = await getDocs(collection(db, 'menu'));
        
        console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ:', menuSnapshot.size, 'ä»¶');
        
        let menuList = '';
        let count = 0;
        menuSnapshot.forEach(doc => {
          if (count < 5) {
            const data = doc.data();
            menuList += `  ${count + 1}. ${data.name} - Â¥${data.price}\n`;
            count++;
          }
        });
        
        results.innerHTML = `
          <div class="success">
            <h2>âœ… Firebaseæ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸï¼</h2>
            <p><strong>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿:</strong> ${menuSnapshot.size}ä»¶å–å¾—</p>
            <div class="code">æœ€åˆã®5ä»¶:\n${menuList}</div>
            <p style="margin-top: 10px;">âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã¯æ­£å¸¸ã§ã™ï¼</p>
            <p><strong>çµè«–:</strong> menu.htmlãŒç™½ç´™ã®åŸå› ã¯ã€JavaScriptã®å®Ÿè¡Œã‚¨ãƒ©ãƒ¼ã¾ãŸã¯ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã®å•é¡Œã§ã™ã€‚</p>
          </div>
        `;
        
        updateDiagnosticInfo('success', menuSnapshot.size);
        
      } catch (e) {
        console.error('âŒ Firebaseã‚¨ãƒ©ãƒ¼:', e);
        results.innerHTML = `
          <div class="error">
            <h2>âŒ Firebaseæ¥ç¶šã‚¨ãƒ©ãƒ¼</h2>
            <p><strong>ã‚¨ãƒ©ãƒ¼å†…å®¹:</strong></p>
            <div class="code">${e.message}\n\nã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: ${e.code || 'ãªã—'}\n\nã‚¹ã‚¿ãƒƒã‚¯: ${e.stack || 'ãªã—'}</div>
          </div>
        `;
        
        updateDiagnosticInfo('error', 0, e.message);
      }
    }
    
    function updateDiagnosticInfo(status, menuCount, error) {
      const info = document.getElementById('diagnostic-info');
      info.style.display = 'block';
      
      const diagnosticText = 
        '=== è¨ºæ–­æƒ…å ± ===\n' +
        'æ—¥æ™‚: ' + new Date().toLocaleString('ja-JP') + '\n' +
        'URL: ' + window.location.href + '\n' +
        'User Agent: ' + navigator.userAgent + '\n' +
        'ç”»é¢ã‚µã‚¤ã‚º: ' + window.innerWidth + ' x ' + window.innerHeight + '\n' +
        '\n' +
        '=== ãƒ†ã‚¹ãƒˆçµæœ ===\n' +
        'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ' + status + '\n' +
        'ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä»¶æ•°: ' + menuCount + '\n' +
        (error ? 'ã‚¨ãƒ©ãƒ¼: ' + error + '\n' : '') +
        '\n' +
        '=== æ¨å¥¨å¯¾å‡¦æ³• ===\n';
      
      if (status === 'success') {
        info.textContent = diagnosticText + 
          '1. menu.htmlã‚’æœ€æ–°ç‰ˆã«æ›´æ–°ã—ã¦ãã ã•ã„\n' +
          '2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„ (Ctrl+Shift+Delete)\n' +
          '3. ãã‚Œã§ã‚‚ç™½ç´™ã®å ´åˆã¯ã€menu.htmlã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„';
      } else {
        info.textContent = diagnosticText +
          '1. Firebaseã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèª\n' +
          '2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª\n' +
          '3. ä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å ´åˆã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚’ç¢ºèª';
      }
    }
    
    function copyInfo() {
      const info = document.getElementById('diagnostic-info');
      if (info.style.display === 'none') {
        alert('ã¾ãšFirebaseæ¥ç¶šãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„');
        return;
      }
      
      const text = info.textContent;
      
      // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => {
          alert('è¨ºæ–­æƒ…å ±ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n\nã“ã®æƒ…å ±ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚');
        }).catch(err => {
          console.error('ã‚³ãƒ”ãƒ¼å¤±æ•—:', err);
          prompt('ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:', text);
        });
      } else {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        prompt('ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:', text);
      }
    }
  </script>
</body>
</html>
